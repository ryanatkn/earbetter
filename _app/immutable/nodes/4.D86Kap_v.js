import{u as je,f as fe,c as n,r as l,s as a,b as ge,a as d,t as c,d as ft,e as fa,n as Pe,v as ha,w as pa}from"../chunks/disclose-version.C5EwI3-V.js";import{p as ne,j as E,t as H,H as $,g as t,a as oe,s as m,d as v,F as De,n as Mt,T as ya}from"../chunks/index-client.Cqv4GYu1.js";import{g as ka,b as wa}from"../chunks/entry.CG1Mjt1l.js";import{H as ja}from"../chunks/Header.Dqb5sQlw.js";import{g as xa,F as za}from"../chunks/Footer.BMM9VyP_.js";import{K as Nt,U as mt,d as Rt,l as qa,W as Ct,X as Ia,L as Sa,j as Ft,k as gt,p as Ta,Y as bt,Z as Ht,n as Bt,w as Jt,_ as Aa,g as Ut,$ as Se,a as Xe,b as Ze,t as pe,m as Dt,a0 as Pa,a1 as et,c as ye,a2 as tt,M as Wt,a3 as at,a4 as Yt,a5 as La,s as Gt,a6 as Ea}from"../chunks/index.D3MZVUk2.js";import{p as ee,a as M,i as x}from"../chunks/props.DNuZbuIM.js";import{l as Ma,i as Da,s as Oa,b as he,I as Kt,V as Xt,c as Zt,a as Va}from"../chunks/Init_Midi_Button.Dx1mWrah.js";import{f as He,e as Oe,r as we,s as U,g as Qe,b as Qt,c as $t,t as be,h as Na}from"../chunks/style.BTM4hw-r.js";import{M as ea,P as ta,b as Ra,B as Ca}from"../chunks/Back_Button.BjprJYTJ.js";import{b as Te}from"../chunks/this.D7faLO31.js";import{D as Fe}from"../chunks/Dialog.ZlV3I7Aw.js";import{A as $e}from"../chunks/Alert.UdTjU1eu.js";import{p as Fa}from"../chunks/string.Dn_jmF-S.js";import{L as Ha}from"../chunks/Level_Stats_Summary.BDLUs4WC.js";function Ba(o,e){Ma(window,["resize"],()=>e(window[o]))}var Ot=Object.prototype.hasOwnProperty;function Vt(o,e,r){for(r of o.keys())if(Le(r,e))return r}function Le(o,e){var r,i,s;if(o===e)return!0;if(o&&e&&(r=o.constructor)===e.constructor){if(r===Date)return o.getTime()===e.getTime();if(r===RegExp)return o.toString()===e.toString();if(r===Array){if((i=o.length)===e.length)for(;i--&&Le(o[i],e[i]););return i===-1}if(r===Set){if(o.size!==e.size)return!1;for(i of o)if(s=i,s&&typeof s=="object"&&(s=Vt(e,s),!s)||!e.has(s))return!1;return!0}if(r===Map){if(o.size!==e.size)return!1;for(i of o)if(s=i[0],s&&typeof s=="object"&&(s=Vt(e,s),!s)||!Le(i[1],e.get(s)))return!1;return!0}if(r===ArrayBuffer)o=new Uint8Array(o),e=new Uint8Array(e);else if(r===DataView){if((i=o.byteLength)===e.byteLength)for(;i--&&o.getInt8(i)===e.getInt8(i););return i===-1}if(ArrayBuffer.isView(o)){if((i=o.byteLength)===e.byteLength)for(;i--&&o[i]===e[i];);return i===-1}if(!r||typeof o=="object"){i=0;for(r in o)if(Ot.call(o,r)&&++i&&!Ot.call(e,r)||!(r in e)||!Le(o[r],e[r]))return!1;return Object.keys(e).length===i}}return o!==o&&e!==e}var Ja=(o,e)=>m(e,M(o.currentTarget.value)),Ua=(o,e,r,i,s,_)=>{var b;return(b=e.oninput)==null?void 0:b.call(e,t(r),t(i)?{scale:s(),octaves:_()}:void 0)},Wa=(o,e)=>e(M(qa(o.currentTarget.value))),Ya=c("<option> </option>"),Ga=c('<small><textarea class="preview width_sm panel svelte-1n8fnqy"></textarea></small> <button type="button" class="accent mb_lg">use these intervals</button> <label><div class="title text_align_center">scale</div> <select></select></label> <label><div class="title text_align_center">octaves</div> <div class="text_align_center"> </div> <input type="range"></label>',1);function Ka(o,e){ne(e,!0);let r=ee(e,"scale",15,()=>M(Nt)),i=ee(e,"octaves",7,1);const s=v(()=>Ia(r(),i())),_=v(()=>mt(t(s))),b=M(mt(e.intervals));let k=E(M(b));const h=v(()=>(t(s),Date.now())),I=v(()=>(e.intervals,t(k),Date.now())),j=v(()=>t(h)>t(I)),f=v(()=>t(j)?t(_):t(k)),g=v(()=>Ct(t(f))),y=v(()=>!Le(e.intervals,t(g))),u=v(()=>!!t(g).length);var w=Ga(),S=fe(w),D=n(S);He(D),D.__input=[Ja,k],l(S);var F=a(a(S,!0));F.__click=[Ua,e,g,j,r,i];var te=a(a(F,!0)),K=n(te),Q=a(a(K,!0));Da(Q,()=>r().name);var ie;Q.__change=[Wa,r],Oe(Q,76,()=>Rt,(V,J)=>$(V),(V,J,W)=>{var Z=Ya(),L={},q=n(Z);l(Z),H(()=>{L!==(L=$(J).name)&&(Z.value=(Z.__value=$(J).name)==null?"":$(J).name),ge(q,$(J).name)}),d(V,Z)}),l(Q),l(te);var ve=a(a(te,!0)),le=n(ve),_e=a(a(le,!0)),ue=n(_e);l(_e);var N=a(a(_e,!0));we(N),U(N,"min",1),U(N,"max",6),l(ve),H(()=>{Qe(D,t(f)),F.disabled=!t(y)||!t(u),ie!==(ie=r().name)&&(Q.value=(Q.__value=r().name)==null?"":r().name,Oa(Q,r().name)),ge(ue,i())}),he(N,i,V=>i(V)),d(o,w),oe()}je(["input","click","change"]);var Xa=(o,e)=>{m(e,M(new Set))},Za=(o,e,r)=>{var i;(i=e.oninput)==null||i.call(e,t(r))},Qa=c("all",1),$a=c('<!> <button class="mb_lg" type="button">clear selection</button> <button type="button" class="accent">select <!> </button>',1),er=c("<option> </option>"),tr=(o,e,r)=>e($(r)),ar=c('<button type="button"> </button>'),rr=(o,e)=>e(o.currentTarget.value),lr=c('<!> <div class="notes_input pt_lg svelte-18obm47"><!> <div class="piano_wrapper svelte-18obm47"><!></div> <section class="box"><label class="mb_lg"><div class="title text_align_center">key</div> <select></select></label> <div class="scales mb_lg svelte-18obm47"></div> <!> <div class="notes width_sm svelte-18obm47"><blockquote class="panel my_lg"><textarea></textarea></blockquote></div></section> <form class="width_sm panel p_md"><fieldset><!> <!></fieldset> <fieldset><!></fieldset></form></div>',1);function nr(o,e){ne(e,!0);const r=p=>{var P=$a(),X=fe(P);x(X,()=>e.before_buttons,qe=>{var ze=ft(),rt=fe(ze);$t(rt,()=>e.before_buttons),d(qe,ze)});var de=a(a(X,!0));de.__click=[Xa,_];var ce=a(a(de,!0));ce.__click=[Za,e,b];var Ae=a(n(ce));x(Ae,()=>t(h)===0,qe=>{var ze=Qa();d(qe,ze)},qe=>{var ze=fa();H(()=>ge(ze,t(h))),d(qe,ze)});var Be=a(Ae,!0);H(()=>ge(Be,` tonic${Fa(t(h))??""}`)),l(ce),H(()=>{de.disabled=t(h)===0,ce.disabled=!t(g)}),d(p,P)},i=ee(e,"audio_state",7),{playing_notes:s}=i();let _=E(void 0);const b=v(()=>t(_)&&Array.from(t(_)).sort((p,P)=>p-P)),k=v(()=>t(_)??e.notes),h=v(()=>t(k).size),I=v(()=>t(b)&&bt(t(b))),j=p=>{m(_,M(new Set(Ht(p))))},f=v(()=>bt(Array.from(e.notes).sort((p,P)=>p-P))),g=v(()=>!!t(b)&&t(I)!==t(f)),y=p=>{const P=new Set(t(k));P.has(p)?P.delete(p):P.add(p),m(_,M(P))};let u=E(M(Sa));const w=Ft();let S=E(void 0);const D=20,F=(p,P=null)=>{Bt(i(),w(),p,Jt(i().volume,P),i().instrument)},te=p=>{const P=Aa(p,t(u),e.min_note,e.max_note);if(!t(_)||!t(b)){m(_,M(P));return}let X=!0;for(const ce of P)if(!t(_).has(ce)){X=!1;break}const de=X?t(b).filter(ce=>!P.has(ce)):t(b).concat(Array.from(P));m(_,M(new Set(de)))};var K=lr(),Q=fe(K);ea(Q,{get midi_access(){return i().midi_access},onnotestart:(p,P)=>F(p,P),onnotestop:p=>gt(p)});var ie=a(a(Q,!0)),ve=n(ie);r(ve);var le=a(a(ve,!0));Qt(le,"padding",`${D}px`);var _e=n(le);x(_e,()=>t(S),p=>{var P=v(()=>t(S)-D*5);ta(p,{get width(){return t(P)},get min_note(){return e.min_note},get max_note(){return e.max_note},max_height:300,pressed_keys:s,get highlighted_keys(){return t(k)},middle_c_label:!0,allow_sticking:!0,onpress:X=>{y(X),F(X)},onrelease:X=>{gt(X)}})}),l(le);var ue=a(a(le,!0)),N=n(ue),V=n(N),J=a(a(V,!0));Oe(J,76,()=>Ta,(p,P)=>$(p),(p,P,X)=>{var de=er(),ce={},Ae=n(de);l(de),H(()=>{ce!==(ce=$(P))&&(de.value=(de.__value=$(P))==null?"":$(P)),ge(Ae,$(P))}),d(p,de)}),l(J),l(N);var W=a(a(N,!0));Oe(W,77,()=>Rt,(p,P)=>$(p).name,(p,P,X)=>{var de=ar();de.__click=[tr,te,P];var ce=n(de);l(de),H(()=>ge(ce,$(P).name)),d(p,de)}),l(W);var Z=a(a(W,!0));r(Z);var L=a(a(Z,!0)),q=n(L),Y=n(q);He(Y),Y.__change=[rr,j],l(q),l(L),l(ue);var T=a(a(ue,!0)),A=n(T),C=n(A);Kt(C,{get instrument(){return i().instrument},set instrument(p){i().instrument=p}});var O=a(a(C,!0));Xt(O,{get volume(){return i().volume},set volume(p){i().volume=p}}),l(A);var G=a(a(A,!0)),B=n(G);Zt(B,{get midi_state(){return i()}}),l(G),l(T),l(ie),H(()=>Qe(Y,t(I))),Ba("innerWidth",p=>m(S,p)),Va(J,()=>t(u),p=>m(u,p)),d(o,K),oe()}je(["click","change"]);var or=(o,e)=>{var r;navigator.clipboard.writeText(e.text),(r=e.oncopy)==null||r.call(e)},ir=c("copy to clipboard",1),_r=c('<button type="button" class="my_lg"><!></button>');function ht(o,e){ne(e,!0);var r=_r();r.__click=[or,e];var i=n(r);x(i,()=>e.children,s=>{var _=ft(),b=fe(_);$t(b,()=>e.children),d(s,_)},s=>{var _=ir();d(s,_)}),l(r),d(o,r),oe()}je(["click"]);const sr=(o,e,r,i,s)=>{m(e,"");try{const _=JSON.parse(t(r));_&&!_.id&&(_.id=Pa());const b=et.parse(_);i.onsubmit(b)}catch(_){console.error("failed to import data",_),m(e,M(_.message||"unknown error"))}m(s,!1)},dr=(o,e,r,i,s)=>{m(e,M(m(r,M(JSON.stringify(i()))))),m(s,!0)};var cr=c("editing level",1),vr=c("create a new level",1),ur=(o,e)=>m(e,Se(Ct(o.currentTarget.value))),mr=(o,e)=>m(e,!0),gr=c("the lowest note must be lower than the highest",1),br=c("<!> <br>",1),fr=(o,e)=>m(e,Se(Ht(o.currentTarget.value))),hr=(o,e)=>m(e,!0),pr=(o,e,r)=>e.onsubmit(r()),yr=c("save changes to level",1),kr=c("create level",1),wr=(o,e)=>m(e,!t(e)),jr=(o,e,r)=>{m(e,!1),r.onremove(r.level_data.id)},xr=c('<div class="pb_md"><button type="button" class="color_c w_100 svelte-h4qokl">✕ confirm remove</button></div>'),zr=(o,e)=>e.onduplicate(e.level_data.id),qr=c('<button type="button" class="svelte-h4qokl">duplicate level</button>'),Ir=c('<button type="button" class="svelte-h4qokl">remove level</button> <!> <!>',1),Sr=c("import/export data",1),Tr=c("import data",1),Ar=c("<pre> </pre>"),Pr=c('<div class="overflow_x_auto"><!></div>'),Lr=(o,e,r,i)=>e.onplay(t(r)?i():e.level_data,t(r)),Er=c('<button type="button" class="svelte-h4qokl">play!</button>'),Mr=(o,e)=>e.onclose(e.level_data.id),Dr=c("discard changes and stop editing",1),Or=c("close level editor",1),Vr=c('<button type="button" class="svelte-h4qokl"><!></button>'),Nr=c('<div class="importing bg shadow_d_xl p_xl width_md box svelte-h4qokl"><h2 class="my_0">import level data</h2> <!> <textarea class="svelte-h4qokl"></textarea> <button type="button" class="svelte-h4qokl">import project data</button></div>'),Rr=c('<div class="bg shadow_d_xl p_xl width_md box"><h2 class="my_0">pick intervals</h2> <!> <button type="button" class="svelte-h4qokl">cancel</button></div>'),Cr=c('<button type="button" class="mb_lg svelte-h4qokl">cancel</button>'),Fr=c('<div class="bg shadow_d_xl py_xl box"><h2 class="my_0">pick tonics</h2> <!></div>'),Hr=c(`<form class="level_def_form w_100"><header><h2 class="my_0"><!></h2></header> <div class="fields svelte-h4qokl"><fieldset><label><div class="title">name</div> <input></label></fieldset> <fieldset><label class="mb_0" title="the semitones to include relative to the tonic"><div class="title">intervals</div> <input></label> <button type="button" class="svelte-h4qokl">pick intervals</button> <details><summary>about <code>intervals</code></summary> <p><code>intervals</code> is a comma-separated list of numbers representing the <a href="https://wikipedia.org/wiki/Interval_(music)">musical intervals</a> used in the
					level, aka the number of piano keys (<a href="https://wikipedia.org/wiki/Semitone">semitones</a>) separating each note from the <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> (see below)</p> <p>for example, to practice distinguishing between the <a href="https://wikipedia.org/wiki/Perfect_fourth">perfect fourth</a> and <a href="https://wikipedia.org/wiki/Perfect_fifth">perfect fifth</a>, enter "<code>5, 7</code>"</p> <p>negative numbers are allowed</p></details></fieldset> <fieldset><label title="the number of trials per level"><div class="title">trial count</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset><label title="the number of notes per trial"><div class="title">sequence length</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset class="row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="number"> <input type="range"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="number"> <input type="range"></label></fieldset> <!> <fieldset><label class="mb_0" title="the possible starting notes for each trial"><div class="title">tonics</div> <input placeholder="all"></label> <button type="button" class="svelte-h4qokl">pick tonics</button> <details><summary>about <code>tonics</code></summary> <p>The <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> is like the "base" or "home"
					note, and for our purposes it's always the first note played in a trial. Other notes in the
					trial are calculated from the tonic and intervals. (see above)</p></details></fieldset> <button type="button" class="accent svelte-h4qokl"><!></button> <!> <button type="button" class="svelte-h4qokl"><!></button> <!> <!> <!></div></form> <!> <!> <!>`,1);function Br(o,e){ne(e,!0);const r=ee(e,"editing",3,!1),i=Ut();let s=E(!1),_=E(M(e.level_data.name));const b=v(()=>{var z;return(z=t(_))==null?void 0:z.trim()});let k=E(Se(e.level_data.intervals)),h=E(Se(e.level_data.tonics));const I=v(()=>t(h)?t(h).filter(z=>z>=t(g)&&z<=t(y)):t(h));let j=E(M(e.level_data.trial_count)),f=E(M(e.level_data.sequence_length)),g=E(M(e.level_data.min_note)),y=E(M(e.level_data.max_note));const u=()=>et.parse({id:e.level_data.id,name:t(b),intervals:t(k),tonics:t(I),trial_count:t(j),sequence_length:t(f),min_note:t(g),max_note:t(y)});De(()=>{m(_,M(e.level_data.name)),m(k,Se(e.level_data.intervals)),m(h,Se(e.level_data.tonics)),m(j,M(e.level_data.trial_count)),m(f,M(e.level_data.sequence_length)),m(g,M(e.level_data.min_note)),m(y,M(e.level_data.max_note))});const w=v(()=>t(b)!==e.level_data.name||t(j)!==e.level_data.trial_count||t(f)!==e.level_data.sequence_length||t(g)!==e.level_data.min_note||t(y)!==e.level_data.max_note||!Le(t(k),e.level_data.intervals)||!Le(t(I),e.level_data.tonics));let S=E(!1),D=E(!1),F=E(!1),te=E(""),K=E("");const Q=v(()=>t(te)!==t(K));let ie=E("");De(()=>{e.level_data,m(ie,"")});let ve=E(void 0),le=E(void 0),_e=E(void 0),ue=E(void 0);const N=v(()=>t(h)&&new Set(t(h)));let V=E(M(Nt)),J=E(1),W=E(void 0);const Z=v(()=>t(g)>=t(y));var L=Hr(),q=fe(L),Y=n(q),T=n(Y),A=n(T);x(A,r,z=>{var R=cr();d(z,R)},z=>{var R=vr();d(z,R)}),l(T),l(Y);var C=a(a(Y,!0)),O=n(C),G=n(O),B=n(G),p=a(a(B,!0));we(p),l(G),l(O);var P=a(a(O,!0)),X=n(P),de=n(X),ce=a(a(de,!0));Te(ce,z=>m(_e,M(z)),()=>t(_e)),we(ce),H(()=>Qe(ce,mt(t(k)))),ce.__change=[ur,k],l(X);var Ae=a(a(X,!0));Ae.__click=[mr,D];var Be=a(a(Ae,!0)),qe=n(Be);a(n(qe)),l(qe);var ze=a(a(qe,!0)),rt=n(ze),aa=a(a(rt,!0)),ra=a(a(aa,!0));a(a(ra,!0)),Pe(),l(ze);var lt=a(a(ze,!0)),la=a(n(lt)),na=a(a(la,!0));a(a(na,!0)),Pe(),l(lt),a(a(lt,!0)),l(Be),l(P);var nt=a(a(P,!0)),pt=n(nt),oa=n(pt),yt=a(a(oa,!0)),Je=n(yt);we(Je),U(Je,"min",1);var Ue=a(a(Je,!0));we(Ue),U(Ue,"min",1),U(Ue,"max",20),l(yt),l(pt),l(nt);var ot=a(a(nt,!0)),kt=n(ot),ia=n(kt),wt=a(a(ia,!0)),We=n(wt);we(We),U(We,"min",2);var Ye=a(a(We,!0));we(Ye),U(Ye,"min",2),U(Ye,"max",16),l(wt),l(kt),l(ot);var it=a(a(ot,!0)),_t=n(it),_a=n(_t),st=a(a(_a,!0)),sa=n(st);l(st);var Ee=a(a(st,!0));we(Ee),U(Ee,"step",1),U(Ee,"min",Xe),U(Ee,"max",Ze);var Ve=a(a(Ee,!0));we(Ve),U(Ve,"step",1),U(Ve,"min",Xe),U(Ve,"max",Ze),l(_t);var jt=a(a(_t,!0)),da=n(jt),dt=a(a(da,!0)),ca=n(dt);l(dt);var Me=a(a(dt,!0));we(Me),U(Me,"step",1),U(Me,"min",Xe),U(Me,"max",Ze);var Ne=a(a(Me,!0));we(Ne),U(Ne,"step",1),U(Ne,"min",Xe),U(Ne,"max",Ze),l(jt),l(it);var xt=a(a(it,!0));x(xt,()=>t(Z),z=>{$e(z,{status:"error",children:(R,re)=>{Pe();var ae=gr();d(R,ae)},$$slots:{default:!0}})},z=>{var R=br(),re=fe(R),ae=v(()=>t(W)??0);ta(re,{get width(){return t(ae)},max_height:50,get min_note(){return t(g)},get max_note(){return t(y)},get highlighted_keys(){return t(N)},clickable:!1,middle_c_label:!0}),a(a(re,!0)),d(z,R)});var Ge=a(a(xt,!0)),ct=n(Ge),va=n(ct),Ke=a(a(va,!0));Te(Ke,z=>m(ue,M(z)),()=>t(ue)),we(Ke),H(()=>Qe(Ke,bt(t(h)))),Ke.__change=[fr,h],l(ct);var zt=a(a(ct,!0));zt.__click=[hr,F];var qt=a(a(zt,!0)),vt=n(qt);a(n(vt)),l(vt);var It=a(a(vt,!0));a(n(It)),Pe(),l(It),l(qt),l(Ge);var Re=a(a(Ge,!0));Re.__click=[pr,e,u];var ua=n(Re);x(ua,r,z=>{var R=yr();d(z,R)},z=>{var R=kr();d(z,R)}),l(Re);var St=a(a(Re,!0));x(St,()=>e.onremove&&r(),z=>{var R=Ir(),re=fe(R);re.__click=[wr,s];var ae=a(a(re,!0));x(ae,()=>t(s),ke=>{var se=xr(),Ie=n(se);Ie.__click=[jr,s,e],l(se),pe(3,se,()=>ye),d(ke,se)});var me=a(a(ae,!0));x(me,()=>e.onduplicate,ke=>{var se=qr();se.__click=[zr,e],d(ke,se)}),d(z,R)});var Ce=a(a(St,!0));Te(Ce,z=>m(le,M(z)),()=>t(le)),Ce.__click=[dr,te,K,u,S];var ma=n(Ce);x(ma,r,z=>{var R=Sr();d(z,R)},z=>{var R=Tr();d(z,R)}),l(Ce);var Tt=a(a(Ce,!0));x(Tt,()=>t(ie),z=>{var R=Pr(),re=n(R);$e(re,{status:"error",children:(ae,me)=>{var ke=Ar(),se=n(ke);l(ke),H(()=>ge(se,t(ie))),d(ae,ke)},$$slots:{default:!0}}),l(R),d(z,R)});var At=a(a(Tt,!0));x(At,()=>e.onplay&&r(),z=>{var R=Er();R.__click=[Lr,e,w,u],d(z,R)});var ga=a(a(At,!0));x(ga,()=>e.onclose&&r(),z=>{var R=Vr();R.__click=[Mr,e];var re=n(R);x(re,()=>t(w),ae=>{var me=Dr();d(ae,me)},ae=>{var me=Or();d(ae,me)}),l(R),d(z,R)}),l(C),l(q);var Pt=a(a(q,!0));x(Pt,()=>t(S),z=>{Fe(z,{onclose:()=>{var R;m(S,!1),(R=t(le))==null||R.focus()},children:(R,re)=>{var ae=Nr(),me=n(ae),ke=a(a(me,!0));ht(ke,{get text(){return t(K)},oncopy:()=>{var xe;(xe=t(ve))==null||xe.select()}});var se=a(a(ke,!0));Te(se,xe=>m(ve,M(xe)),()=>t(ve)),He(se);var Ie=a(a(se,!0));Ie.__click=[sr,ie,K,e,S],l(ae),H(()=>{Ie.disabled=!t(Q),U(Ie,"title",t(Q)?void 0:"data has not changed")}),he(se,()=>t(K),xe=>m(K,xe)),d(R,ae)},$$slots:{default:!0}})});var Lt=a(a(Pt,!0));x(Lt,()=>t(D),z=>{Fe(z,{onclose:()=>{var re;m(D,!1),(re=t(_e))==null||re.focus()},children:(re,ae=Mt)=>{var me=Rr(),ke=n(me),se=a(a(ke,!0));Ka(se,{get intervals(){return t(k)},get scale(){return t(V)},set scale(xe){m(V,M(xe))},get octaves(){return t(J)},set octaves(xe){m(J,M(xe))},oninput:xe=>{m(k,Se(xe)),ae()()}});var Ie=a(a(se,!0));Ie.__click=ae(),l(me),d(re,me)}})});var ba=a(a(Lt,!0));x(ba,()=>t(F),z=>{Fe(z,{onclose:()=>{var re;m(F,!1),(re=t(ue))==null||re.focus()},children:(re,ae=Mt)=>{var me=Fr(),ke=n(me),se=a(a(ke,!0)),Ie=v(()=>new Set(t(h)));nr(se,{audio_state:i,get notes(){return t(Ie)},get min_note(){return t(g)},get max_note(){return t(y)},oninput:ut=>{m(h,Se(ut)),ae()()},before_buttons:ut=>{var Et=Cr();Et.__click=ae(),d(ut,Et)}}),l(me),d(re,me)}})}),H(()=>{ge(sa,Dt[t(g)]),ge(ca,Dt[t(y)]),Re.disabled=r()&&!t(w)||t(Z)}),he(p,()=>t(_),z=>m(_,z)),he(Je,()=>t(j),z=>m(j,z)),he(Ue,()=>t(j),z=>m(j,z)),he(We,()=>t(f),z=>m(f,z)),he(Ye,()=>t(f),z=>m(f,z)),he(Ee,()=>t(g),z=>m(g,z)),he(Ve,()=>t(g),z=>m(g,z)),he(Me,()=>t(y),z=>m(y,z)),he(Ne,()=>t(y),z=>m(y,z)),Ra(Ge,"clientWidth",z=>m(W,z)),d(o,L),oe()}je(["change","click"]);var Jr=(o,e,r)=>e()(r.project.id),Ur=c('<button type="button" class="flex_1"> </button>'),Wr=(o,e,r,i,s)=>{var _,b;return t(e)?(_=r())==null?void 0:_(i.project.id):(b=s())==null?void 0:b(i.project_data??i.load(i.project.id))},Yr=c("✕",1),Gr=c("✎",1),Kr=c('<button type="button" class="icon_button plain_button size_xl deselectable svelte-12y7az0"><!></button>'),Xr=(o,e)=>m(e,!t(e)),Zr=c("×",1),Qr=c("✕",1),$r=c('<button type="button" class="icon_button plain_button size_xl svelte-12y7az0"><!></button>'),el=c('<li class="project_item svelte-12y7az0"><!> <!> <!></li>');function tl(o,e){ne(e,!0);const r=ee(e,"select",3,null),i=ee(e,"edit",3,null),s=ee(e,"remove",3,null);let _=E(!1);var b=el(),k=n(b);x(k,r,f=>{var g=Ur();g.__click=[Jr,r,e];var y=n(g);l(g),H(()=>{be(g,"selected",e.selected),ge(y,e.project.name)}),d(f,g)});var h=a(k,!0);h.nodeValue="  ";var I=a(h);x(I,()=>t(_)&&s()||!t(_)&&i(),f=>{var g=Kr();g.__click=[Wr,_,s,e,i];var y=n(g);x(y,()=>t(_),u=>{var w=Yr();d(u,w)},u=>{var w=Gr();d(u,w)}),l(g),H(()=>{U(g,"title",t(_)?"remove project":"edit project"),be(g,"selected",e.selected&&!t(_)&&e.editing),be(g,"color_c",t(_))}),d(f,g)});var j=a(a(I,!0));x(j,s,f=>{var g=$r();g.__click=[Xr,_];var y=n(g);x(y,()=>t(_),u=>{var w=Zr();d(u,w)},u=>{var w=Qr();d(u,w)}),l(g),H(()=>U(g,"title",t(_)?"cancel removing":"remove project")),d(f,g)}),l(b),H(()=>be(b,"selected",e.selected)),pe(3,b,()=>ye),d(o,b),oe()}je(["click"]);var al=c('<menu class="unstyled width_sm mb_0"></menu>');function rl(o,e){ne(e,!0);const r=ee(e,"selected_project_id",3,null),i=ee(e,"editing_project_id",3,null),s=ee(e,"projects",11,()=>[]),_=ee(e,"project_datas",11,()=>[]);var b=al();Oe(b,77,s,(k,h)=>$(k).id,(k,h,I)=>{var j=v(()=>_().find(y=>y.id===$(h).id)),f=v(()=>$(h).id===r()),g=v(()=>$(h).id===i());tl(k,{get project(){return $(h)},get project_data(){return t(j)},get load(){return e.load_project},get select(){return e.select_project},get edit(){return e.edit_project},get remove(){return e.remove_project},get selected(){return t(f)},get editing(){return t(g)}})}),l(b),d(o,b),oe()}var ll=(o,e,r,i)=>{t(e)?r().editing_project=!1:t(i)(tt.parse({}))},nl=c('<div class="panel p_md"><header><h2 class="my_0">projects</h2></header> <!> <button type="button" class="w_100 mt_md deselectable">create a new project</button></div>');function ol(o,e){ne(e,!0);const r=ee(e,"app",7),i=v(r),s=v(()=>{let{load_project:F,select_project:te,edit_project:K,remove_project:Q}=t(i);return[F,te,K,Q]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),h=v(()=>t(s)[3]),I=v(()=>r().editing_project&&r().selected_project_id!==r().editing_project_id),j=v(()=>r().app_data),f=v(()=>{let{projects:F}=t(j);return[F]}),g=v(()=>t(f)[0]);var y=nl(),u=n(y);n(u),l(u);var w=a(a(u,!0)),S=v(()=>r().editing_project?r().editing_project_id:null);rl(w,{get selected_project_id(){return r().selected_project_id},get editing_project_id(){return t(S)},get projects(){return t(g)},get project_datas(){return r().project_datas},get load_project(){return t(_)},get select_project(){return t(b)},edit_project:F=>t(k)(F===r().editing_project_data&&r().editing_project?null:F),get remove_project(){return t(h)}});var D=a(a(w,!0));D.__click=[ll,I,r,k],l(y),H(()=>be(D,"selected",t(I))),d(o,y),oe()}je(["click"]);var il=(o,e)=>e.toggle(),_l=c(`<aside>devices with smaller screens aren't well supported yet, see <a href="https://github.com/ryanatkn/earbetter/issues/2">issue #2</a></aside> <table><tbody><tr><td class="svelte-1gwge1y"><code>Spacebar</code></td><td class="svelte-1gwge1y">replay trial</td></tr><tr><td class="svelte-1gwge1y"><code>r</code></td><td class="svelte-1gwge1y">restart level</td></tr><tr><td class="svelte-1gwge1y"><code>Escape</code></td><td class="svelte-1gwge1y"><button type="button" class="inline">toggle main menu</button></td></tr><tr><td class="svelte-1gwge1y"><code>1 to 4</code></td><td class="svelte-1gwge1y">set instrument</td></tr><tr><td class="svelte-1gwge1y"><code>c</code></td><td class="svelte-1gwge1y">connect MIDI</td></tr><tr><td class="svelte-1gwge1y"><code>up/down arrows</code></td><td class="svelte-1gwge1y">adjust volume</td></tr></tbody></table>`,1);function sl(o,e){ne(e,!0);const r=xa();var i=_l(),s=fe(i);a(n(s)),l(s);var _=a(a(s,!0)),b=n(_),k=n(b),h=n(k);n(h),l(h),a(h),l(k);var I=a(k),j=n(I);n(j),l(j),a(j),l(I);var f=a(I),g=n(f);n(g),l(g);var y=a(g),u=n(y);u.__click=[il,r],Qt(u,"min-width","172px"),l(y),l(f);var w=a(f),S=n(w);n(S),l(S),a(S),l(w);var D=a(w),F=n(D);n(F),l(F),a(F),l(D);var te=a(D),K=n(te);n(K),l(K),a(K),l(te),l(b),l(_),d(o,i),oe()}je(["click"]);var dl=c('<div class="realm_stats_summary svelte-1mwdoug" title="you performed flawlessly in every level of this realm!">★</div>');function cl(o,e){ne(e,!0);const r=v(()=>e.realm_data.levels.map(j=>e.level_stats.mistakes[j.id]??[])),i=v(()=>t(r).reduce((j,f)=>j+f.length,0)),s=v(()=>Wt*t(r).length),_=v(()=>!!t(i)&&t(i)>=t(s)),b=v(()=>t(_)?t(r).reduce((j,f)=>j+f.reduce((g,y)=>g+y,0),0):void 0),k=v(()=>t(b)===0);var h=ft(),I=fe(h);x(I,()=>t(k),j=>{var f=dl();d(j,f)}),d(o,h),oe()}var vl=(o,e,r)=>e()(r.realm_data.id),ul=c('<button type="button" class="realm_button svelte-1joa4ch"> </button>'),ml=(o,e,r,i,s)=>{var _,b;return t(e)?(_=r())==null?void 0:_(i.realm_data.id):(b=s())==null?void 0:b(i.realm_data)},gl=c("✕",1),bl=c("✎",1),fl=c('<button type="button" class="icon_button plain_button size_xl deselectable svelte-1joa4ch"><!></button>'),hl=(o,e)=>m(e,!t(e)),pl=c("×",1),yl=c("✕",1),kl=c('<button type="button" class="icon_button plain_button size_xl svelte-1joa4ch"><!></button>'),wl=c('<li class="realm_item svelte-1joa4ch"><!> <!> <!> <!></li>');function jl(o,e){ne(e,!0);const r=ee(e,"select",3,null),i=ee(e,"edit",3,null),s=ee(e,"remove",3,null);let _=E(!1);const b=v(()=>e.project_data.level_stats);var k=wl(),h=n(k);x(h,()=>t(b),y=>{cl(y,{get realm_data(){return e.realm_data},get level_stats(){return t(b)}})});var I=a(a(h,!0));x(I,r,y=>{var u=ul();u.__click=[vl,r,e];var w=n(u);l(u),H(()=>{be(u,"selected",e.selected),ge(w,e.realm_data.name)}),d(y,u)});var j=a(I,!0);j.nodeValue="  ";var f=a(j);x(f,()=>t(_)&&s()||!t(_)&&i(),y=>{var u=fl();u.__click=[ml,_,s,e,i];var w=n(u);x(w,()=>t(_),S=>{var D=gl();d(S,D)},S=>{var D=bl();d(S,D)}),l(u),H(()=>{U(u,"title",t(_)?"remove realm":e.editing?"stop editing realm":"edit realm"),be(u,"selected",e.selected&&!t(_)&&e.editing),be(u,"color_c",t(_))}),d(y,u)});var g=a(a(f,!0));x(g,s,y=>{var u=kl();u.__click=[hl,_];var w=n(u);x(w,()=>t(_),S=>{var D=pl();d(S,D)},S=>{var D=yl();d(S,D)}),l(u),H(()=>U(u,"title",t(_)?"cancel removing":"remove realm")),d(y,u)}),l(k),H(()=>be(k,"selected",e.selected)),pe(3,k,()=>ye),d(o,k),oe()}je(["click"]);var xl=c('<menu class="unstyled width_sm mb_0"></menu>');function zl(o,e){ne(e,!0);const r=ee(e,"selected_realm_data",3,null),i=ee(e,"editing_realm_id",3,null),s=ee(e,"realms",11,()=>[]),_=v(()=>new Map(s().map(h=>[h.id,h]))),b=h=>t(_).get(h);var k=xl();Oe(k,77,s,(h,I)=>$(h).id,(h,I,j)=>{var f=v(()=>b($(I).id)),g=v(()=>{var u;return $(I).id===((u=r())==null?void 0:u.id)}),y=v(()=>$(I).id===i());jl(h,{get realm_data(){return t(f)},get project_data(){return e.project_data},get select(){return e.select_realm},get edit(){return e.edit_realm},get remove(){return e.remove_realm},get selected(){return t(g)},get editing(){return t(y)}})}),l(k),d(o,k),oe()}const ql=(o,e,r,i,s)=>{var _;t(e)?(_=document.querySelector(".realm_def_form input"))==null||_.focus():t(r)?i().editing_realm=!1:t(s)(at.parse({}))};var Il=c("<div><!></div>"),Sl=c('<div class="panel p_md"><header><h2 class="my_0">realms</h2></header> <!> <button type="button">create a new realm</button></div>');function Tl(o,e){ne(e,!0);const r=ee(e,"app",7),i=v(r),s=v(()=>{let{select_realm:u,edit_realm:w,remove_realm:S}=t(i);return[u,w,S]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),h=v(()=>{var u;return r().editing_realm&&!!r().editing_realm_data&&((u=r().selected_realm_data)==null?void 0:u.id)!==r().editing_realm_data.id}),I=v(()=>{var u;return!((u=r().realms)!=null&&u.length)});var j=Sl(),f=n(j);n(f),l(f);var g=a(a(f,!0));x(g,()=>r().realms&&r().selected_project_data,u=>{var w=Il(),S=n(w),D=v(()=>r().editing_realm?r().editing_realm_id:null);zl(S,{get project_data(){return r().selected_project_data},get selected_realm_data(){return r().selected_realm_data},get realms(){return r().realms},get editing_realm_id(){return t(D)},get select_realm(){return t(_)},edit_realm:F=>t(b)(F===r().editing_realm_data&&r().editing_realm?null:F),get remove_realm(){return t(k)}}),l(w),pe(3,w,()=>ye),d(u,w)});var y=a(a(g,!0));y.__click=[ql,I,h,r,b],l(j),H(()=>{Na(y,`${(t(I)?void 0:"deselectable")??""} svelte-100yq62`),be(y,"selected",t(h)||t(I))}),d(o,j),oe()}je(["click"]);const Al=(o,e,r,i,s)=>{m(e,"");try{const _=JSON.parse(t(r));_&&!_.id&&(_.id=La());const b=at.parse(_);i.onsubmit(b)}catch(_){console.error("failed to import data",_),m(e,M(_.message||"unknown error"))}m(s,!1)},Pl=(o,e,r,i,s)=>{m(e,M(m(r,M(JSON.stringify(i()))))),m(s,!0)};var Ll=c('<div class="importing bg shadow_d_xl p_xl width_md box svelte-1g446ss"><h2 class="my_0">import realm data</h2> <!> <textarea class="svelte-1g446ss"></textarea> <button type="button" class="svelte-1g446ss">import realm data</button></div>'),El=c("editing realm",1),Ml=c("create a new realm",1),Dl=(o,e,r)=>{o.key==="Enter"&&(Gt(o),e.onsubmit(r()))},Ol=(o,e,r)=>e.onsubmit(r()),Vl=c("save changes to realm",1),Nl=c("create realm",1),Rl=(o,e)=>m(e,!t(e)),Cl=(o,e,r)=>{m(e,!1),r.onremove(r.realm_data.id)},Fl=c('<div class="pb_md"><button type="button" class="color_c w_100 svelte-1g446ss">✕ confirm remove</button></div>'),Hl=(o,e)=>e.onduplicate(e.realm_data.id),Bl=c('<button type="button" class="svelte-1g446ss">duplicate realm</button>'),Jl=c('<button type="button" class="svelte-1g446ss">remove realm</button> <!> <!>',1),Ul=c("import/export data",1),Wl=c("import data",1),Yl=(o,e)=>m(e,!t(e)),Gl=(o,e,r)=>{m(e,!1),r.onsubmit(Yt().realms)},Kl=c('<div><button type="button" class="w_100 svelte-1g446ss"> </button></div>'),Xl=c('<button type="button" class="svelte-1g446ss">create default realms</button> <!>',1),Zl=c("<pre> </pre>"),Ql=c('<div class="message-wrapper svelte-1g446ss"><!></div>'),$l=(o,e)=>e.onclose(e.realm_data.id),en=c("discard changes",1),tn=c("close realm editor",1),an=c('<button class="w_100 svelte-1g446ss" type="button"><!></button>'),rn=c('<!> <form class="realm_def_form"><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent svelte-1g446ss"><!></button> <!> <button type="button" class="svelte-1g446ss"><!></button> <!> <!> <!></form>',1);function ln(o,e){ne(e,!0);const r=ee(e,"editing",3,!1);let i=E(!1),s=E(M(e.realm_data.name));const _=v(()=>{var T;return(T=t(s))==null?void 0:T.trim()}),b=()=>at.parse({id:e.realm_data.id,name:t(_),levels:e.realm_data.levels});De(()=>{console.log("set_realm_data",e.realm_data),m(s,M(e.realm_data.name))});const k=v(()=>t(_)!==e.realm_data.name);let h=E(!1),I=E(""),j=E("");const f=v(()=>t(I)!==t(j));let g=E("");De(()=>{e.realm_data,m(g,"")});let y=E(void 0),u=E(void 0);const w=Yt().realms;let S=E(!1);var D=rn(),F=fe(D);x(F,()=>t(h),T=>{Fe(T,{onclose:()=>{var A;m(h,!1),(A=t(u))==null||A.focus()},children:(A,C)=>{var O=Ll(),G=n(O),B=a(a(G,!0));ht(B,{get text(){return t(j)},oncopy:()=>{var X;(X=t(y))==null||X.select()}});var p=a(a(B,!0));Te(p,X=>m(y,M(X)),()=>t(y)),He(p);var P=a(a(p,!0));P.__click=[Al,g,j,e,h],l(O),H(()=>{P.disabled=!t(f),U(P,"title",t(f)?void 0:"data has not changed")}),he(p,()=>t(j),X=>m(j,X)),d(A,O)},$$slots:{default:!0}})});var te=a(a(F,!0)),K=n(te),Q=n(K),ie=n(Q);x(ie,r,T=>{var A=El();d(T,A)},T=>{var A=Ml();d(T,A)}),l(Q),l(K);var ve=a(a(K,!0)),le=n(ve),_e=n(le),ue=a(a(_e,!0));we(ue),ue.__keydown=[Dl,e,b],l(le),l(ve);var N=a(a(ve,!0));N.__click=[Ol,e,b];var V=n(N);x(V,r,T=>{var A=Vl();d(T,A)},T=>{var A=Nl();d(T,A)}),l(N);var J=a(a(N,!0));x(J,()=>e.onremove&&r(),T=>{var A=Jl(),C=fe(A);C.__click=[Rl,i];var O=a(a(C,!0));x(O,()=>t(i),B=>{var p=Fl(),P=n(p);P.__click=[Cl,i,e],l(p),pe(3,p,()=>ye),d(B,p)});var G=a(a(O,!0));x(G,()=>e.onduplicate,B=>{var p=Bl();p.__click=[Hl,e],d(B,p)}),d(T,A)});var W=a(a(J,!0));Te(W,T=>m(u,M(T)),()=>t(u)),W.__click=[Pl,I,j,b,h];var Z=n(W);x(Z,r,T=>{var A=Ul();d(T,A)},T=>{var A=Wl();d(T,A)}),l(W);var L=a(a(W,!0));x(L,()=>!r(),T=>{var A=Xl(),C=fe(A);C.__click=[Yl,S];var O=a(a(C,!0));x(O,()=>t(S),G=>{var B=Kl(),p=n(B);p.__click=[Gl,S,e];var P=n(p);l(p),l(B),H(()=>ge(P,`create ${w.length??""} new realms`)),pe(3,B,()=>ye),d(G,B)}),d(T,A)});var q=a(a(L,!0));x(q,()=>t(g),T=>{var A=Ql(),C=n(A);$e(C,{status:"error",children:(O,G)=>{var B=Zl(),p=n(B);l(B),H(()=>ge(p,t(g))),d(O,B)},$$slots:{default:!0}}),l(A),d(T,A)});var Y=a(a(q,!0));x(Y,()=>e.onclose&&r(),T=>{var A=an();A.__click=[$l,e];var C=n(A);x(C,()=>t(k),O=>{var G=en();d(O,G)},O=>{var G=tn();d(O,G)}),l(A),d(T,A)}),l(te),H(()=>N.disabled=r()&&!t(k)),he(ue,()=>t(s),T=>m(s,T)),d(o,D),oe()}je(["click","keydown"]);var nn=c('<div class="panel p_md"><!></div>');function on(o,e){ne(e,!0);const r=ee(e,"app",7),i=v(r),s=v(()=>{let{remove_realm:u,duplicate_realm:w,update_realm:S,create_realm:D}=t(i);return[u,w,S,D]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),h=v(()=>t(s)[3]),I=v(()=>r().editing_realm_data??at.parse({})),j=v(()=>r().realms?r().realms.some(u=>u.id===t(I).id):!1),f=(u,w)=>{var S;(S=r().realms)!=null&&S.some(D=>D.id===u.id)?t(k)(u):t(h)(u,w)};var g=nn(),y=n(g);ln(y,{get editing(){return t(j)},get realm_data(){return t(I)},onsubmit:u=>{if(Array.isArray(u))for(let w=0;w<u.length;w++)f(u[w],w===0);else f(u,!0)},onremove:u=>t(_)(u),onduplicate:u=>t(b)(u),onclose:()=>r().editing_realm=!1}),l(g),d(o,g),oe()}var _n=(o,e)=>e.app.play_level(e.level_data.id),sn=async(o,e,r,i)=>{if(t(e))r.app.remove_level(r.level_data.id);else{const s=!t(i);if(r.app.edit_level(s?r.level_data:null),s){await ya();const _=document.querySelector(".level_def_form");_==null||_.scrollIntoView({behavior:"smooth",block:"center"})}}},dn=c("✕",1),cn=c("✎",1),vn=(o,e)=>m(e,!t(e)),un=c("×",1),mn=c("✕",1),gn=c('<li class="level_map_item svelte-170pvnv"><!> <button type="button" class="level_button deselectable svelte-170pvnv" title="play this level"> </button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button></li>');function bn(o,e){ne(e,!0);const r=v(()=>e.app.draft_level_data===e.level_data),i=v(()=>e.app.editing_level&&t(r)),s=v(()=>{var w;return(w=e.app.selected_project_data)==null?void 0:w.level_stats});let _=E(!1);const b=v(()=>t(i)||t(r));var k=gn(),h=n(k);x(h,()=>t(s),w=>{Ha(w,{get level_data(){return e.level_data},get level_stats(){return t(s)}})});var I=a(a(h,!0));I.__click=[_n,e];var j=n(I);l(I);var f=a(a(I,!0));f.__click=[sn,_,e,i];var g=n(f);x(g,()=>t(_),w=>{var S=dn();d(w,S)},w=>{var S=cn();d(w,S)}),l(f);var y=a(a(f,!0));y.__click=[vn,_];var u=n(y);x(u,()=>t(_),w=>{var S=un();d(w,S)},w=>{var S=mn();d(w,S)}),l(y),l(k),H(()=>{be(k,"selected",t(b)),be(I,"selected",t(b)),ge(j,e.level_data.name),U(f,"title",t(_)?"remove level":t(i)?"stop editing level":"edit level"),be(f,"selected",!t(_)&&t(i)),be(f,"color_c",t(_)),U(y,"title",t(_)?"cancel removing":"remove level")}),pe(3,k,()=>ye),d(o,k),oe()}je(["click"]);const fn=(o,e,r,i)=>{var s;t(e)?(s=document.querySelector(".level_def_form input"))==null||s.focus():r.app.edit_level(t(i)?null:et.parse({}))};var hn=c('<div class="panel p_md"><header><h2 class="my_0">levels</h2> <h3 class="my_0"> </h3></header> <menu class="levels unstyled mb_0 svelte-wmjxbn"></menu> <button type="button" class="svelte-wmjxbn">create a new level</button></div>');function pn(o,e){ne(e,!0);const r=v(()=>e.app.editing_level&&!e.levels.some(f=>f===e.app.draft_level_data)),i=v(()=>!e.levels.length);var s=hn(),_=n(s),b=n(_),k=a(a(b,!0)),h=n(k);l(k),l(_);var I=a(a(_,!0));Oe(I,77,()=>e.levels,(f,g)=>$(f).id,(f,g,y)=>{bn(f,{get app(){return e.app},get level_data(){return $(g)}})}),l(I);var j=a(a(I,!0));j.__click=[fn,i,e,r],l(s),H(()=>{var f;ge(h,(f=e.app.selected_realm_data)==null?void 0:f.name),be(j,"selected",t(r)||t(i)),be(j,"deselectable",!t(i))}),d(o,s),oe()}je(["click"]);const yn=(o,e,r,i,s)=>{m(e,"");try{const _=JSON.parse(t(r));_&&!_.id&&(_.id=Ea());const b=tt.parse(_);i.onsubmit(b)}catch(_){console.error("failed to import data",_),m(e,M(_.message||"unknown error"))}m(s,!1)},kn=(o,e,r,i,s)=>{m(e,M(m(r,M(JSON.stringify(i()))))),m(s,!0)};var wn=c('<div class="importing bg shadow_d_xl p_xl width_md box svelte-l3tcx7"><h2 class="my_0">import project data</h2> <!> <textarea class="svelte-l3tcx7"></textarea> <button type="button" class="svelte-l3tcx7">import project data</button></div>'),jn=c("editing project",1),xn=c("create a new project",1),zn=(o,e,r)=>{o.key==="Enter"&&(Gt(o),e.onsubmit(r()))},qn=(o,e,r)=>e.onsubmit(r()),In=c("save changes to project",1),Sn=c("create project",1),Tn=(o,e)=>m(e,!t(e)),An=(o,e,r)=>{m(e,!1),r.onremove(r.project_data.id)},Pn=c('<div class="pb_md"><button type="button" class="color_c w_100 svelte-l3tcx7">✕ confirm remove</button></div>'),Ln=(o,e)=>e.onduplicate(e.project_data.id),En=c('<button type="button" class="w_100 svelte-l3tcx7">duplicate project</button>'),Mn=c('<button class="w_100 svelte-l3tcx7" type="button">remove project</button> <!> <!>',1),Dn=c("import/export data",1),On=c("import data",1),Vn=c("<pre> </pre>"),Nn=c('<div class="overflow_x_auto"><!></div>'),Rn=(o,e)=>e.onclose(e.project_data.id),Cn=c("discard changes and stop editing",1),Fn=c("close project editor",1),Hn=c('<button type="button" class="w_100 svelte-l3tcx7"><!></button>'),Bn=c('<!> <form><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent w_100 svelte-l3tcx7"><!></button> <!> <button type="button" class="w_100 svelte-l3tcx7"><!></button> <!> <!></form>',1);function Jn(o,e){ne(e,!0);const r=ee(e,"editing",3,!1);let i=E(!1),s=E(M(e.project_data.name));const _=v(()=>t(s).trim()),b=()=>tt.parse({id:e.project_data.id,name:t(_),realms:e.project_data.realms,level_stats:e.project_data.level_stats});De(()=>{console.log("set_project_data",e.project_data),m(s,M(e.project_data.name))});const k=v(()=>t(_)!==e.project_data.name);let h=E(!1),I=E(""),j=E("");const f=v(()=>t(I)!==t(j));let g=E("");De(()=>{e.project_data,m(g,"")});let y=E(void 0),u=E(void 0);var w=Bn(),S=fe(w);x(S,()=>t(h),L=>{Fe(L,{onclose:()=>{var q;m(h,!1),(q=t(u))==null||q.focus()},children:(q,Y)=>{var T=wn(),A=n(T),C=a(a(A,!0));ht(C,{get text(){return t(j)},oncopy:()=>{var B;(B=t(y))==null||B.select()}});var O=a(a(C,!0));Te(O,B=>m(y,M(B)),()=>t(y)),He(O);var G=a(a(O,!0));G.__click=[yn,g,j,e,h],l(T),H(()=>{G.disabled=!t(f),U(G,"title",t(f)?void 0:"data has not changed")}),he(O,()=>t(j),B=>m(j,B)),d(q,T)},$$slots:{default:!0}})});var D=a(a(S,!0)),F=n(D),te=n(F),K=n(te);x(K,r,L=>{var q=jn();d(L,q)},L=>{var q=xn();d(L,q)}),l(te),l(F);var Q=a(a(F,!0)),ie=n(Q),ve=n(ie),le=a(a(ve,!0));we(le),le.__keydown=[zn,e,b],l(ie),l(Q);var _e=a(a(Q,!0));_e.__click=[qn,e,b];var ue=n(_e);x(ue,r,L=>{var q=In();d(L,q)},L=>{var q=Sn();d(L,q)}),l(_e);var N=a(a(_e,!0));x(N,()=>e.onremove&&r(),L=>{var q=Mn(),Y=fe(q);Y.__click=[Tn,i];var T=a(a(Y,!0));x(T,()=>t(i),C=>{var O=Pn(),G=n(O);G.__click=[An,i,e],l(O),pe(3,O,()=>ye),d(C,O)});var A=a(a(T,!0));x(A,()=>e.onduplicate,C=>{var O=En();O.__click=[Ln,e],d(C,O)}),d(L,q)});var V=a(a(N,!0));Te(V,L=>m(u,M(L)),()=>t(u)),V.__click=[kn,I,j,b,h];var J=n(V);x(J,r,L=>{var q=Dn();d(L,q)},L=>{var q=On();d(L,q)}),l(V);var W=a(a(V,!0));x(W,()=>t(g),L=>{var q=Nn(),Y=n(q);$e(Y,{status:"error",children:(T,A)=>{var C=Vn(),O=n(C);l(C),H(()=>ge(O,t(g))),d(T,C)},$$slots:{default:!0}}),l(q),d(L,q)});var Z=a(a(W,!0));x(Z,()=>e.onclose&&r(),L=>{var q=Hn();q.__click=[Rn,e];var Y=n(q);x(Y,()=>t(k),T=>{var A=Cn();d(T,A)},T=>{var A=Fn();d(T,A)}),l(q),d(L,q)}),l(D),H(()=>_e.disabled=r()&&!t(k)),he(le,()=>t(s),L=>m(s,L)),d(o,w),oe()}je(["click","keydown"]);var Un=c('<div class="panel p_md"><!></div>');function Wn(o,e){ne(e,!0);const r=ee(e,"app",7),i=v(r),s=v(()=>{let{remove_project:u,duplicate_project:w,update_project:S,create_project:D}=t(i);return[u,w,S,D]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),h=v(()=>t(s)[3]),I=v(()=>r().editing_project_data??tt.parse({})),j=v(()=>r().project_datas.some(u=>u.id===t(I).id));var f=Un(),g=n(f),y=v(()=>t(j)?t(k):t(h));Jn(g,{get editing(){return t(j)},get project_data(){return t(I)},get onsubmit(){return t(y)},get onremove(){return t(_)},get onduplicate(){return t(b)},onclose:()=>r().editing_project=!1}),l(f),d(o,f),oe()}var Yn=c('<section class="card svelte-8muejm"><!></section>'),Gn=c('<section class="card svelte-8muejm"><!></section>'),Kn=c('<div class="width_sm svelte-8muejm"><!> <!> <section class="card svelte-8muejm"><div class="panel p_md"><header><h2 class="my_0">controls</h2></header> <!> <div class="mb_lg"><!></div> <!> <aside>Earbetter supports MIDI devices like piano keyboards, connect and click:</aside> <!></div></section></div>'),Xn=(o,e)=>t(e)(),Zn=c(`<section class="card svelte-8muejm"><div class="panel p_md"><p>Earbetter is an <a href="https://wikipedia.org/wiki/Ear_training">ear training</a> tool:</p> <ul><li>each level is a standalone challenge that's a series of trials</li> <li> </li> <li>realms group levels into bigger challenges</li> <li>projects group realms so you can customize various experiences</li> <li>levels can be shared via their links or exporting/importing data</li></ul> <p>See also the 3 minute <a href="https://www.youtube.com/watch?v=zW2zI1A_Ikw">video intro on YouTube</a> and <a href="https://github.com/ryanatkn/earbetter">the readme</a>.</p> <aside>Earbetter is in early development, and many things are unfinished and unknown - feedback
						is appreciated on <a href="https://github.com/ryanatkn/earbetter">the GitHub discussions and issues</a>.</aside> <div class="box row"><button type="button" class="m_0">ok, hide this</button></div></div></section>`),Qn=c('<section class="card svelte-8muejm"><!></section>'),$n=c('<section class="card svelte-8muejm"><!></section>'),eo=c('<section class="card svelte-8muejm"><div class="panel p_md"><!></div></section>'),to=c('<div class="width_sm svelte-8muejm"><!> <!></div>'),ao=c('<!> <div class="map svelte-8muejm"><!> <div class="width_sm svelte-8muejm"><!> <section class="card svelte-8muejm"><!></section> <!></div> <!></div>',1);function ro(o,e){ne(e,!0);const r=ee(e,"app",7),i=v(r),s=v(()=>{let{toggle_trainer_help:N,play_level:V,edit_level:J,remove_level:W,duplicate_level:Z,create_level:L,update_level:q}=t(i);return[N,V,J,W,Z,L,q]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),h=v(()=>t(s)[3]),I=v(()=>t(s)[4]),j=v(()=>t(s)[5]),f=v(()=>t(s)[6]),g=Ft();window.ac=g;const y=v(()=>r().draft_level_data??et.parse({})),u=v(()=>r().levels?r().levels.some(N=>N.id===t(y).id):!1),w=v(()=>{var N;return!((N=r().realms)!=null&&N.length)});var S=ao(),D=fe(S);ea(D,{get midi_access(){return r().midi_access},onnotestart:(N,V)=>{Bt(r(),g(),N,Jt(r().volume,V),r().instrument)},onnotestop:N=>{gt(N)}});var F=a(a(D,!0)),te=n(F);x(te,()=>r().project_datas.length,N=>{var V=Kn(),J=n(V);x(J,()=>r().selected_project_data,p=>{var P=Yn(),X=n(P);ol(X,{get app(){return r()}}),l(P),pe(3,P,()=>ye),d(p,P)});var W=a(J,!0);W.nodeValue="  ";var Z=a(W);x(Z,()=>r().editing_project&&r().editing_project_data||!r().selected_project_data,p=>{var P=Gn(),X=n(P);Wn(X,{get app(){return r()}}),l(P),pe(3,P,()=>ye),d(p,P)});var L=a(a(Z,!0)),q=n(L),Y=n(q);n(Y),l(Y);var T=a(a(Y,!0));sl(T,{});var A=a(a(T,!0)),C=n(A);Xt(C,{get volume(){return r().volume},set volume(p){r().volume=p}}),l(A);var O=a(a(A,!0));Kt(O,{get instrument(){return r().instrument},set instrument(p){r().instrument=p}});var G=a(a(O,!0)),B=a(a(G,!0));Zt(B,{get midi_state(){return r()}}),l(q),l(L),l(V),pe(3,L,()=>ye),d(N,V)});var K=a(a(te,!0)),Q=n(K);x(Q,()=>r().show_trainer_help,N=>{var V=Zn(),J=n(V),W=n(J);a(n(W)),Pe(),l(W);var Z=a(a(W,!0)),L=n(Z),q=a(a(L,!0)),Y=n(q);Y.nodeValue=`your level score is the sum of mistakes in your best ${Wt}
							runs, win a ★ at 0`,l(q);var T=a(a(q,!0)),A=a(a(T,!0));a(a(A,!0)),l(Z);var C=a(a(Z,!0)),O=a(n(C));a(a(O,!0)),Pe(),l(C);var G=a(a(C,!0));a(n(G)),Pe(),l(G);var B=a(a(G,!0)),p=n(B);p.__click=[Xn,_],l(B),l(J),l(V),pe(3,V,()=>ye),d(N,V)});var ie=a(a(Q,!0)),ve=n(ie);Tl(ve,{get app(){return r()}}),l(ie);var le=a(ie,!0);le.nodeValue="  ";var _e=a(le);x(_e,()=>r().editing_realm&&r().editing_realm_data||t(w),N=>{var V=Qn(),J=n(V);on(J,{get app(){return r()}}),l(V),pe(3,V,()=>ye),d(N,V)}),l(K);var ue=a(a(K,!0));x(ue,()=>r().project_datas.length,N=>{var V=to(),J=n(V);x(J,()=>r().levels,L=>{var q=$n(),Y=n(q);pn(Y,{get app(){return r()},get levels(){return r().levels}}),l(q),pe(3,q,()=>ye),d(L,q)});var W=a(J,!0);W.nodeValue="  ";var Z=a(W);x(Z,()=>{var L;return r().selected_realm_id&&(r().editing_level&&r().levels||((L=r().levels)==null?void 0:L.length)===0)},L=>{var q=eo(),Y=n(q),T=n(Y),A=v(()=>t(u)?t(f):t(j));Br(T,{get editing(){return t(u)},get level_data(){return t(y)},get onsubmit(){return t(A)},get onremove(){return t(h)},get onduplicate(){return t(I)},onplay:async(C,O)=>{O&&t(f)(C),await t(b)(C.id)},onclose:()=>t(k)(null)}),l(Y),l(q),pe(2,q,()=>ye),d(L,q)}),l(V),d(N,V)}),l(F),d(o,S),oe()}je(["click"]);var lo=c('<main><!> <!> <!> <div class="box"><!></div></main>');function ko(o,e){ne(e,!0);const r=Ut();var i=lo();ha(I=>{pa.title="Earbetter trainer"});var s=n(i);Ca(s,{onclick:()=>ka(wa+"/")});var _=a(a(s,!0));ja(_);var b=a(a(_,!0));ro(b,{app:r});var k=a(a(b,!0)),h=n(k);za(h,{}),l(k),l(i),d(o,i),oe()}export{ko as component};
