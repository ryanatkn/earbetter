import{t as B,a as w,s as $,b as se,d as de,h as me}from"../chunks/D6FQBtKd.js";import{p as Y,t as T,d as q,s,c as r,g as v,a as i,b as ne,n as ce,f as ie,V as K,M as Q,T as ue,X as pe,G as O}from"../chunks/Drfw-9es.js";import{p as H,i as J}from"../chunks/CnDERkxj.js";import{s as _,c as fe,r as j,e as U,d as ge}from"../chunks/wr1Q2OBW.js";import{M as be,B as xe,b as he,P as ye}from"../chunks/DdIYz--E.js";import{a as z,b as F,m as Z,t as ke,c as we,l as Ie,d as Me,p as Ae,e as ee,f as Se,z as Te,g as te,h as $e,j as Be,k as Ce,n as ae,o as Ee,w as Pe}from"../chunks/HpLCJ4lA.js";import{g as De,b as Ve}from"../chunks/D6zbdzEv.js";import{b as G,i as je,a as ze,s as Fe,I as Ge,V as He,c as Ne}from"../chunks/B8YM406V.js";import{H as Re}from"../chunks/1lRjlmRu.js";import{F as We}from"../chunks/ueByMWVq.js";import{A as Xe}from"../chunks/rZfaOUOJ.js";var Ke=B("<div><!></div>"),Oe=B('<div><div class="box row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="range"> <input type="number"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="range"> <input type="number"></label></div> <!></div>');function Ye(I,d){Y(d,!0);let e=H(d,"min_note",15),x=H(d,"max_note",15);const h=ne(()=>e()>x()?"note min cannot be larger than the max":!1);var m=Oe();let o;var c=r(m),y=r(c),k=s(r(y),2),u=r(k,!0);i(k);var n=s(k,2);j(n),_(n,"step",1),_(n,"min",z),_(n,"max",F);var a=s(n,2);j(a),_(a,"step",1),_(a,"min",z),_(a,"max",F),i(y);var p=s(y,2),f=s(r(p),2),A=r(f,!0);i(f);var g=s(f,2);j(g),_(g,"step",1),_(g,"min",z),_(g,"max",F);var l=s(g,2);j(l),_(l,"step",1),_(l,"min",z),_(l,"max",F),i(p),i(c);var M=s(c,2);{var D=b=>{var S=Ke(),N=r(S);Xe(N,{status:"error",children:(C,V)=>{ce();var E=se();T(()=>$(E,v(h))),w(C,E)},$$slots:{default:!0}}),i(S),ke(3,S,()=>we),w(b,S)};J(M,b=>{v(h)&&b(D)})}i(m),T(b=>{o=fe(m,1,"midi-range-control",null,o,b),$(u,Z[e()]),$(A,Z[x()])},[()=>({error:!!v(h)})]),G(n,e),G(a,e),G(g,x),G(l,x),w(I,m),q()}var qe=(I,d)=>d(Ie(I.currentTarget.value)),Je=B("<option> </option>"),Le=B("<option> <!></option>"),Qe=B('<label class="text_align_center svelte-199vc6u"><div class="title">scale</div> <select></select></label> <label class="text_align_center svelte-199vc6u"><div class="title">key</div> <select></select></label>',1);function Ue(I,d){Y(d,!0);let e=H(d,"scale",15),x=H(d,"key",15);var h=Qe(),m=ie(h),o=s(r(m),2);je(o,()=>e().name);var c;o.__input=[qe,e],U(o,20,()=>Me,u=>u,(u,n)=>{var a=Je(),p={},f=r(a,!0);i(a),T(()=>{p!==(p=n.name)&&(a.value=(a.__value=n.name)==null?"":n.name),$(f,n.name)}),w(u,a)}),i(o),i(m);var y=s(m,2),k=s(r(y),2);U(k,20,()=>Ae,u=>u,(u,n)=>{var a=Le(),p={},f=r(a,!0),A=s(f);{var g=l=>{var M=se();T(()=>$(M,`/${ee[n]??""}`)),w(l,M)};J(A,l=>{n in ee&&l(g)})}i(a),T(()=>{p!==(p=n)&&(a.value=(a.__value=n)==null?"":n),$(f,n)}),w(u,a)}),i(k),i(y),T(()=>{c!==(c=e().name)&&(o.value=(o.__value=e().name)==null?"":e().name,Fe(o,e().name))}),ze(k,x),w(I,h),q()}de(["input"]);var Ze=B('<!> <main class="svelte-3fkhg9"><!> <!> <div class="piano_wrapper svelte-3fkhg9"><!></div> <form class="width_sm panel p_md"><fieldset><!> <div class="row mb_lg"><!></div> <!></fieldset> <fieldset><!></fieldset> <fieldset class="row"><!></fieldset></form> <!></main>',1);function dt(I,d){Y(d,!0);const e=Se.get(),x=Te.object({min_note:te.default(36),max_note:te.default(96)}),h="piano",m=$e(h,()=>x.parse({}),x.parse);let o=K(Q(m.min_note)),c=K(Q(m.max_note));const y=()=>({min_note:v(o),max_note:v(c)});ue(()=>Ce(h,y()));const u=Be.get(),{playing_notes:n}=e;let a=K(void 0);const p=20,f=(t,P=null)=>{(!e.enabled_notes||e.enabled_notes.has(t))&&Ee(e,u(),t,Pe(e.volume,P),e.instrument)};var A=Ze();me(t=>{pe.title="Earbetter: piano"});var g=ie(A);be(g,{get midi_access(){return e.midi_access},onnotestart:(t,P)=>f(t,P),onnotestop:t=>ae(t)});var l=s(g,2),M=r(l);xe(M,{onclick:()=>De(Ve+"/")});var D=s(M,2);Re(D);var b=s(D,2);ge(b,"",{},{padding:`${p}px`});var S=r(b);{var N=t=>{const P=ne(()=>v(a)-p*2);ye(t,{get width(){return v(P)},get min_note(){return v(o)},get max_note(){return v(c)},pressed_keys:n,get enabled_notes(){return e.enabled_notes},onpress:X=>f(X),onrelease:X=>ae(X),middle_c_label:!0,allow_sticking:!0})};J(S,t=>{v(a)&&t(N)})}i(b);var C=s(b,2),V=r(C),E=r(V);Ge(E,{get instrument(){return e.instrument},set instrument(t){e.instrument=t}});var R=s(E,2),re=r(R);Ue(re,{get scale(){return e.scale},set scale(t){e.scale=t},get key(){return e.key},set key(t){e.key=t}}),i(R);var oe=s(R,2);He(oe,{get volume(){return e.volume},set volume(t){e.volume=t}}),i(V);var W=s(V,2),le=r(W);Ne(le,{midi_state:e}),i(W);var L=s(W,2),_e=r(L);Ye(_e,{get min_note(){return v(o)},set min_note(t){O(o,t,!0)},get max_note(){return v(c)},set max_note(t){O(c,t,!0)}}),i(L),i(C);var ve=s(C,2);We(ve,{}),i(l),he(l,"clientWidth",t=>O(a,t)),w(I,A),q()}export{dt as component};
