import{t as D,a as w,s as C,b as se,d as de,h as me}from"../chunks/BkDeQcoF.js";import{p as X,t as B,a as Y,s,c as i,g as v,r as n,d as ne,n as ce,f as re,N as O,D as L,M as ue,Q as pe,F as Q}from"../chunks/D3PyqNrN.js";import{p as R,i as q}from"../chunks/DZ3TPD6y.js";import{s as _,c as fe,r as N,e as U,d as ge}from"../chunks/D8xi9fHe.js";import{M as be,B as xe,b as he,P as ye}from"../chunks/BHWP-4OH.js";import{a as j,b as z,m as Z,t as ke,c as we,l as Ie,d as Me,p as Ae,e as ee,f as Se,z as Be,g as te,h as Ce,j as De,k as Ee,n as ae,o as Pe,w as Te}from"../chunks/DBDXvqfh.js";import{g as $e,b as Fe}from"../chunks/BCeNIcf5.js";import{b as H,i as Ne,a as je,s as ze,I as He,V as Re,c as Ve}from"../chunks/BS-RXt6y.js";import{H as We}from"../chunks/BQBX6aFq.js";import{F as Ge}from"../chunks/Bdz91Nmn.js";import{A as Ke}from"../chunks/BDPQQhFR.js";var Oe=D("<div><!></div>"),Qe=D('<div><div class="box row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="range"> <input type="number"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="range"> <input type="number"></label></div> <!></div>');function Xe(I,d){X(d,!0);let e=R(d,"min_note",15),x=R(d,"max_note",15);const h=ne(()=>e()>x()?"note min cannot be larger than the max":!1);var m=Qe();let o;var c=i(m),y=i(c),k=s(i(y),2),u=i(k,!0);n(k);var r=s(k,2);N(r),_(r,"step",1),_(r,"min",j),_(r,"max",z);var a=s(r,2);N(a),_(a,"step",1),_(a,"min",j),_(a,"max",z),n(y);var g=s(y,2),p=s(i(g),2),A=i(p,!0);n(p);var f=s(p,2);N(f),_(f,"step",1),_(f,"min",j),_(f,"max",z);var l=s(f,2);N(l),_(l,"step",1),_(l,"min",j),_(l,"max",z),n(g),n(c);var M=s(c,2);{var $=b=>{var S=Oe(),V=i(S);Ke(V,{status:"error",children:(E,F)=>{ce();var P=se();B(()=>C(P,v(h))),w(E,P)},$$slots:{default:!0}}),n(S),ke(3,S,()=>we),w(b,S)};q(M,b=>{v(h)&&b($)})}n(m),B(b=>{o=fe(m,1,"midi-range-control",null,o,b),C(u,Z[e()]),C(A,Z[x()])},[()=>({error:!!v(h)})]),H(r,e),H(a,e),H(f,x),H(l,x),w(I,m),Y()}var Ye=(I,d)=>d(Ie(I.currentTarget.value)),qe=D("<option> </option>"),Je=D("<option> <!></option>"),Le=D('<label class="text_align_center svelte-199vc6u"><div class="title">scale</div> <select></select></label> <label class="text_align_center svelte-199vc6u"><div class="title">key</div> <select></select></label>',1);function Ue(I,d){X(d,!0);let e=R(d,"scale",15),x=R(d,"key",15);var h=Le(),m=re(h),o=s(i(m),2);Ne(o,()=>e().name);var c;o.__input=[Ye,e],U(o,20,()=>Me,u=>u,(u,r)=>{var a=qe(),g={},p=i(a,!0);n(a),B(()=>{g!==(g=r.name)&&(a.value=(a.__value=r.name)??""),C(p,r.name)}),w(u,a)}),n(o),n(m);var y=s(m,2),k=s(i(y),2);U(k,20,()=>Ae,u=>u,(u,r)=>{var a=Je(),g={},p=i(a,!0),A=s(p);{var f=l=>{var M=se();B(()=>C(M,`/${ee[r]??""}`)),w(l,M)};q(A,l=>{r in ee&&l(f)})}n(a),B(()=>{g!==(g=r)&&(a.value=(a.__value=r)??""),C(p,r)}),w(u,a)}),n(k),n(y),B(()=>{c!==(c=e().name)&&(o.value=(o.__value=e().name)??"",ze(o,e().name))}),je(k,x),w(I,h),Y()}de(["input"]);var Ze=D('<!> <main class="svelte-3fkhg9"><!> <!> <div class="piano_wrapper svelte-3fkhg9"><!></div> <form class="width_sm panel p_md"><fieldset><!> <div class="row mb_lg"><!></div> <!></fieldset> <fieldset><!></fieldset> <fieldset class="row"><!></fieldset></form> <!></main>',1);function dt(I,d){X(d,!0);const e=Se.get(),x=Be.object({min_note:te.default(36),max_note:te.default(96)}),h="piano",m=Ce(h,()=>x.parse({}),x.parse);let o=O(L(m.min_note)),c=O(L(m.max_note));const y=()=>({min_note:v(o),max_note:v(c)});ue(()=>Ee(h,y()));const u=De.get(),{playing_notes:r}=e;let a=O(void 0);const g=20,p=(t,T=null)=>{(!e.enabled_notes||e.enabled_notes.has(t))&&Pe(e,u(),t,Te(e.volume,T),e.instrument)};var A=Ze();me(t=>{pe.title="Earbetter: piano"});var f=re(A);be(f,{get midi_access(){return e.midi_access},onnotestart:(t,T)=>p(t,T),onnotestop:t=>ae(t)});var l=s(f,2),M=i(l);xe(M,{onclick:()=>$e(Fe+"/")});var $=s(M,2);We($);var b=s($,2);ge(b,"",{},{padding:"20px"});var S=i(b);{var V=t=>{const T=ne(()=>v(a)-g*2);ye(t,{get width(){return v(T)},get min_note(){return v(o)},get max_note(){return v(c)},pressed_keys:r,get enabled_notes(){return e.enabled_notes},onpress:K=>p(K),onrelease:K=>ae(K),middle_c_label:!0,allow_sticking:!0})};q(S,t=>{v(a)&&t(V)})}n(b);var E=s(b,2),F=i(E),P=i(F);He(P,{get instrument(){return e.instrument},set instrument(t){e.instrument=t}});var W=s(P,2),ie=i(W);Ue(ie,{get scale(){return e.scale},set scale(t){e.scale=t},get key(){return e.key},set key(t){e.key=t}}),n(W);var oe=s(W,2);Re(oe,{get volume(){return e.volume},set volume(t){e.volume=t}}),n(F);var G=s(F,2),le=i(G);Ve(le,{midi_state:e}),n(G);var J=s(G,2),_e=i(J);Xe(_e,{get min_note(){return v(o)},set min_note(t){Q(o,t,!0)},get max_note(){return v(c)},set max_note(t){Q(c,t,!0)}}),n(J),n(E);var ve=s(E,2);Ge(ve,{}),n(l),he(l,"clientWidth",t=>Q(a,t)),w(I,A),Y()}export{dt as component};
