import{d as xe,s as me,a as _,t as h,c as _t,b as D,h as Qt}from"../chunks/disclose-version.t6-SPuTG.js";import{p as re,v as E,f as be,c as s,r as o,s as n,t as J,g as t,a as ie,j as u,d,Y as Me,n as Le,h as xt,am as $t,_ as ea}from"../chunks/index-client.tN2euk7f.js";import{g as ta,b as aa}from"../chunks/entry.DZUVsf_l.js";import{H as la}from"../chunks/Header.CwczZtBs.js";import{g as na,F as ra}from"../chunks/Footer.CQ8JMu0r.js";import{J as qt,T as it,d as It,l as ia,U as St,W as oa,K as sa,j as Tt,k as ot,p as _a,X as st,Y as At,n as Pt,w as Et,Z as ca,g as Lt,a as Ye,b as Ge,t as pe,m as wt,_ as da,$ as Ze,c as ye,a0 as Qe,M as Mt,a1 as $e,a2 as Dt,a3 as va,s as Ot,a4 as ua}from"../chunks/index.o74CadRn.js";import{p as Q,a as N,i as y}from"../chunks/props.CjJeOVXC.js";import{l as ma,i as ga,s as ba,b as he,I as Vt,V as Ct,c as Nt,a as fa}from"../chunks/Init_Midi_Button.DrFHPmpe.js";import{f as Fe,e as De,r as ke,s as H,g as Ke,b as Rt,c as Ft,t as ge,h as ha}from"../chunks/style.DXnKmRQF.js";import{M as Jt,P as Bt,b as pa,B as ya}from"../chunks/Back_Button.CM8frOgd.js";import{b as qe}from"../chunks/this.CS9gFwL7.js";import{D as Re}from"../chunks/Dialog.Cx4Unj6o.js";import{A as Xe}from"../chunks/Alert.D4NZ_mtl.js";import{p as ka}from"../chunks/string.Dn_jmF-S.js";import{L as xa}from"../chunks/Level_Stats_Summary.CfBT6mIs.js";function wa(l,e){ma(window,["resize"],()=>e(window[l]))}var jt=Object.prototype.hasOwnProperty;function zt(l,e,a){for(a of l.keys())if(Ie(a,e))return a}function Ie(l,e){var a,r,c;if(l===e)return!0;if(l&&e&&(a=l.constructor)===e.constructor){if(a===Date)return l.getTime()===e.getTime();if(a===RegExp)return l.toString()===e.toString();if(a===Array){if((r=l.length)===e.length)for(;r--&&Ie(l[r],e[r]););return r===-1}if(a===Set){if(l.size!==e.size)return!1;for(r of l)if(c=r,c&&typeof c=="object"&&(c=zt(e,c),!c)||!e.has(c))return!1;return!0}if(a===Map){if(l.size!==e.size)return!1;for(r of l)if(c=r[0],c&&typeof c=="object"&&(c=zt(e,c),!c)||!Ie(r[1],e.get(c)))return!1;return!0}if(a===ArrayBuffer)l=new Uint8Array(l),e=new Uint8Array(e);else if(a===DataView){if((r=l.byteLength)===e.byteLength)for(;r--&&l.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(l)){if((r=l.byteLength)===e.byteLength)for(;r--&&l[r]===e[r];);return r===-1}if(!a||typeof l=="object"){r=0;for(a in l)if(jt.call(l,a)&&++r&&!jt.call(e,a)||!(a in e)||!Ie(l[a],e[a]))return!1;return Object.keys(e).length===r}}return l!==l&&e!==e}var ja=(l,e)=>u(e,N(l.currentTarget.value)),za=(l,e,a,r,c,i)=>{var m;return(m=e.oninput)==null?void 0:m.call(e,t(a),t(r)?{scale:c(),octaves:i()}:void 0)},qa=(l,e)=>e(ia(l.currentTarget.value)),Ia=h("<option> </option>"),Sa=h('<small><textarea class="preview width_sm panel svelte-1n8fnqy"></textarea></small> <button type="button" class="accent mb_lg">use these intervals</button> <label><div class="title text_align_center">scale</div> <select></select></label> <label><div class="title text_align_center">octaves</div> <div class="text_align_center"> </div> <input type="range"></label>',1);function Ta(l,e){re(e,!0);let a=Q(e,"scale",31,()=>N(qt)),r=Q(e,"octaves",15,1);const c=d(()=>oa(a(),r())),i=d(()=>it(t(c))),m=N(it(e.intervals));let f=E(N(m));const g=d(()=>(t(c),Date.now())),q=d(()=>(e.intervals,t(f),Date.now())),b=d(()=>t(g)>t(q)),p=d(()=>t(b)?t(i):t(f)),v=d(()=>St(t(p))),k=d(()=>!Ie(e.intervals,t(v))),w=d(()=>!!t(v).length);var S=Sa(),O=be(S),U=s(O);Fe(U),U.__input=[ja,f],o(O);var te=n(O,2);te.__click=[za,e,v,b,a,r];var se=n(te,2),W=n(s(se),2);ga(W,()=>a().name);var _e;W.__change=[qa,a],De(W,20,()=>It,L=>L,(L,B)=>{var Y=Ia(),K={},X=s(Y);o(Y),J(()=>{K!==(K=B.name)&&(Y.value=(Y.__value=B.name)==null?"":B.name),me(X,B.name)}),_(L,Y)}),o(W),o(se);var oe=n(se,2),le=n(s(oe),2),ae=s(le);o(le);var R=n(le,2);ke(R),H(R,"min",1),H(R,"max",6),o(oe),J(()=>{Ke(U,t(p)),te.disabled=!t(k)||!t(w),_e!==(_e=a().name)&&(W.value=(W.__value=a().name)==null?"":a().name,ba(W,a().name)),me(ae,r())}),he(R,r,L=>r(L)),_(l,S),ie()}xe(["input","click","change"]);var Aa=(l,e)=>{u(e,N(new Set))},Pa=(l,e,a)=>{var r;(r=e.oninput)==null||r.call(e,t(a))},Ea=h('<!> <button class="mb_lg" type="button">clear selection</button> <button type="button" class="accent">select <!> </button>',1),La=h("<option> </option>"),Ma=(l,e,a)=>e(t(a)),Da=h('<button type="button"> </button>'),Oa=(l,e)=>e(l.currentTarget.value),Va=h('<!> <div class="notes_input pt_lg svelte-18obm47"><!> <div class="piano_wrapper svelte-18obm47"><!></div> <section class="box"><label class="mb_lg"><div class="title text_align_center">key</div> <select></select></label> <div class="scales mb_lg svelte-18obm47"></div> <!> <div class="notes width_sm svelte-18obm47"><blockquote class="panel my_lg"><textarea></textarea></blockquote></div></section> <form class="width_sm panel p_md"><fieldset><!> <!></fieldset> <fieldset><!></fieldset></form></div>',1);function Ca(l,e){re(e,!0);const a=j=>{var P=Ea(),Z=be(P);y(Z,()=>e.before_buttons,ze=>{var je=_t(),Te=be(je);Ft(Te,()=>e.before_buttons),_(ze,je)});var fe=n(Z,2);fe.__click=[Aa,i];var we=n(fe,2);we.__click=[Pa,e,m];var Se=n(s(we));y(Se,()=>t(g)===0,ze=>{var je=D("all");_(ze,je)},ze=>{var je=D();J(()=>me(je,t(g))),_(ze,je)});var Je=n(Se);J(()=>me(Je,` tonic${ka(t(g))??""}`)),o(we),J(()=>{fe.disabled=t(g)===0,we.disabled=!t(v)}),_(j,P)},r=Q(e,"audio_state",7),{playing_notes:c}=r();let i=E(void 0);const m=d(()=>t(i)&&Array.from(t(i)).sort((j,P)=>j-P)),f=d(()=>t(i)??e.notes),g=d(()=>t(f).size),q=d(()=>t(m)&&st(t(m))),b=j=>{u(i,N(new Set(At(j))))},p=d(()=>st(Array.from(e.notes).sort((j,P)=>j-P))),v=d(()=>!!t(m)&&t(q)!==t(p)),k=j=>{const P=new Set(t(f));P.has(j)?P.delete(j):P.add(j),u(i,N(P))};let w=E(N(sa));const S=Tt();let O=E(void 0);const U=20,te=(j,P=null)=>{Pt(r(),S(),j,Et(r().volume,P),r().instrument)},se=j=>{const P=ca(j,t(w),e.min_note,e.max_note);if(!t(i)||!t(m)){u(i,N(P));return}let Z=!0;for(const we of P)if(!t(i).has(we)){Z=!1;break}const fe=Z?t(m).filter(we=>!P.has(we)):t(m).concat(Array.from(P));u(i,N(new Set(fe)))};var W=Va(),_e=be(W);Jt(_e,{get midi_access(){return r().midi_access},onnotestart:(j,P)=>te(j,P),onnotestop:j=>ot(j)});var oe=n(_e,2),le=s(oe);a(le);var ae=n(le,2);Rt(ae,"padding",`${U}px`);var R=s(ae);y(R,()=>t(O),j=>{var P=d(()=>t(O)-U*5);Bt(j,{get width(){return t(P)},get min_note(){return e.min_note},get max_note(){return e.max_note},max_height:300,pressed_keys:c,get highlighted_keys(){return t(f)},middle_c_label:!0,allow_sticking:!0,onpress:Z=>{k(Z),te(Z)},onrelease:Z=>{ot(Z)}})}),o(ae);var L=n(ae,2),B=s(L),Y=n(s(B),2);De(Y,20,()=>_a,j=>j,(j,P)=>{var Z=La(),fe={},we=s(Z);o(Z),J(()=>{fe!==(fe=P)&&(Z.value=(Z.__value=P)==null?"":P),me(we,P)}),_(j,Z)}),o(Y),o(B);var K=n(B,2);De(K,21,()=>It,j=>j.name,(j,P)=>{var Z=Da();Z.__click=[Ma,se,P];var fe=s(Z);o(Z),J(()=>me(fe,t(P).name)),_(j,Z)}),o(K);var X=n(K,2);a(X);var T=n(X,2),A=s(T),$=s(A);Fe($),$.__change=[Oa,b],o(A),o(T),o(L);var I=n(L,2),z=s(I),F=s(z);Vt(F,{get instrument(){return r().instrument},set instrument(j){r().instrument=j}});var M=n(F,2);Ct(M,{get volume(){return r().volume},set volume(j){r().volume=j}}),o(z);var C=n(z,2),G=s(C);Nt(G,{get midi_state(){return r()}}),o(C),o(I),o(oe),J(()=>Ke($,t(q))),wa("innerWidth",j=>u(O,N(j))),fa(Y,()=>t(w),j=>u(w,j)),_(l,W),ie()}xe(["click","change"]);var Na=(l,e)=>{var a;navigator.clipboard.writeText(e.text),(a=e.oncopy)==null||a.call(e)},Ra=h('<button type="button" class="my_lg"><!></button>');function ct(l,e){re(e,!0);var a=Ra();a.__click=[Na,e];var r=s(a);y(r,()=>e.children,c=>{var i=_t(),m=be(i);Ft(m,()=>e.children),_(c,i)},c=>{var i=D("copy to clipboard");_(c,i)}),o(a),_(l,a),ie()}xe(["click"]);const Fa=(l,e,a,r,c)=>{u(e,"");try{const i=JSON.parse(t(a));i&&!i.id&&(i.id=da());const m=Ze.parse(i);r.onsubmit(m)}catch(i){console.error("failed to import data",i),u(e,N(i.message||"unknown error"))}u(c,!1)},Ja=(l,e,a,r,c)=>{u(e,N(u(a,N(JSON.stringify(r()))))),u(c,!0)};var Ba=(l,e)=>u(e,St(l.currentTarget.value)),Ha=(l,e)=>u(e,!0),Ua=h("<!> <br>",1),Wa=(l,e)=>u(e,At(l.currentTarget.value)),Ya=(l,e)=>u(e,!0),Ga=(l,e,a)=>e.onsubmit(a()),Ka=(l,e)=>u(e,!t(e)),Xa=(l,e,a)=>{u(e,!1),a.onremove(a.level_data.id)},Za=h('<div class="pb_md"><button type="button" class="color_c w_100 svelte-h4qokl">✕ confirm remove</button></div>'),Qa=(l,e)=>e.onduplicate(e.level_data.id),$a=h('<button type="button" class="svelte-h4qokl">duplicate level</button>'),el=h('<button type="button" class="svelte-h4qokl">remove level</button> <!> <!>',1),tl=h("<pre> </pre>"),al=h('<div class="overflow_x_auto"><!></div>'),ll=(l,e,a,r)=>e.onplay(t(a)?r():e.level_data,t(a)),nl=h('<button type="button" class="svelte-h4qokl">play!</button>'),rl=(l,e)=>e.onclose(e.level_data.id),il=h('<button type="button" class="svelte-h4qokl"><!></button>'),ol=h('<div class="importing bg shadow_d_xl p_xl width_md box svelte-h4qokl"><h2 class="my_0">import level data</h2> <!> <textarea class="svelte-h4qokl"></textarea> <button type="button" class="svelte-h4qokl">import project data</button></div>'),sl=h('<div class="bg shadow_d_xl p_xl width_md box"><h2 class="my_0">pick intervals</h2> <!> <button type="button" class="svelte-h4qokl">cancel</button></div>'),_l=h('<button type="button" class="mb_lg svelte-h4qokl">cancel</button>'),cl=h('<div class="bg shadow_d_xl py_xl box"><h2 class="my_0">pick tonics</h2> <!></div>'),dl=h(`<form class="level_def_form w_100"><header><h2 class="my_0"><!></h2></header> <div class="fields svelte-h4qokl"><fieldset><label><div class="title">name</div> <input></label></fieldset> <fieldset><label class="mb_0" title="the semitones to include relative to the tonic"><div class="title">intervals</div> <input></label> <button type="button" class="svelte-h4qokl">pick intervals</button> <details><summary>about <code>intervals</code></summary> <p><code>intervals</code> is a comma-separated list of numbers representing the <a href="https://wikipedia.org/wiki/Interval_(music)">musical intervals</a> used in the
					level, aka the number of piano keys (<a href="https://wikipedia.org/wiki/Semitone">semitones</a>) separating each note from the <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> (see below)</p> <p>for example, to practice distinguishing between the <a href="https://wikipedia.org/wiki/Perfect_fourth">perfect fourth</a> and <a href="https://wikipedia.org/wiki/Perfect_fifth">perfect fifth</a>, enter "<code>5, 7</code>"</p> <p>negative numbers are allowed</p></details></fieldset> <fieldset><label title="the number of trials per level"><div class="title">trial count</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset><label title="the number of notes per trial"><div class="title">sequence length</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset class="row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="number"> <input type="range"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="number"> <input type="range"></label></fieldset> <!> <fieldset><label class="mb_0" title="the possible starting notes for each trial"><div class="title">tonics</div> <input placeholder="all"></label> <button type="button" class="svelte-h4qokl">pick tonics</button> <details><summary>about <code>tonics</code></summary> <p>The <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> is like the "base" or "home"
					note, and for our purposes it's always the first note played in a trial. Other notes in the
					trial are calculated from the tonic and intervals. (see above)</p></details></fieldset> <button type="button" class="accent svelte-h4qokl"><!></button> <!> <button type="button" class="svelte-h4qokl"><!></button> <!> <!> <!></div></form> <!> <!> <!>`,1);function vl(l,e){re(e,!0);const a=Q(e,"editing",3,!1),r=Lt();let c=E(!1),i=E(N(e.level_data.name));const m=d(()=>{var x;return(x=t(i))==null?void 0:x.trim()});let f=E(e.level_data.intervals),g=E(e.level_data.tonics);const q=d(()=>t(g)?t(g).filter(x=>x>=t(v)&&x<=t(k)):t(g));let b=E(N(e.level_data.trial_count)),p=E(N(e.level_data.sequence_length)),v=E(N(e.level_data.min_note)),k=E(N(e.level_data.max_note));const w=()=>Ze.parse({id:e.level_data.id,name:t(m),intervals:t(f),tonics:t(q),trial_count:t(b),sequence_length:t(p),min_note:t(v),max_note:t(k)});Me(()=>{u(i,N(e.level_data.name)),u(f,e.level_data.intervals),u(g,e.level_data.tonics),u(b,N(e.level_data.trial_count)),u(p,N(e.level_data.sequence_length)),u(v,N(e.level_data.min_note)),u(k,N(e.level_data.max_note))});const S=d(()=>t(m)!==e.level_data.name||t(b)!==e.level_data.trial_count||t(p)!==e.level_data.sequence_length||t(v)!==e.level_data.min_note||t(k)!==e.level_data.max_note||!Ie(t(f),e.level_data.intervals)||!Ie(t(q),e.level_data.tonics));let O=E(!1),U=E(!1),te=E(!1),se=E(""),W=E("");const _e=d(()=>t(se)!==t(W));let oe=E("");Me(()=>{e.level_data,u(oe,"")});let le=E(void 0),ae=E(void 0),R=E(void 0),L=E(void 0);const B=d(()=>t(g)&&new Set(t(g)));let Y=E(N(qt)),K=E(1),X=E(void 0);const T=d(()=>t(v)>=t(k));var A=dl(),$=be(A),I=s($),z=s(I),F=s(z);y(F,a,x=>{var V=D("editing level");_(x,V)},x=>{var V=D("create a new level");_(x,V)}),o(z),o(I);var M=n(I,2),C=s(M),G=s(C),j=n(s(G),2);ke(j),o(G),o(C);var P=n(C,2),Z=s(P),fe=n(s(Z),2);qe(fe,x=>u(R,x),()=>t(R)),ke(fe),J(()=>Ke(fe,it(t(f)))),fe.__change=[Ba,f],o(Z);var we=n(Z,2);we.__click=[Ha,U],Le(2),o(P);var Se=n(P,2),Je=s(Se),ze=n(s(Je),2),je=s(ze);ke(je),H(je,"min",1);var Te=n(je,2);ke(Te),H(Te,"min",1),H(Te,"max",20),o(ze),o(Je),o(Se);var et=n(Se,2),dt=s(et),vt=n(s(dt),2),Be=s(vt);ke(Be),H(Be,"min",2);var He=n(Be,2);ke(He),H(He,"min",2),H(He,"max",16),o(vt),o(dt),o(et);var tt=n(et,2),at=s(tt),lt=n(s(at),2),Ht=s(lt);o(lt);var Ae=n(lt,2);ke(Ae),H(Ae,"step",1),H(Ae,"min",Ye),H(Ae,"max",Ge);var Oe=n(Ae,2);ke(Oe),H(Oe,"step",1),H(Oe,"min",Ye),H(Oe,"max",Ge),o(at);var ut=n(at,2),nt=n(s(ut),2),Ut=s(nt);o(nt);var Pe=n(nt,2);ke(Pe),H(Pe,"step",1),H(Pe,"min",Ye),H(Pe,"max",Ge);var Ve=n(Pe,2);ke(Ve),H(Ve,"step",1),H(Ve,"min",Ye),H(Ve,"max",Ge),o(ut),o(tt);var mt=n(tt,2);y(mt,()=>t(T),x=>{Xe(x,{status:"error",children:(V,ne)=>{Le();var ee=D("the lowest note must be lower than the highest");_(V,ee)},$$slots:{default:!0}})},x=>{var V=Ua(),ne=be(V),ee=d(()=>t(X)??0);Bt(ne,{get width(){return t(ee)},max_height:50,get min_note(){return t(v)},get max_note(){return t(k)},get highlighted_keys(){return t(B)},clickable:!1,middle_c_label:!0}),Le(2),_(x,V)});var Ue=n(mt,2),rt=s(Ue),We=n(s(rt),2);qe(We,x=>u(L,x),()=>t(L)),ke(We),J(()=>Ke(We,st(t(g)))),We.__change=[Wa,g],o(rt);var Wt=n(rt,2);Wt.__click=[Ya,te],Le(2),o(Ue);var Ce=n(Ue,2);Ce.__click=[Ga,e,w];var Yt=s(Ce);y(Yt,a,x=>{var V=D("save changes to level");_(x,V)},x=>{var V=D("create level");_(x,V)}),o(Ce);var gt=n(Ce,2);y(gt,()=>e.onremove&&a(),x=>{var V=el(),ne=be(V);ne.__click=[Ka,c];var ee=n(ne,2);y(ee,()=>t(c),de=>{var ve=Za(),ue=s(ve);ue.__click=[Xa,c,e],o(ve),pe(3,ve,()=>ye),_(de,ve)});var ce=n(ee,2);y(ce,()=>e.onduplicate,de=>{var ve=$a();ve.__click=[Qa,e],_(de,ve)}),_(x,V)});var Ne=n(gt,2);qe(Ne,x=>u(ae,x),()=>t(ae)),Ne.__click=[Ja,se,W,w,O];var Gt=s(Ne);y(Gt,a,x=>{var V=D("import/export data");_(x,V)},x=>{var V=D("import data");_(x,V)}),o(Ne);var bt=n(Ne,2);y(bt,()=>t(oe),x=>{var V=al(),ne=s(V);Xe(ne,{status:"error",children:(ee,ce)=>{var de=tl(),ve=s(de);o(de),J(()=>me(ve,t(oe))),_(ee,de)},$$slots:{default:!0}}),o(V),_(x,V)});var ft=n(bt,2);y(ft,()=>e.onplay&&a(),x=>{var V=nl();V.__click=[ll,e,S,w],_(x,V)});var Kt=n(ft,2);y(Kt,()=>e.onclose&&a(),x=>{var V=il();V.__click=[rl,e];var ne=s(V);y(ne,()=>t(S),ee=>{var ce=D("discard changes and stop editing");_(ee,ce)},ee=>{var ce=D("close level editor");_(ee,ce)}),o(V),_(x,V)}),o(M),o($);var ht=n($,2);y(ht,()=>t(O),x=>{Re(x,{onclose:()=>{var V;u(O,!1),(V=t(ae))==null||V.focus()},children:(V,ne)=>{var ee=ol(),ce=n(s(ee),2);ct(ce,{get text(){return t(W)},oncopy:()=>{var ue;(ue=t(le))==null||ue.select()}});var de=n(ce,2);qe(de,ue=>u(le,ue),()=>t(le)),Fe(de);var ve=n(de,2);ve.__click=[Fa,oe,W,e,O],o(ee),J(()=>{ve.disabled=!t(_e),H(ve,"title",t(_e)?void 0:"data has not changed")}),he(de,()=>t(W),ue=>u(W,ue)),_(V,ee)},$$slots:{default:!0}})});var pt=n(ht,2);y(pt,()=>t(U),x=>{Re(x,{onclose:()=>{var ne;u(U,!1),(ne=t(R))==null||ne.focus()},children:(ne,ee=xt)=>{var ce=sl(),de=n(s(ce),2);Ta(de,{get intervals(){return t(f)},get scale(){return t(Y)},set scale(ue){u(Y,N(ue))},get octaves(){return t(K)},set octaves(ue){u(K,N(ue))},oninput:ue=>{u(f,ue),ee()()}});var ve=n(de,2);ve.__click=function(...ue){var Ee;(Ee=ee())==null||Ee.apply(this,ue)},o(ce),_(ne,ce)}})});var Xt=n(pt,2);y(Xt,()=>t(te),x=>{Re(x,{onclose:()=>{var ne;u(te,!1),(ne=t(L))==null||ne.focus()},children:(ne,ee=xt)=>{var ce=cl(),de=n(s(ce),2),ve=d(()=>new Set(t(g)));Ca(de,{audio_state:r,get notes(){return t(ve)},get min_note(){return t(v)},get max_note(){return t(k)},oninput:Ee=>{u(g,Ee),ee()()},before_buttons:Ee=>{var yt=_l();yt.__click=function(...Zt){var kt;(kt=ee())==null||kt.apply(this,Zt)},_(Ee,yt)}}),o(ce),_(ne,ce)}})}),J(()=>{me(Ht,wt[t(v)]),me(Ut,wt[t(k)]),Ce.disabled=a()&&!t(S)||t(T)}),he(j,()=>t(i),x=>u(i,x)),he(je,()=>t(b),x=>u(b,x)),he(Te,()=>t(b),x=>u(b,x)),he(Be,()=>t(p),x=>u(p,x)),he(He,()=>t(p),x=>u(p,x)),he(Ae,()=>t(v),x=>u(v,x)),he(Oe,()=>t(v),x=>u(v,x)),he(Pe,()=>t(k),x=>u(k,x)),he(Ve,()=>t(k),x=>u(k,x)),pa(Ue,"clientWidth",x=>u(X,x)),_(l,A),ie()}xe(["change","click"]);var ul=(l,e,a)=>e()(a.project.id),ml=h('<button type="button" class="flex_1"> </button>'),gl=(l,e,a,r,c)=>{var i,m;return t(e)?(i=a())==null?void 0:i(r.project.id):(m=c())==null?void 0:m(r.project_data??r.load(r.project.id))},bl=h('<button type="button" class="icon_button plain_button size_xl deselectable svelte-12y7az0"><!></button>'),fl=(l,e)=>u(e,!t(e)),hl=h('<button type="button" class="icon_button plain_button size_xl svelte-12y7az0"><!></button>'),pl=h('<li class="project_item svelte-12y7az0"><!> <!> <!></li>');function yl(l,e){re(e,!0);const a=Q(e,"select",3,null),r=Q(e,"edit",3,null),c=Q(e,"remove",3,null);let i=E(!1);var m=pl(),f=s(m);y(f,a,p=>{var v=ml();v.__click=[ul,a,e];var k=s(v);o(v),J(()=>{ge(v,"selected",e.selected),me(k,e.project.name)}),_(p,v)});var g=n(f);g.nodeValue="  ";var q=n(g);y(q,()=>t(i)&&c()||!t(i)&&r(),p=>{var v=bl();v.__click=[gl,i,c,e,r];var k=s(v);y(k,()=>t(i),w=>{var S=D("✕");_(w,S)},w=>{var S=D("✎");_(w,S)}),o(v),J(()=>{H(v,"title",t(i)?"remove project":"edit project"),ge(v,"selected",e.selected&&!t(i)&&e.editing),ge(v,"color_c",t(i))}),_(p,v)});var b=n(q,2);y(b,c,p=>{var v=hl();v.__click=[fl,i];var k=s(v);y(k,()=>t(i),w=>{var S=D("×");_(w,S)},w=>{var S=D("✕");_(w,S)}),o(v),J(()=>H(v,"title",t(i)?"cancel removing":"remove project")),_(p,v)}),o(m),J(()=>ge(m,"selected",e.selected)),pe(3,m,()=>ye),_(l,m),ie()}xe(["click"]);var kl=h('<menu class="unstyled width_sm mb_0"></menu>');function xl(l,e){re(e,!0);const a=Q(e,"selected_project_id",3,null),r=Q(e,"editing_project_id",3,null),c=Q(e,"projects",19,()=>[]),i=Q(e,"project_datas",19,()=>[]);var m=kl();De(m,21,c,f=>f.id,(f,g)=>{var q=d(()=>i().find(v=>v.id===t(g).id)),b=d(()=>t(g).id===a()),p=d(()=>t(g).id===r());yl(f,{get project(){return t(g)},get project_data(){return t(q)},get load(){return e.load_project},get select(){return e.select_project},get edit(){return e.edit_project},get remove(){return e.remove_project},get selected(){return t(b)},get editing(){return t(p)}})}),o(m),_(l,m),ie()}var wl=(l,e,a,r)=>{t(e)?a().editing_project=!1:t(r)(Qe.parse({}))},jl=h('<div class="panel p_md"><header><h2 class="my_0">projects</h2></header> <!> <button type="button" class="w_100 mt_md deselectable">create a new project</button></div>');function zl(l,e){re(e,!0);const a=Q(e,"app",7),r=d(()=>a().load_project),c=d(()=>a().select_project),i=d(()=>a().edit_project),m=d(()=>a().remove_project),f=d(()=>a().editing_project&&a().selected_project_id!==a().editing_project_id),g=d(()=>a().app_data),q=d(()=>t(g).projects);var b=jl(),p=n(s(b),2),v=d(()=>a().editing_project?a().editing_project_id:null);xl(p,{get selected_project_id(){return a().selected_project_id},get editing_project_id(){return t(v)},get projects(){return t(q)},get project_datas(){return a().project_datas},get load_project(){return t(r)},get select_project(){return t(c)},edit_project:w=>t(i)(w===a().editing_project_data&&a().editing_project?null:w),get remove_project(){return t(m)}});var k=n(p,2);k.__click=[wl,f,a,i],o(b),J(()=>ge(k,"selected",t(f))),_(l,b),ie()}xe(["click"]);var ql=(l,e)=>e.toggle(),Il=h(`<aside>devices with smaller screens aren't well supported yet, see <a href="https://github.com/ryanatkn/earbetter/issues/2">issue #2</a></aside> <table><tbody><tr><td class="svelte-1gwge1y"><code>Spacebar</code></td><td class="svelte-1gwge1y">replay trial</td></tr><tr><td class="svelte-1gwge1y"><code>r</code></td><td class="svelte-1gwge1y">restart level</td></tr><tr><td class="svelte-1gwge1y"><code>Escape</code></td><td class="svelte-1gwge1y"><button type="button" class="inline">toggle main menu</button></td></tr><tr><td class="svelte-1gwge1y"><code>1 to 4</code></td><td class="svelte-1gwge1y">set instrument</td></tr><tr><td class="svelte-1gwge1y"><code>c</code></td><td class="svelte-1gwge1y">connect MIDI</td></tr><tr><td class="svelte-1gwge1y"><code>up/down arrows</code></td><td class="svelte-1gwge1y">adjust volume</td></tr></tbody></table>`,1);function Sl(l,e){re(e,!0);const a=na();var r=Il(),c=n(be(r),2),i=s(c),m=n(s(i),2),f=n(s(m)),g=s(f);g.__click=[ql,a],Rt(g,"min-width","172px"),o(f),o(m),Le(3),o(i),o(c),_(l,r),ie()}xe(["click"]);var Tl=h('<div class="realm_stats_summary svelte-1mwdoug" title="you performed flawlessly in every level of this realm!">★</div>');function Al(l,e){re(e,!0);const a=d(()=>e.realm_data.levels.map(b=>e.level_stats.mistakes[b.id]??[])),r=d(()=>t(a).reduce((b,p)=>b+p.length,0)),c=d(()=>Mt*t(a).length),i=d(()=>!!t(r)&&t(r)>=t(c)),m=d(()=>t(i)?t(a).reduce((b,p)=>b+p.reduce((v,k)=>v+k,0),0):void 0),f=d(()=>t(m)===0);var g=_t(),q=be(g);y(q,()=>t(f),b=>{var p=Tl();_(b,p)}),_(l,g),ie()}var Pl=(l,e,a)=>e()(a.realm_data.id),El=h('<button type="button" class="realm_button svelte-1joa4ch"> </button>'),Ll=(l,e,a,r,c)=>{var i,m;return t(e)?(i=a())==null?void 0:i(r.realm_data.id):(m=c())==null?void 0:m(r.realm_data)},Ml=h('<button type="button" class="icon_button plain_button size_xl deselectable svelte-1joa4ch"><!></button>'),Dl=(l,e)=>u(e,!t(e)),Ol=h('<button type="button" class="icon_button plain_button size_xl svelte-1joa4ch"><!></button>'),Vl=h('<li class="realm_item svelte-1joa4ch"><!> <!> <!> <!></li>');function Cl(l,e){re(e,!0);const a=Q(e,"select",3,null),r=Q(e,"edit",3,null),c=Q(e,"remove",3,null);let i=E(!1);const m=d(()=>e.project_data.level_stats);var f=Vl(),g=s(f);y(g,()=>t(m),k=>{Al(k,{get realm_data(){return e.realm_data},get level_stats(){return t(m)}})});var q=n(g,2);y(q,a,k=>{var w=El();w.__click=[Pl,a,e];var S=s(w);o(w),J(()=>{ge(w,"selected",e.selected),me(S,e.realm_data.name)}),_(k,w)});var b=n(q);b.nodeValue="  ";var p=n(b);y(p,()=>t(i)&&c()||!t(i)&&r(),k=>{var w=Ml();w.__click=[Ll,i,c,e,r];var S=s(w);y(S,()=>t(i),O=>{var U=D("✕");_(O,U)},O=>{var U=D("✎");_(O,U)}),o(w),J(()=>{H(w,"title",t(i)?"remove realm":e.editing?"stop editing realm":"edit realm"),ge(w,"selected",e.selected&&!t(i)&&e.editing),ge(w,"color_c",t(i))}),_(k,w)});var v=n(p,2);y(v,c,k=>{var w=Ol();w.__click=[Dl,i];var S=s(w);y(S,()=>t(i),O=>{var U=D("×");_(O,U)},O=>{var U=D("✕");_(O,U)}),o(w),J(()=>H(w,"title",t(i)?"cancel removing":"remove realm")),_(k,w)}),o(f),J(()=>ge(f,"selected",e.selected)),pe(3,f,()=>ye),_(l,f),ie()}xe(["click"]);var Nl=h('<menu class="unstyled width_sm mb_0"></menu>');function Rl(l,e){re(e,!0);const a=Q(e,"selected_realm_data",3,null),r=Q(e,"editing_realm_id",3,null),c=Q(e,"realms",19,()=>[]),i=d(()=>new Map(c().map(g=>[g.id,g]))),m=g=>t(i).get(g);var f=Nl();De(f,21,c,g=>g.id,(g,q)=>{var b=d(()=>m(t(q).id)),p=d(()=>{var k;return t(q).id===((k=a())==null?void 0:k.id)}),v=d(()=>t(q).id===r());Cl(g,{get realm_data(){return t(b)},get project_data(){return e.project_data},get select(){return e.select_realm},get edit(){return e.edit_realm},get remove(){return e.remove_realm},get selected(){return t(p)},get editing(){return t(v)}})}),o(f),_(l,f),ie()}const Fl=(l,e,a,r,c)=>{var i;t(e)?(i=document.querySelector(".realm_def_form input"))==null||i.focus():t(a)?r().editing_realm=!1:t(c)($e.parse({}))};var Jl=h("<div><!></div>"),Bl=h('<div class="panel p_md"><header><h2 class="my_0">realms</h2></header> <!> <button type="button">create a new realm</button></div>');function Hl(l,e){re(e,!0);const a=Q(e,"app",7),r=d(()=>a().select_realm),c=d(()=>a().edit_realm),i=d(()=>a().remove_realm),m=d(()=>{var p;return a().editing_realm&&!!a().editing_realm_data&&((p=a().selected_realm_data)==null?void 0:p.id)!==a().editing_realm_data.id}),f=d(()=>{var p;return!((p=a().realms)!=null&&p.length)});var g=Bl(),q=n(s(g),2);y(q,()=>a().realms&&a().selected_project_data,p=>{var v=Jl(),k=s(v),w=d(()=>a().editing_realm?a().editing_realm_id:null);Rl(k,{get project_data(){return a().selected_project_data},get selected_realm_data(){return a().selected_realm_data},get realms(){return a().realms},get editing_realm_id(){return t(w)},get select_realm(){return t(r)},edit_realm:S=>t(c)(S===a().editing_realm_data&&a().editing_realm?null:S),get remove_realm(){return t(i)}}),o(v),pe(3,v,()=>ye),_(p,v)});var b=n(q,2);b.__click=[Fl,f,m,a,c],o(g),J(()=>{ha(b,`${(t(f)?void 0:"deselectable")??""} svelte-100yq62`),ge(b,"selected",t(m)||t(f))}),_(l,g),ie()}xe(["click"]);const Ul=(l,e,a,r,c)=>{u(e,"");try{const i=JSON.parse(t(a));i&&!i.id&&(i.id=va());const m=$e.parse(i);r.onsubmit(m)}catch(i){console.error("failed to import data",i),u(e,N(i.message||"unknown error"))}u(c,!1)},Wl=(l,e,a,r,c)=>{u(e,N(u(a,N(JSON.stringify(r()))))),u(c,!0)};var Yl=h('<div class="importing bg shadow_d_xl p_xl width_md box svelte-1g446ss"><h2 class="my_0">import realm data</h2> <!> <textarea class="svelte-1g446ss"></textarea> <button type="button" class="svelte-1g446ss">import realm data</button></div>'),Gl=(l,e,a)=>{l.key==="Enter"&&(Ot(l),e.onsubmit(a()))},Kl=(l,e,a)=>e.onsubmit(a()),Xl=(l,e)=>u(e,!t(e)),Zl=(l,e,a)=>{u(e,!1),a.onremove(a.realm_data.id)},Ql=h('<div class="pb_md"><button type="button" class="color_c w_100 svelte-1g446ss">✕ confirm remove</button></div>'),$l=(l,e)=>e.onduplicate(e.realm_data.id),en=h('<button type="button" class="svelte-1g446ss">duplicate realm</button>'),tn=h('<button type="button" class="svelte-1g446ss">remove realm</button> <!> <!>',1),an=(l,e)=>u(e,!t(e)),ln=(l,e,a)=>{u(e,!1),a.onsubmit(Dt().realms)},nn=h('<div><button type="button" class="w_100 svelte-1g446ss"> </button></div>'),rn=h('<button type="button" class="svelte-1g446ss">create default realms</button> <!>',1),on=h("<pre> </pre>"),sn=h('<div class="message-wrapper svelte-1g446ss"><!></div>'),_n=(l,e)=>e.onclose(e.realm_data.id),cn=h('<button class="w_100 svelte-1g446ss" type="button"><!></button>'),dn=h('<!> <form class="realm_def_form"><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent svelte-1g446ss"><!></button> <!> <button type="button" class="svelte-1g446ss"><!></button> <!> <!> <!></form>',1);function vn(l,e){re(e,!0);const a=Q(e,"editing",3,!1);let r=E(!1),c=E(N(e.realm_data.name));const i=d(()=>{var I;return(I=t(c))==null?void 0:I.trim()}),m=()=>$e.parse({id:e.realm_data.id,name:t(i),levels:e.realm_data.levels});Me(()=>{console.log("set_realm_data",e.realm_data),u(c,N(e.realm_data.name))});const f=d(()=>t(i)!==e.realm_data.name);let g=E(!1),q=E(""),b=E("");const p=d(()=>t(q)!==t(b));let v=E("");Me(()=>{e.realm_data,u(v,"")});let k=E(void 0),w=E(void 0);const S=Dt().realms;let O=E(!1);var U=dn(),te=be(U);y(te,()=>t(g),I=>{Re(I,{onclose:()=>{var z;u(g,!1),(z=t(w))==null||z.focus()},children:(z,F)=>{var M=Yl(),C=n(s(M),2);ct(C,{get text(){return t(b)},oncopy:()=>{var P;(P=t(k))==null||P.select()}});var G=n(C,2);qe(G,P=>u(k,P),()=>t(k)),Fe(G);var j=n(G,2);j.__click=[Ul,v,b,e,g],o(M),J(()=>{j.disabled=!t(p),H(j,"title",t(p)?void 0:"data has not changed")}),he(G,()=>t(b),P=>u(b,P)),_(z,M)},$$slots:{default:!0}})});var se=n(te,2),W=s(se),_e=s(W),oe=s(_e);y(oe,a,I=>{var z=D("editing realm");_(I,z)},I=>{var z=D("create a new realm");_(I,z)}),o(_e),o(W);var le=n(W,2),ae=s(le),R=n(s(ae),2);ke(R),R.__keydown=[Gl,e,m],o(ae),o(le);var L=n(le,2);L.__click=[Kl,e,m];var B=s(L);y(B,a,I=>{var z=D("save changes to realm");_(I,z)},I=>{var z=D("create realm");_(I,z)}),o(L);var Y=n(L,2);y(Y,()=>e.onremove&&a(),I=>{var z=tn(),F=be(z);F.__click=[Xl,r];var M=n(F,2);y(M,()=>t(r),G=>{var j=Ql(),P=s(j);P.__click=[Zl,r,e],o(j),pe(3,j,()=>ye),_(G,j)});var C=n(M,2);y(C,()=>e.onduplicate,G=>{var j=en();j.__click=[$l,e],_(G,j)}),_(I,z)});var K=n(Y,2);qe(K,I=>u(w,I),()=>t(w)),K.__click=[Wl,q,b,m,g];var X=s(K);y(X,a,I=>{var z=D("import/export data");_(I,z)},I=>{var z=D("import data");_(I,z)}),o(K);var T=n(K,2);y(T,()=>!a(),I=>{var z=rn(),F=be(z);F.__click=[an,O];var M=n(F,2);y(M,()=>t(O),C=>{var G=nn(),j=s(G);j.__click=[ln,O,e];var P=s(j);o(j),o(G),J(()=>me(P,`create ${S.length??""} new realms`)),pe(3,G,()=>ye),_(C,G)}),_(I,z)});var A=n(T,2);y(A,()=>t(v),I=>{var z=sn(),F=s(z);Xe(F,{status:"error",children:(M,C)=>{var G=on(),j=s(G);o(G),J(()=>me(j,t(v))),_(M,G)},$$slots:{default:!0}}),o(z),_(I,z)});var $=n(A,2);y($,()=>e.onclose&&a(),I=>{var z=cn();z.__click=[_n,e];var F=s(z);y(F,()=>t(f),M=>{var C=D("discard changes");_(M,C)},M=>{var C=D("close realm editor");_(M,C)}),o(z),_(I,z)}),o(se),J(()=>L.disabled=a()&&!t(f)),he(R,()=>t(c),I=>u(c,I)),_(l,U),ie()}xe(["click","keydown"]);var un=h('<div class="panel p_md"><!></div>');function mn(l,e){re(e,!0);const a=Q(e,"app",7),r=d(()=>a().remove_realm),c=d(()=>a().duplicate_realm),i=d(()=>a().update_realm),m=d(()=>a().create_realm),f=d(()=>a().editing_realm_data??$e.parse({})),g=d(()=>a().realms?a().realms.some(v=>v.id===t(f).id):!1),q=(v,k)=>{var w;(w=a().realms)!=null&&w.some(S=>S.id===v.id)?t(i)(v):t(m)(v,k)};var b=un(),p=s(b);vn(p,{get editing(){return t(g)},get realm_data(){return t(f)},onsubmit:v=>{if(Array.isArray(v))for(let k=0;k<v.length;(k+=1)-1)q(v[k],k===0);else q(v,!0)},onremove:v=>t(r)(v),onduplicate:v=>t(c)(v),onclose:()=>a().editing_realm=!1}),o(b),_(l,b),ie()}var gn=(l,e)=>e.app.play_level(e.level_data.id),bn=async(l,e,a,r)=>{if(t(e))a.app.remove_level(a.level_data.id);else{const c=!t(r);if(a.app.edit_level(c?a.level_data:null),c){await $t();const i=document.querySelector(".level_def_form");i==null||i.scrollIntoView({behavior:"smooth",block:"center"})}}},fn=(l,e)=>u(e,!t(e)),hn=h('<li class="level_map_item svelte-170pvnv"><!> <button type="button" class="level_button deselectable svelte-170pvnv" title="play this level"> </button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button></li>');function pn(l,e){re(e,!0);const a=d(()=>e.app.draft_level_data===e.level_data),r=d(()=>e.app.editing_level&&t(a)),c=d(()=>{var S;return(S=e.app.selected_project_data)==null?void 0:S.level_stats});let i=E(!1);const m=d(()=>t(r)||t(a));var f=hn(),g=s(f);y(g,()=>t(c),S=>{xa(S,{get level_data(){return e.level_data},get level_stats(){return t(c)}})});var q=n(g,2);q.__click=[gn,e];var b=s(q);o(q);var p=n(q,2);p.__click=[bn,i,e,r];var v=s(p);y(v,()=>t(i),S=>{var O=D("✕");_(S,O)},S=>{var O=D("✎");_(S,O)}),o(p);var k=n(p,2);k.__click=[fn,i];var w=s(k);y(w,()=>t(i),S=>{var O=D("×");_(S,O)},S=>{var O=D("✕");_(S,O)}),o(k),o(f),J(()=>{ge(f,"selected",t(m)),ge(q,"selected",t(m)),me(b,e.level_data.name),H(p,"title",t(i)?"remove level":t(r)?"stop editing level":"edit level"),ge(p,"selected",!t(i)&&t(r)),ge(p,"color_c",t(i)),H(k,"title",t(i)?"cancel removing":"remove level")}),pe(3,f,()=>ye),_(l,f),ie()}xe(["click"]);const yn=(l,e,a,r)=>{var c;t(e)?(c=document.querySelector(".level_def_form input"))==null||c.focus():a.app.edit_level(t(r)?null:Ze.parse({}))};var kn=h('<div class="panel p_md"><header><h2 class="my_0">levels</h2> <h3 class="my_0"> </h3></header> <menu class="levels unstyled mb_0 svelte-wmjxbn"></menu> <button type="button" class="svelte-wmjxbn">create a new level</button></div>');function xn(l,e){re(e,!0);const a=d(()=>e.app.editing_level&&!e.levels.some(b=>b===e.app.draft_level_data)),r=d(()=>!e.levels.length);var c=kn(),i=s(c),m=n(s(i),2),f=s(m);o(m),o(i);var g=n(i,2);De(g,21,()=>e.levels,b=>b.id,(b,p)=>{pn(b,{get app(){return e.app},get level_data(){return t(p)}})}),o(g);var q=n(g,2);q.__click=[yn,r,e,a],o(c),J(()=>{var b;me(f,(b=e.app.selected_realm_data)==null?void 0:b.name),ge(q,"selected",t(a)||t(r)),ge(q,"deselectable",!t(r))}),_(l,c),ie()}xe(["click"]);const wn=(l,e,a,r,c)=>{u(e,"");try{const i=JSON.parse(t(a));i&&!i.id&&(i.id=ua());const m=Qe.parse(i);r.onsubmit(m)}catch(i){console.error("failed to import data",i),u(e,N(i.message||"unknown error"))}u(c,!1)},jn=(l,e,a,r,c)=>{u(e,N(u(a,N(JSON.stringify(r()))))),u(c,!0)};var zn=h('<div class="importing bg shadow_d_xl p_xl width_md box svelte-l3tcx7"><h2 class="my_0">import project data</h2> <!> <textarea class="svelte-l3tcx7"></textarea> <button type="button" class="svelte-l3tcx7">import project data</button></div>'),qn=(l,e,a)=>{l.key==="Enter"&&(Ot(l),e.onsubmit(a()))},In=(l,e,a)=>e.onsubmit(a()),Sn=(l,e)=>u(e,!t(e)),Tn=(l,e,a)=>{u(e,!1),a.onremove(a.project_data.id)},An=h('<div class="pb_md"><button type="button" class="color_c w_100 svelte-l3tcx7">✕ confirm remove</button></div>'),Pn=(l,e)=>e.onduplicate(e.project_data.id),En=h('<button type="button" class="w_100 svelte-l3tcx7">duplicate project</button>'),Ln=h('<button class="w_100 svelte-l3tcx7" type="button">remove project</button> <!> <!>',1),Mn=h("<pre> </pre>"),Dn=h('<div class="overflow_x_auto"><!></div>'),On=(l,e)=>e.onclose(e.project_data.id),Vn=h('<button type="button" class="w_100 svelte-l3tcx7"><!></button>'),Cn=h('<!> <form><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent w_100 svelte-l3tcx7"><!></button> <!> <button type="button" class="w_100 svelte-l3tcx7"><!></button> <!> <!></form>',1);function Nn(l,e){re(e,!0);const a=Q(e,"editing",3,!1);let r=E(!1),c=E(N(e.project_data.name));const i=d(()=>t(c).trim()),m=()=>Qe.parse({id:e.project_data.id,name:t(i),realms:e.project_data.realms,level_stats:e.project_data.level_stats});Me(()=>{console.log("set_project_data",e.project_data),u(c,N(e.project_data.name))});const f=d(()=>t(i)!==e.project_data.name);let g=E(!1),q=E(""),b=E("");const p=d(()=>t(q)!==t(b));let v=E("");Me(()=>{e.project_data,u(v,"")});let k=E(void 0),w=E(void 0);var S=Cn(),O=be(S);y(O,()=>t(g),T=>{Re(T,{onclose:()=>{var A;u(g,!1),(A=t(w))==null||A.focus()},children:(A,$)=>{var I=zn(),z=n(s(I),2);ct(z,{get text(){return t(b)},oncopy:()=>{var C;(C=t(k))==null||C.select()}});var F=n(z,2);qe(F,C=>u(k,C),()=>t(k)),Fe(F);var M=n(F,2);M.__click=[wn,v,b,e,g],o(I),J(()=>{M.disabled=!t(p),H(M,"title",t(p)?void 0:"data has not changed")}),he(F,()=>t(b),C=>u(b,C)),_(A,I)},$$slots:{default:!0}})});var U=n(O,2),te=s(U),se=s(te),W=s(se);y(W,a,T=>{var A=D("editing project");_(T,A)},T=>{var A=D("create a new project");_(T,A)}),o(se),o(te);var _e=n(te,2),oe=s(_e),le=n(s(oe),2);ke(le),le.__keydown=[qn,e,m],o(oe),o(_e);var ae=n(_e,2);ae.__click=[In,e,m];var R=s(ae);y(R,a,T=>{var A=D("save changes to project");_(T,A)},T=>{var A=D("create project");_(T,A)}),o(ae);var L=n(ae,2);y(L,()=>e.onremove&&a(),T=>{var A=Ln(),$=be(A);$.__click=[Sn,r];var I=n($,2);y(I,()=>t(r),F=>{var M=An(),C=s(M);C.__click=[Tn,r,e],o(M),pe(3,M,()=>ye),_(F,M)});var z=n(I,2);y(z,()=>e.onduplicate,F=>{var M=En();M.__click=[Pn,e],_(F,M)}),_(T,A)});var B=n(L,2);qe(B,T=>u(w,T),()=>t(w)),B.__click=[jn,q,b,m,g];var Y=s(B);y(Y,a,T=>{var A=D("import/export data");_(T,A)},T=>{var A=D("import data");_(T,A)}),o(B);var K=n(B,2);y(K,()=>t(v),T=>{var A=Dn(),$=s(A);Xe($,{status:"error",children:(I,z)=>{var F=Mn(),M=s(F);o(F),J(()=>me(M,t(v))),_(I,F)},$$slots:{default:!0}}),o(A),_(T,A)});var X=n(K,2);y(X,()=>e.onclose&&a(),T=>{var A=Vn();A.__click=[On,e];var $=s(A);y($,()=>t(f),I=>{var z=D("discard changes and stop editing");_(I,z)},I=>{var z=D("close project editor");_(I,z)}),o(A),_(T,A)}),o(U),J(()=>ae.disabled=a()&&!t(f)),he(le,()=>t(c),T=>u(c,T)),_(l,S),ie()}xe(["click","keydown"]);var Rn=h('<div class="panel p_md"><!></div>');function Fn(l,e){re(e,!0);const a=Q(e,"app",7),r=d(()=>a().remove_project),c=d(()=>a().duplicate_project),i=d(()=>a().update_project),m=d(()=>a().create_project),f=d(()=>a().editing_project_data??Qe.parse({})),g=d(()=>a().project_datas.some(v=>v.id===t(f).id));var q=Rn(),b=s(q),p=d(()=>t(g)?t(i):t(m));Nn(b,{get editing(){return t(g)},get project_data(){return t(f)},get onsubmit(){return t(p)},get onremove(){return t(r)},get onduplicate(){return t(c)},onclose:()=>a().editing_project=!1}),o(q),_(l,q),ie()}var Jn=h('<section class="card svelte-8muejm"><!></section>'),Bn=h('<section class="card svelte-8muejm"><!></section>'),Hn=h('<div class="width_sm svelte-8muejm"><!> <!> <section class="card svelte-8muejm"><div class="panel p_md"><header><h2 class="my_0">controls</h2></header> <!> <div class="mb_lg"><!></div> <!> <aside>Earbetter supports MIDI devices like piano keyboards, connect and click:</aside> <!></div></section></div>'),Un=(l,e)=>t(e)(),Wn=h(`<section class="card svelte-8muejm"><div class="panel p_md"><p>Earbetter is an <a href="https://wikipedia.org/wiki/Ear_training">ear training</a> tool:</p> <ul><li>each level is a standalone challenge that's a series of trials</li> <li></li> <li>realms group levels into bigger challenges</li> <li>projects group realms so you can customize various experiences</li> <li>levels can be shared via their links or exporting/importing data</li></ul> <p>See also the 3 minute <a href="https://www.youtube.com/watch?v=zW2zI1A_Ikw">video intro on YouTube</a> and <a href="https://github.com/ryanatkn/earbetter">the readme</a>.</p> <aside>Earbetter is in early development, and many things are unfinished and unknown - feedback
						is appreciated on <a href="https://github.com/ryanatkn/earbetter">the GitHub discussions and issues</a>.</aside> <div class="box row"><button type="button" class="m_0">ok, hide this</button></div></div></section>`),Yn=h('<section class="card svelte-8muejm"><!></section>'),Gn=h('<section class="card svelte-8muejm"><!></section>'),Kn=h('<section class="card svelte-8muejm"><div class="panel p_md"><!></div></section>'),Xn=h('<div class="width_sm svelte-8muejm"><!> <!></div>'),Zn=h('<!> <div class="map svelte-8muejm"><!> <div class="width_sm svelte-8muejm"><!> <section class="card svelte-8muejm"><!></section> <!></div> <!></div>',1);function Qn(l,e){re(e,!0);const a=Q(e,"app",7),r=d(()=>a().toggle_trainer_help),c=d(()=>a().play_level),i=d(()=>a().edit_level),m=d(()=>a().remove_level),f=d(()=>a().duplicate_level),g=d(()=>a().create_level),q=d(()=>a().update_level),b=Tt();window.ac=b;const p=d(()=>a().draft_level_data??Ze.parse({})),v=d(()=>a().levels?a().levels.some(R=>R.id===t(p).id):!1),k=d(()=>{var R;return!((R=a().realms)!=null&&R.length)});var w=Zn(),S=be(w);Jt(S,{get midi_access(){return a().midi_access},onnotestart:(R,L)=>{Pt(a(),b(),R,Et(a().volume,L),a().instrument)},onnotestop:R=>{ot(R)}});var O=n(S,2),U=s(O);y(U,()=>a().project_datas.length,R=>{var L=Hn(),B=s(L);y(B,()=>a().selected_project_data,M=>{var C=Jn(),G=s(C);zl(G,{get app(){return a()}}),o(C),pe(3,C,()=>ye),_(M,C)});var Y=n(B);Y.nodeValue="  ";var K=n(Y);y(K,()=>a().editing_project&&a().editing_project_data||!a().selected_project_data,M=>{var C=Bn(),G=s(C);Fn(G,{get app(){return a()}}),o(C),pe(3,C,()=>ye),_(M,C)});var X=n(K,2),T=s(X),A=n(s(T),2);Sl(A,{});var $=n(A,2),I=s($);Ct(I,{get volume(){return a().volume},set volume(M){a().volume=M}}),o($);var z=n($,2);Vt(z,{get instrument(){return a().instrument},set instrument(M){a().instrument=M}});var F=n(z,4);Nt(F,{get midi_state(){return a()}}),o(T),o(X),o(L),pe(3,X,()=>ye),_(R,L)});var te=n(U,2),se=s(te);y(se,()=>a().show_trainer_help,R=>{var L=Wn(),B=s(L),Y=n(s(B),2),K=n(s(Y),2);K.textContent=`your level score is the sum of mistakes in your best ${Mt}
							runs, win a ★ at 0`,Le(6),o(Y);var X=n(Y,6),T=s(X);T.__click=[Un,r],o(X),o(B),o(L),pe(3,L,()=>ye),_(R,L)});var W=n(se,2),_e=s(W);Hl(_e,{get app(){return a()}}),o(W);var oe=n(W);oe.nodeValue="  ";var le=n(oe);y(le,()=>a().editing_realm&&a().editing_realm_data||t(k),R=>{var L=Yn(),B=s(L);mn(B,{get app(){return a()}}),o(L),pe(3,L,()=>ye),_(R,L)}),o(te);var ae=n(te,2);y(ae,()=>a().project_datas.length,R=>{var L=Xn(),B=s(L);y(B,()=>a().levels,X=>{var T=Gn(),A=s(T);xn(A,{get app(){return a()},get levels(){return a().levels}}),o(T),pe(3,T,()=>ye),_(X,T)});var Y=n(B);Y.nodeValue="  ";var K=n(Y);y(K,()=>{var X;return a().selected_realm_id&&(a().editing_level&&a().levels||((X=a().levels)==null?void 0:X.length)===0)},X=>{var T=Kn(),A=s(T),$=s(A),I=d(()=>t(v)?t(q):t(g));vl($,{get editing(){return t(v)},get level_data(){return t(p)},get onsubmit(){return t(I)},get onremove(){return t(m)},get onduplicate(){return t(f)},onplay:async(z,F)=>{F&&t(q)(z),await t(c)(z.id)},onclose:()=>t(i)(null)}),o(A),o(T),pe(2,T,()=>ye),_(X,T)}),o(L),_(R,L)}),o(O),_(l,w),ie()}xe(["click"]);var $n=h('<main><!> <!> <!> <div class="box"><!></div></main>');function gr(l,e){re(e,!0);const a=Lt();var r=$n();Qt(q=>{ea.title="Earbetter trainer"});var c=s(r);ya(c,{onclick:()=>ta(aa+"/")});var i=n(c,2);la(i);var m=n(i,2);Qn(m,{app:a});var f=n(m,2),g=s(f);ra(g,{}),o(f),o(r),_(l,r),ie()}export{gr as component};
