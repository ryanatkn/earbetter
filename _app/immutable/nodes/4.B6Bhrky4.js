import{v as je,f as be,c as l,r as n,s as t,b as me,a as s,t as d,d as gt,e as fa,n as Ae,w as ha,x as pa}from"../chunks/disclose-version.wE5PaFVB.js";import{p as le,h as L,t as H,g as a,a as oe,s as m,d as u,D as Ee,n as Dt,R as ya}from"../chunks/index-client.DEO7R3f7.js";import{g as ka,b as wa}from"../chunks/entry.DGu9Vwvo.js";import{H as ja}from"../chunks/Header.p639Njgm.js";import{g as xa,F as za}from"../chunks/Footer.B-V2nbOj.js";import{K as Vt,U as vt,d as Rt,l as qa,W as Nt,X as Ia,L as Sa,j as Ct,k as ut,p as Aa,Y as mt,Z as Ft,n as Bt,w as Ht,_ as Pa,g as Jt,a as Ke,b as Xe,t as pe,m as Et,$ as Ta,a0 as $e,c as ye,a1 as et,M as Ut,a2 as tt,a3 as Wt,a4 as La,s as Yt,a5 as Da}from"../chunks/index.D24duzjB.js";import{p as $,a as O,i as w}from"../chunks/props.BV_xrcCh.js";import{l as Ea,i as Ma,s as Oa,b as he,I as Gt,V as Kt,c as Xt,a as Va}from"../chunks/Init_Midi_Button.CWdoHD4V.js";import{f as Fe,e as Me,r as we,s as Y,g as Ze,b as Zt,c as Qt,t as ge,h as Ra}from"../chunks/style.BI6wc9N8.js";import{M as $t,P as ea,b as Na,B as Ca}from"../chunks/Back_Button.-6gqwDZu.js";import{b as Ie}from"../chunks/this.CUByJSBG.js";import{D as Ce}from"../chunks/Dialog.ChJrDDxh.js";import{A as Qe}from"../chunks/Alert.BGsf62ub.js";import{p as Fa}from"../chunks/string.Dn_jmF-S.js";import{L as Ba}from"../chunks/Level_Stats_Summary.Cv21IY5Y.js";function Ha(o,e){Ea(window,["resize"],()=>e(window[o]))}var Mt=Object.prototype.hasOwnProperty;function Ot(o,e,r){for(r of o.keys())if(Pe(r,e))return r}function Pe(o,e){var r,i,c;if(o===e)return!0;if(o&&e&&(r=o.constructor)===e.constructor){if(r===Date)return o.getTime()===e.getTime();if(r===RegExp)return o.toString()===e.toString();if(r===Array){if((i=o.length)===e.length)for(;i--&&Pe(o[i],e[i]););return i===-1}if(r===Set){if(o.size!==e.size)return!1;for(i of o)if(c=i,c&&typeof c=="object"&&(c=Ot(e,c),!c)||!e.has(c))return!1;return!0}if(r===Map){if(o.size!==e.size)return!1;for(i of o)if(c=i[0],c&&typeof c=="object"&&(c=Ot(e,c),!c)||!Pe(i[1],e.get(c)))return!1;return!0}if(r===ArrayBuffer)o=new Uint8Array(o),e=new Uint8Array(e);else if(r===DataView){if((i=o.byteLength)===e.byteLength)for(;i--&&o.getInt8(i)===e.getInt8(i););return i===-1}if(ArrayBuffer.isView(o)){if((i=o.byteLength)===e.byteLength)for(;i--&&o[i]===e[i];);return i===-1}if(!r||typeof o=="object"){i=0;for(r in o)if(Mt.call(o,r)&&++i&&!Mt.call(e,r)||!(r in e)||!Pe(o[r],e[r]))return!1;return Object.keys(e).length===i}}return o!==o&&e!==e}var Ja=(o,e)=>m(e,O(o.currentTarget.value)),Ua=(o,e,r,i,c,_)=>{var g;return(g=e.oninput)==null?void 0:g.call(e,a(r),a(i)?{scale:c(),octaves:_()}:void 0)},Wa=(o,e)=>e(qa(o.currentTarget.value)),Ya=d("<option> </option>"),Ga=d('<small><textarea class="preview width_sm panel svelte-1n8fnqy"></textarea></small> <button type="button" class="accent mb_lg">use these intervals</button> <label><div class="title text_align_center">scale</div> <select></select></label> <label><div class="title text_align_center">octaves</div> <div class="text_align_center"> </div> <input type="range"></label>',1);function Ka(o,e){le(e,!0);let r=$(e,"scale",31,()=>O(Vt)),i=$(e,"octaves",15,1);const c=u(()=>Ia(r(),i())),_=u(()=>vt(a(c))),g=O(vt(e.intervals));let h=L(O(g));const b=u(()=>(a(c),Date.now())),z=u(()=>(e.intervals,a(h),Date.now())),y=u(()=>a(b)>a(z)),f=u(()=>a(y)?a(_):a(h)),v=u(()=>Nt(a(f))),p=u(()=>!Pe(e.intervals,a(v))),k=u(()=>!!a(v).length);var I=Ga(),T=be(I),J=l(T);Fe(J),J.__input=[Ja,h],n(T);var X=t(t(T,!0));X.__click=[Ua,e,v,y,r,i];var ne=t(t(X,!0)),Z=l(ne),te=t(t(Z,!0));Ma(te,()=>r().name);var se;te.__change=[Wa,r],Me(te,20,()=>Rt,(G,K)=>G,(G,K,W)=>{var F=Ya(),P={},A=l(F);n(F),H(()=>{P!==(P=K.name)&&(F.value=(F.__value=K.name)==null?"":K.name),me(A,K.name)}),s(G,F)}),n(te),n(ne);var ve=t(t(ne,!0)),ie=l(ve),N=t(t(ie,!0)),R=l(N);n(N);var U=t(t(N,!0));we(U),Y(U,"min",1),Y(U,"max",6),n(ve),H(()=>{Ze(J,a(f)),X.disabled=!a(p)||!a(k),se!==(se=r().name)&&(te.value=(te.__value=r().name)==null?"":r().name,Oa(te,r().name)),me(R,i())}),he(U,i,G=>i(G)),s(o,I),oe()}je(["input","click","change"]);var Xa=(o,e)=>{m(e,O(new Set))},Za=(o,e,r)=>{var i;(i=e.oninput)==null||i.call(e,a(r))},Qa=d("all",1),$a=d('<!> <button class="mb_lg" type="button">clear selection</button> <button type="button" class="accent">select <!> </button>',1),er=d("<option> </option>"),tr=(o,e,r)=>e(a(r)),ar=d('<button type="button"> </button>'),rr=(o,e)=>e(o.currentTarget.value),nr=d('<!> <div class="notes_input pt_lg svelte-18obm47"><!> <div class="piano_wrapper svelte-18obm47"><!></div> <section class="box"><label class="mb_lg"><div class="title text_align_center">key</div> <select></select></label> <div class="scales mb_lg svelte-18obm47"></div> <!> <div class="notes width_sm svelte-18obm47"><blockquote class="panel my_lg"><textarea></textarea></blockquote></div></section> <form class="width_sm panel p_md"><fieldset><!> <!></fieldset> <fieldset><!></fieldset></form></div>',1);function lr(o,e){le(e,!0);const r=j=>{var D=$a(),ee=be(D);w(ee,()=>e.before_buttons,ze=>{var xe=gt(),at=be(xe);Qt(at,()=>e.before_buttons),s(ze,xe)});var de=t(t(ee,!0));de.__click=[Xa,_];var ce=t(t(de,!0));ce.__click=[Za,e,g];var Se=t(l(ce));w(Se,()=>a(b)===0,ze=>{var xe=Qa();s(ze,xe)},ze=>{var xe=fa();H(()=>me(xe,a(b))),s(ze,xe)});var Be=t(Se,!0);H(()=>me(Be,` tonic${Fa(a(b))??""}`)),n(ce),H(()=>{de.disabled=a(b)===0,ce.disabled=!a(v)}),s(j,D)},i=$(e,"audio_state",7),{playing_notes:c}=i();let _=L(void 0);const g=u(()=>a(_)&&Array.from(a(_)).sort((j,D)=>j-D)),h=u(()=>a(_)??e.notes),b=u(()=>a(h).size),z=u(()=>a(g)&&mt(a(g))),y=j=>{m(_,O(new Set(Ft(j))))},f=u(()=>mt(Array.from(e.notes).sort((j,D)=>j-D))),v=u(()=>!!a(g)&&a(z)!==a(f)),p=j=>{const D=new Set(a(h));D.has(j)?D.delete(j):D.add(j),m(_,O(D))};let k=L(O(Sa));const I=Ct();let T=L(void 0);const J=20,X=(j,D=null)=>{Bt(i(),I(),j,Ht(i().volume,D),i().instrument)},ne=j=>{const D=Pa(j,a(k),e.min_note,e.max_note);if(!a(_)||!a(g)){m(_,O(D));return}let ee=!0;for(const ce of D)if(!a(_).has(ce)){ee=!1;break}const de=ee?a(g).filter(ce=>!D.has(ce)):a(g).concat(Array.from(D));m(_,O(new Set(de)))};var Z=nr(),te=be(Z);$t(te,{get midi_access(){return i().midi_access},onnotestart:(j,D)=>X(j,D),onnotestop:j=>ut(j)});var se=t(t(te,!0)),ve=l(se);r(ve);var ie=t(t(ve,!0));Zt(ie,"padding",`${J}px`);var N=l(ie);w(N,()=>a(T),j=>{var D=u(()=>a(T)-J*5);ea(j,{get width(){return a(D)},get min_note(){return e.min_note},get max_note(){return e.max_note},max_height:300,pressed_keys:c,get highlighted_keys(){return a(h)},middle_c_label:!0,allow_sticking:!0,onpress:ee=>{p(ee),X(ee)},onrelease:ee=>{ut(ee)}})}),n(ie);var R=t(t(ie,!0)),U=l(R),G=l(U),K=t(t(G,!0));Me(K,20,()=>Aa,(j,D)=>j,(j,D,ee)=>{var de=er(),ce={},Se=l(de);n(de),H(()=>{ce!==(ce=D)&&(de.value=(de.__value=D)==null?"":D),me(Se,D)}),s(j,de)}),n(K),n(U);var W=t(t(U,!0));Me(W,21,()=>Rt,(j,D)=>j.name,(j,D,ee)=>{var de=ar();de.__click=[tr,ne,D];var ce=l(de);n(de),H(()=>me(ce,a(D).name)),s(j,de)}),n(W);var F=t(t(W,!0));r(F);var P=t(t(F,!0)),A=l(P),Q=l(A);Fe(Q),Q.__change=[rr,y],n(A),n(P),n(R);var q=t(t(R,!0)),S=l(q),C=l(S);Gt(C,{get instrument(){return i().instrument},set instrument(j){i().instrument=j}});var E=t(t(C,!0));Kt(E,{get volume(){return i().volume},set volume(j){i().volume=j}}),n(S);var B=t(t(S,!0)),V=l(B);Xt(V,{get midi_state(){return i()}}),n(B),n(q),n(se),H(()=>Ze(Q,a(z))),Ha("innerWidth",j=>m(T,O(j))),Va(K,()=>a(k),j=>m(k,j)),s(o,Z),oe()}je(["click","change"]);var or=(o,e)=>{var r;navigator.clipboard.writeText(e.text),(r=e.oncopy)==null||r.call(e)},ir=d("copy to clipboard",1),_r=d('<button type="button" class="my_lg"><!></button>');function bt(o,e){le(e,!0);var r=_r();r.__click=[or,e];var i=l(r);w(i,()=>e.children,c=>{var _=gt(),g=be(_);Qt(g,()=>e.children),s(c,_)},c=>{var _=ir();s(c,_)}),n(r),s(o,r),oe()}je(["click"]);const sr=(o,e,r,i,c)=>{m(e,"");try{const _=JSON.parse(a(r));_&&!_.id&&(_.id=Ta());const g=$e.parse(_);i.onsubmit(g)}catch(_){console.error("failed to import data",_),m(e,O(_.message||"unknown error"))}m(c,!1)},dr=(o,e,r,i,c)=>{m(e,O(m(r,O(JSON.stringify(i()))))),m(c,!0)};var cr=d("editing level",1),vr=d("create a new level",1),ur=(o,e)=>m(e,Nt(o.currentTarget.value)),mr=(o,e)=>m(e,!0),gr=d("the lowest note must be lower than the highest",1),br=d("<!> <br>",1),fr=(o,e)=>m(e,Ft(o.currentTarget.value)),hr=(o,e)=>m(e,!0),pr=(o,e,r)=>e.onsubmit(r()),yr=d("save changes to level",1),kr=d("create level",1),wr=(o,e)=>m(e,!a(e)),jr=(o,e,r)=>{m(e,!1),r.onremove(r.level_data.id)},xr=d('<div class="pb_md"><button type="button" class="color_c w_100 svelte-h4qokl">✕ confirm remove</button></div>'),zr=(o,e)=>e.onduplicate(e.level_data.id),qr=d('<button type="button" class="svelte-h4qokl">duplicate level</button>'),Ir=d('<button type="button" class="svelte-h4qokl">remove level</button> <!> <!>',1),Sr=d("import/export data",1),Ar=d("import data",1),Pr=d("<pre> </pre>"),Tr=d('<div class="overflow_x_auto"><!></div>'),Lr=(o,e,r,i)=>e.onplay(a(r)?i():e.level_data,a(r)),Dr=d('<button type="button" class="svelte-h4qokl">play!</button>'),Er=(o,e)=>e.onclose(e.level_data.id),Mr=d("discard changes and stop editing",1),Or=d("close level editor",1),Vr=d('<button type="button" class="svelte-h4qokl"><!></button>'),Rr=d('<div class="importing bg shadow_d_xl p_xl width_md box svelte-h4qokl"><h2 class="my_0">import level data</h2> <!> <textarea class="svelte-h4qokl"></textarea> <button type="button" class="svelte-h4qokl">import project data</button></div>'),Nr=d('<div class="bg shadow_d_xl p_xl width_md box"><h2 class="my_0">pick intervals</h2> <!> <button type="button" class="svelte-h4qokl">cancel</button></div>'),Cr=d('<button type="button" class="mb_lg svelte-h4qokl">cancel</button>'),Fr=d('<div class="bg shadow_d_xl py_xl box"><h2 class="my_0">pick tonics</h2> <!></div>'),Br=d(`<form class="level_def_form w_100"><header><h2 class="my_0"><!></h2></header> <div class="fields svelte-h4qokl"><fieldset><label><div class="title">name</div> <input></label></fieldset> <fieldset><label class="mb_0" title="the semitones to include relative to the tonic"><div class="title">intervals</div> <input></label> <button type="button" class="svelte-h4qokl">pick intervals</button> <details><summary>about <code>intervals</code></summary> <p><code>intervals</code> is a comma-separated list of numbers representing the <a href="https://wikipedia.org/wiki/Interval_(music)">musical intervals</a> used in the
					level, aka the number of piano keys (<a href="https://wikipedia.org/wiki/Semitone">semitones</a>) separating each note from the <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> (see below)</p> <p>for example, to practice distinguishing between the <a href="https://wikipedia.org/wiki/Perfect_fourth">perfect fourth</a> and <a href="https://wikipedia.org/wiki/Perfect_fifth">perfect fifth</a>, enter "<code>5, 7</code>"</p> <p>negative numbers are allowed</p></details></fieldset> <fieldset><label title="the number of trials per level"><div class="title">trial count</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset><label title="the number of notes per trial"><div class="title">sequence length</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset class="row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="number"> <input type="range"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="number"> <input type="range"></label></fieldset> <!> <fieldset><label class="mb_0" title="the possible starting notes for each trial"><div class="title">tonics</div> <input placeholder="all"></label> <button type="button" class="svelte-h4qokl">pick tonics</button> <details><summary>about <code>tonics</code></summary> <p>The <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> is like the "base" or "home"
					note, and for our purposes it's always the first note played in a trial. Other notes in the
					trial are calculated from the tonic and intervals. (see above)</p></details></fieldset> <button type="button" class="accent svelte-h4qokl"><!></button> <!> <button type="button" class="svelte-h4qokl"><!></button> <!> <!> <!></div></form> <!> <!> <!>`,1);function Hr(o,e){le(e,!0);const r=$(e,"editing",3,!1),i=Jt();let c=L(!1),_=L(O(e.level_data.name));const g=u(()=>{var x;return(x=a(_))==null?void 0:x.trim()});let h=L(e.level_data.intervals),b=L(e.level_data.tonics);const z=u(()=>a(b)?a(b).filter(x=>x>=a(v)&&x<=a(p)):a(b));let y=L(O(e.level_data.trial_count)),f=L(O(e.level_data.sequence_length)),v=L(O(e.level_data.min_note)),p=L(O(e.level_data.max_note));const k=()=>$e.parse({id:e.level_data.id,name:a(g),intervals:a(h),tonics:a(z),trial_count:a(y),sequence_length:a(f),min_note:a(v),max_note:a(p)});Ee(()=>{m(_,O(e.level_data.name)),m(h,e.level_data.intervals),m(b,e.level_data.tonics),m(y,O(e.level_data.trial_count)),m(f,O(e.level_data.sequence_length)),m(v,O(e.level_data.min_note)),m(p,O(e.level_data.max_note))});const I=u(()=>a(g)!==e.level_data.name||a(y)!==e.level_data.trial_count||a(f)!==e.level_data.sequence_length||a(v)!==e.level_data.min_note||a(p)!==e.level_data.max_note||!Pe(a(h),e.level_data.intervals)||!Pe(a(z),e.level_data.tonics));let T=L(!1),J=L(!1),X=L(!1),ne=L(""),Z=L("");const te=u(()=>a(ne)!==a(Z));let se=L("");Ee(()=>{e.level_data,m(se,"")});let ve=L(void 0),ie=L(void 0),N=L(void 0),R=L(void 0);const U=u(()=>a(b)&&new Set(a(b)));let G=L(O(Vt)),K=L(1),W=L(void 0);const F=u(()=>a(v)>=a(p));var P=Br(),A=be(P),Q=l(A),q=l(Q),S=l(q);w(S,r,x=>{var M=cr();s(x,M)},x=>{var M=vr();s(x,M)}),n(q),n(Q);var C=t(t(Q,!0)),E=l(C),B=l(E),V=l(B),j=t(t(V,!0));we(j),n(B),n(E);var D=t(t(E,!0)),ee=l(D),de=l(ee),ce=t(t(de,!0));Ie(ce,x=>m(N,x),()=>a(N)),we(ce),H(()=>Ze(ce,vt(a(h)))),ce.__change=[ur,h],n(ee);var Se=t(t(ee,!0));Se.__click=[mr,J];var Be=t(t(Se,!0)),ze=l(Be);t(l(ze)),n(ze);var xe=t(t(ze,!0)),at=l(xe),ta=t(t(at,!0)),aa=t(t(ta,!0));t(t(aa,!0)),Ae(),n(xe);var rt=t(t(xe,!0)),ra=t(l(rt)),na=t(t(ra,!0));t(t(na,!0)),Ae(),n(rt),t(t(rt,!0)),n(Be),n(D);var nt=t(t(D,!0)),ft=l(nt),la=l(ft),ht=t(t(la,!0)),He=l(ht);we(He),Y(He,"min",1);var Je=t(t(He,!0));we(Je),Y(Je,"min",1),Y(Je,"max",20),n(ht),n(ft),n(nt);var lt=t(t(nt,!0)),pt=l(lt),oa=l(pt),yt=t(t(oa,!0)),Ue=l(yt);we(Ue),Y(Ue,"min",2);var We=t(t(Ue,!0));we(We),Y(We,"min",2),Y(We,"max",16),n(yt),n(pt),n(lt);var ot=t(t(lt,!0)),it=l(ot),ia=l(it),_t=t(t(ia,!0)),_a=l(_t);n(_t);var Te=t(t(_t,!0));we(Te),Y(Te,"step",1),Y(Te,"min",Ke),Y(Te,"max",Xe);var Oe=t(t(Te,!0));we(Oe),Y(Oe,"step",1),Y(Oe,"min",Ke),Y(Oe,"max",Xe),n(it);var kt=t(t(it,!0)),sa=l(kt),st=t(t(sa,!0)),da=l(st);n(st);var Le=t(t(st,!0));we(Le),Y(Le,"step",1),Y(Le,"min",Ke),Y(Le,"max",Xe);var Ve=t(t(Le,!0));we(Ve),Y(Ve,"step",1),Y(Ve,"min",Ke),Y(Ve,"max",Xe),n(kt),n(ot);var wt=t(t(ot,!0));w(wt,()=>a(F),x=>{Qe(x,{status:"error",children:(M,re)=>{Ae();var ae=gr();s(M,ae)},$$slots:{default:!0}})},x=>{var M=br(),re=be(M),ae=u(()=>a(W)??0);ea(re,{get width(){return a(ae)},max_height:50,get min_note(){return a(v)},get max_note(){return a(p)},get highlighted_keys(){return a(U)},clickable:!1,middle_c_label:!0}),t(t(re,!0)),s(x,M)});var Ye=t(t(wt,!0)),dt=l(Ye),ca=l(dt),Ge=t(t(ca,!0));Ie(Ge,x=>m(R,x),()=>a(R)),we(Ge),H(()=>Ze(Ge,mt(a(b)))),Ge.__change=[fr,b],n(dt);var jt=t(t(dt,!0));jt.__click=[hr,X];var xt=t(t(jt,!0)),ct=l(xt);t(l(ct)),n(ct);var zt=t(t(ct,!0));t(l(zt)),Ae(),n(zt),n(xt),n(Ye);var Re=t(t(Ye,!0));Re.__click=[pr,e,k];var va=l(Re);w(va,r,x=>{var M=yr();s(x,M)},x=>{var M=kr();s(x,M)}),n(Re);var qt=t(t(Re,!0));w(qt,()=>e.onremove&&r(),x=>{var M=Ir(),re=be(M);re.__click=[wr,c];var ae=t(t(re,!0));w(ae,()=>a(c),ke=>{var _e=xr(),qe=l(_e);qe.__click=[jr,c,e],n(_e),pe(3,_e,()=>ye),s(ke,_e)});var ue=t(t(ae,!0));w(ue,()=>e.onduplicate,ke=>{var _e=qr();_e.__click=[zr,e],s(ke,_e)}),s(x,M)});var Ne=t(t(qt,!0));Ie(Ne,x=>m(ie,x),()=>a(ie)),Ne.__click=[dr,ne,Z,k,T];var ua=l(Ne);w(ua,r,x=>{var M=Sr();s(x,M)},x=>{var M=Ar();s(x,M)}),n(Ne);var It=t(t(Ne,!0));w(It,()=>a(se),x=>{var M=Tr(),re=l(M);Qe(re,{status:"error",children:(ae,ue)=>{var ke=Pr(),_e=l(ke);n(ke),H(()=>me(_e,a(se))),s(ae,ke)},$$slots:{default:!0}}),n(M),s(x,M)});var St=t(t(It,!0));w(St,()=>e.onplay&&r(),x=>{var M=Dr();M.__click=[Lr,e,I,k],s(x,M)});var ma=t(t(St,!0));w(ma,()=>e.onclose&&r(),x=>{var M=Vr();M.__click=[Er,e];var re=l(M);w(re,()=>a(I),ae=>{var ue=Mr();s(ae,ue)},ae=>{var ue=Or();s(ae,ue)}),n(M),s(x,M)}),n(C),n(A);var At=t(t(A,!0));w(At,()=>a(T),x=>{Ce(x,{onclose:()=>{var M;m(T,!1),(M=a(ie))==null||M.focus()},children:(M,re)=>{var ae=Rr(),ue=l(ae),ke=t(t(ue,!0));bt(ke,{get text(){return a(Z)},oncopy:()=>{var fe;(fe=a(ve))==null||fe.select()}});var _e=t(t(ke,!0));Ie(_e,fe=>m(ve,fe),()=>a(ve)),Fe(_e);var qe=t(t(_e,!0));qe.__click=[sr,se,Z,e,T],n(ae),H(()=>{qe.disabled=!a(te),Y(qe,"title",a(te)?void 0:"data has not changed")}),he(_e,()=>a(Z),fe=>m(Z,fe)),s(M,ae)},$$slots:{default:!0}})});var Pt=t(t(At,!0));w(Pt,()=>a(J),x=>{Ce(x,{onclose:()=>{var re;m(J,!1),(re=a(N))==null||re.focus()},children:(re,ae=Dt)=>{var ue=Nr(),ke=l(ue),_e=t(t(ke,!0));Ka(_e,{get intervals(){return a(h)},get scale(){return a(G)},set scale(fe){m(G,O(fe))},get octaves(){return a(K)},set octaves(fe){m(K,O(fe))},oninput:fe=>{m(h,fe),ae()()}});var qe=t(t(_e,!0));qe.__click=function(...fe){var De;(De=ae())==null||De.apply(this,fe)},n(ue),s(re,ue)}})});var ga=t(t(Pt,!0));w(ga,()=>a(X),x=>{Ce(x,{onclose:()=>{var re;m(X,!1),(re=a(R))==null||re.focus()},children:(re,ae=Dt)=>{var ue=Fr(),ke=l(ue),_e=t(t(ke,!0)),qe=u(()=>new Set(a(b)));lr(_e,{audio_state:i,get notes(){return a(qe)},get min_note(){return a(v)},get max_note(){return a(p)},oninput:De=>{m(b,De),ae()()},before_buttons:De=>{var Tt=Cr();Tt.__click=function(...ba){var Lt;(Lt=ae())==null||Lt.apply(this,ba)},s(De,Tt)}}),n(ue),s(re,ue)}})}),H(()=>{me(_a,Et[a(v)]),me(da,Et[a(p)]),Re.disabled=r()&&!a(I)||a(F)}),he(j,()=>a(_),x=>m(_,x)),he(He,()=>a(y),x=>m(y,x)),he(Je,()=>a(y),x=>m(y,x)),he(Ue,()=>a(f),x=>m(f,x)),he(We,()=>a(f),x=>m(f,x)),he(Te,()=>a(v),x=>m(v,x)),he(Oe,()=>a(v),x=>m(v,x)),he(Le,()=>a(p),x=>m(p,x)),he(Ve,()=>a(p),x=>m(p,x)),Na(Ye,"clientWidth",x=>m(W,x)),s(o,P),oe()}je(["change","click"]);var Jr=(o,e,r)=>e()(r.project.id),Ur=d('<button type="button" class="flex_1"> </button>'),Wr=(o,e,r,i,c)=>{var _,g;return a(e)?(_=r())==null?void 0:_(i.project.id):(g=c())==null?void 0:g(i.project_data??i.load(i.project.id))},Yr=d("✕",1),Gr=d("✎",1),Kr=d('<button type="button" class="icon_button plain_button size_xl deselectable svelte-12y7az0"><!></button>'),Xr=(o,e)=>m(e,!a(e)),Zr=d("×",1),Qr=d("✕",1),$r=d('<button type="button" class="icon_button plain_button size_xl svelte-12y7az0"><!></button>'),en=d('<li class="project_item svelte-12y7az0"><!> <!> <!></li>');function tn(o,e){le(e,!0);const r=$(e,"select",3,null),i=$(e,"edit",3,null),c=$(e,"remove",3,null);let _=L(!1);var g=en(),h=l(g);w(h,r,f=>{var v=Ur();v.__click=[Jr,r,e];var p=l(v);n(v),H(()=>{ge(v,"selected",e.selected),me(p,e.project.name)}),s(f,v)});var b=t(h,!0);b.nodeValue="  ";var z=t(b);w(z,()=>a(_)&&c()||!a(_)&&i(),f=>{var v=Kr();v.__click=[Wr,_,c,e,i];var p=l(v);w(p,()=>a(_),k=>{var I=Yr();s(k,I)},k=>{var I=Gr();s(k,I)}),n(v),H(()=>{Y(v,"title",a(_)?"remove project":"edit project"),ge(v,"selected",e.selected&&!a(_)&&e.editing),ge(v,"color_c",a(_))}),s(f,v)});var y=t(t(z,!0));w(y,c,f=>{var v=$r();v.__click=[Xr,_];var p=l(v);w(p,()=>a(_),k=>{var I=Zr();s(k,I)},k=>{var I=Qr();s(k,I)}),n(v),H(()=>Y(v,"title",a(_)?"cancel removing":"remove project")),s(f,v)}),n(g),H(()=>ge(g,"selected",e.selected)),pe(3,g,()=>ye),s(o,g),oe()}je(["click"]);var an=d('<menu class="unstyled width_sm mb_0"></menu>');function rn(o,e){le(e,!0);const r=$(e,"selected_project_id",3,null),i=$(e,"editing_project_id",3,null),c=$(e,"projects",19,()=>[]),_=$(e,"project_datas",19,()=>[]);var g=an();Me(g,21,c,(h,b)=>h.id,(h,b,z)=>{var y=u(()=>_().find(p=>p.id===a(b).id)),f=u(()=>a(b).id===r()),v=u(()=>a(b).id===i());tn(h,{get project(){return a(b)},get project_data(){return a(y)},get load(){return e.load_project},get select(){return e.select_project},get edit(){return e.edit_project},get remove(){return e.remove_project},get selected(){return a(f)},get editing(){return a(v)}})}),n(g),s(o,g),oe()}var nn=(o,e,r,i)=>{a(e)?r().editing_project=!1:a(i)(et.parse({}))},ln=d('<div class="panel p_md"><header><h2 class="my_0">projects</h2></header> <!> <button type="button" class="w_100 mt_md deselectable">create a new project</button></div>');function on(o,e){le(e,!0);const r=$(e,"app",7),i=u(()=>r().load_project),c=u(()=>r().select_project),_=u(()=>r().edit_project),g=u(()=>r().remove_project),h=u(()=>r().editing_project&&r().selected_project_id!==r().editing_project_id),b=u(()=>r().app_data),z=u(()=>a(b).projects);var y=ln(),f=l(y);l(f),n(f);var v=t(t(f,!0)),p=u(()=>r().editing_project?r().editing_project_id:null);rn(v,{get selected_project_id(){return r().selected_project_id},get editing_project_id(){return a(p)},get projects(){return a(z)},get project_datas(){return r().project_datas},get load_project(){return a(i)},get select_project(){return a(c)},edit_project:I=>a(_)(I===r().editing_project_data&&r().editing_project?null:I),get remove_project(){return a(g)}});var k=t(t(v,!0));k.__click=[nn,h,r,_],n(y),H(()=>ge(k,"selected",a(h))),s(o,y),oe()}je(["click"]);var _n=(o,e)=>e.toggle(),sn=d(`<aside>devices with smaller screens aren't well supported yet, see <a href="https://github.com/ryanatkn/earbetter/issues/2">issue #2</a></aside> <table><tbody><tr><td class="svelte-1gwge1y"><code>Spacebar</code></td><td class="svelte-1gwge1y">replay trial</td></tr><tr><td class="svelte-1gwge1y"><code>r</code></td><td class="svelte-1gwge1y">restart level</td></tr><tr><td class="svelte-1gwge1y"><code>Escape</code></td><td class="svelte-1gwge1y"><button type="button" class="inline">toggle main menu</button></td></tr><tr><td class="svelte-1gwge1y"><code>1 to 4</code></td><td class="svelte-1gwge1y">set instrument</td></tr><tr><td class="svelte-1gwge1y"><code>c</code></td><td class="svelte-1gwge1y">connect MIDI</td></tr><tr><td class="svelte-1gwge1y"><code>up/down arrows</code></td><td class="svelte-1gwge1y">adjust volume</td></tr></tbody></table>`,1);function dn(o,e){le(e,!0);const r=xa();var i=sn(),c=be(i);t(l(c)),n(c);var _=t(t(c,!0)),g=l(_),h=l(g),b=l(h);l(b),n(b),t(b),n(h);var z=t(h),y=l(z);l(y),n(y),t(y),n(z);var f=t(z),v=l(f);l(v),n(v);var p=t(v),k=l(p);k.__click=[_n,r],Zt(k,"min-width","172px"),n(p),n(f);var I=t(f),T=l(I);l(T),n(T),t(T),n(I);var J=t(I),X=l(J);l(X),n(X),t(X),n(J);var ne=t(J),Z=l(ne);l(Z),n(Z),t(Z),n(ne),n(g),n(_),s(o,i),oe()}je(["click"]);var cn=d('<div class="realm_stats_summary svelte-1mwdoug" title="you performed flawlessly in every level of this realm!">★</div>');function vn(o,e){le(e,!0);const r=u(()=>e.realm_data.levels.map(y=>e.level_stats.mistakes[y.id]??[])),i=u(()=>a(r).reduce((y,f)=>y+f.length,0)),c=u(()=>Ut*a(r).length),_=u(()=>!!a(i)&&a(i)>=a(c)),g=u(()=>a(_)?a(r).reduce((y,f)=>y+f.reduce((v,p)=>v+p,0),0):void 0),h=u(()=>a(g)===0);var b=gt(),z=be(b);w(z,()=>a(h),y=>{var f=cn();s(y,f)}),s(o,b),oe()}var un=(o,e,r)=>e()(r.realm_data.id),mn=d('<button type="button" class="realm_button svelte-1joa4ch"> </button>'),gn=(o,e,r,i,c)=>{var _,g;return a(e)?(_=r())==null?void 0:_(i.realm_data.id):(g=c())==null?void 0:g(i.realm_data)},bn=d("✕",1),fn=d("✎",1),hn=d('<button type="button" class="icon_button plain_button size_xl deselectable svelte-1joa4ch"><!></button>'),pn=(o,e)=>m(e,!a(e)),yn=d("×",1),kn=d("✕",1),wn=d('<button type="button" class="icon_button plain_button size_xl svelte-1joa4ch"><!></button>'),jn=d('<li class="realm_item svelte-1joa4ch"><!> <!> <!> <!></li>');function xn(o,e){le(e,!0);const r=$(e,"select",3,null),i=$(e,"edit",3,null),c=$(e,"remove",3,null);let _=L(!1);const g=u(()=>e.project_data.level_stats);var h=jn(),b=l(h);w(b,()=>a(g),p=>{vn(p,{get realm_data(){return e.realm_data},get level_stats(){return a(g)}})});var z=t(t(b,!0));w(z,r,p=>{var k=mn();k.__click=[un,r,e];var I=l(k);n(k),H(()=>{ge(k,"selected",e.selected),me(I,e.realm_data.name)}),s(p,k)});var y=t(z,!0);y.nodeValue="  ";var f=t(y);w(f,()=>a(_)&&c()||!a(_)&&i(),p=>{var k=hn();k.__click=[gn,_,c,e,i];var I=l(k);w(I,()=>a(_),T=>{var J=bn();s(T,J)},T=>{var J=fn();s(T,J)}),n(k),H(()=>{Y(k,"title",a(_)?"remove realm":e.editing?"stop editing realm":"edit realm"),ge(k,"selected",e.selected&&!a(_)&&e.editing),ge(k,"color_c",a(_))}),s(p,k)});var v=t(t(f,!0));w(v,c,p=>{var k=wn();k.__click=[pn,_];var I=l(k);w(I,()=>a(_),T=>{var J=yn();s(T,J)},T=>{var J=kn();s(T,J)}),n(k),H(()=>Y(k,"title",a(_)?"cancel removing":"remove realm")),s(p,k)}),n(h),H(()=>ge(h,"selected",e.selected)),pe(3,h,()=>ye),s(o,h),oe()}je(["click"]);var zn=d('<menu class="unstyled width_sm mb_0"></menu>');function qn(o,e){le(e,!0);const r=$(e,"selected_realm_data",3,null),i=$(e,"editing_realm_id",3,null),c=$(e,"realms",19,()=>[]),_=u(()=>new Map(c().map(b=>[b.id,b]))),g=b=>a(_).get(b);var h=zn();Me(h,21,c,(b,z)=>b.id,(b,z,y)=>{var f=u(()=>g(a(z).id)),v=u(()=>{var k;return a(z).id===((k=r())==null?void 0:k.id)}),p=u(()=>a(z).id===i());xn(b,{get realm_data(){return a(f)},get project_data(){return e.project_data},get select(){return e.select_realm},get edit(){return e.edit_realm},get remove(){return e.remove_realm},get selected(){return a(v)},get editing(){return a(p)}})}),n(h),s(o,h),oe()}const In=(o,e,r,i,c)=>{var _;a(e)?(_=document.querySelector(".realm_def_form input"))==null||_.focus():a(r)?i().editing_realm=!1:a(c)(tt.parse({}))};var Sn=d("<div><!></div>"),An=d('<div class="panel p_md"><header><h2 class="my_0">realms</h2></header> <!> <button type="button">create a new realm</button></div>');function Pn(o,e){le(e,!0);const r=$(e,"app",7),i=u(()=>r().select_realm),c=u(()=>r().edit_realm),_=u(()=>r().remove_realm),g=u(()=>{var v;return r().editing_realm&&!!r().editing_realm_data&&((v=r().selected_realm_data)==null?void 0:v.id)!==r().editing_realm_data.id}),h=u(()=>{var v;return!((v=r().realms)!=null&&v.length)});var b=An(),z=l(b);l(z),n(z);var y=t(t(z,!0));w(y,()=>r().realms&&r().selected_project_data,v=>{var p=Sn(),k=l(p),I=u(()=>r().editing_realm?r().editing_realm_id:null);qn(k,{get project_data(){return r().selected_project_data},get selected_realm_data(){return r().selected_realm_data},get realms(){return r().realms},get editing_realm_id(){return a(I)},get select_realm(){return a(i)},edit_realm:T=>a(c)(T===r().editing_realm_data&&r().editing_realm?null:T),get remove_realm(){return a(_)}}),n(p),pe(3,p,()=>ye),s(v,p)});var f=t(t(y,!0));f.__click=[In,h,g,r,c],n(b),H(()=>{Ra(f,`${(a(h)?void 0:"deselectable")??""} svelte-100yq62`),ge(f,"selected",a(g)||a(h))}),s(o,b),oe()}je(["click"]);const Tn=(o,e,r,i,c)=>{m(e,"");try{const _=JSON.parse(a(r));_&&!_.id&&(_.id=La());const g=tt.parse(_);i.onsubmit(g)}catch(_){console.error("failed to import data",_),m(e,O(_.message||"unknown error"))}m(c,!1)},Ln=(o,e,r,i,c)=>{m(e,O(m(r,O(JSON.stringify(i()))))),m(c,!0)};var Dn=d('<div class="importing bg shadow_d_xl p_xl width_md box svelte-1g446ss"><h2 class="my_0">import realm data</h2> <!> <textarea class="svelte-1g446ss"></textarea> <button type="button" class="svelte-1g446ss">import realm data</button></div>'),En=d("editing realm",1),Mn=d("create a new realm",1),On=(o,e,r)=>{o.key==="Enter"&&(Yt(o),e.onsubmit(r()))},Vn=(o,e,r)=>e.onsubmit(r()),Rn=d("save changes to realm",1),Nn=d("create realm",1),Cn=(o,e)=>m(e,!a(e)),Fn=(o,e,r)=>{m(e,!1),r.onremove(r.realm_data.id)},Bn=d('<div class="pb_md"><button type="button" class="color_c w_100 svelte-1g446ss">✕ confirm remove</button></div>'),Hn=(o,e)=>e.onduplicate(e.realm_data.id),Jn=d('<button type="button" class="svelte-1g446ss">duplicate realm</button>'),Un=d('<button type="button" class="svelte-1g446ss">remove realm</button> <!> <!>',1),Wn=d("import/export data",1),Yn=d("import data",1),Gn=(o,e)=>m(e,!a(e)),Kn=(o,e,r)=>{m(e,!1),r.onsubmit(Wt().realms)},Xn=d('<div><button type="button" class="w_100 svelte-1g446ss"> </button></div>'),Zn=d('<button type="button" class="svelte-1g446ss">create default realms</button> <!>',1),Qn=d("<pre> </pre>"),$n=d('<div class="message-wrapper svelte-1g446ss"><!></div>'),el=(o,e)=>e.onclose(e.realm_data.id),tl=d("discard changes",1),al=d("close realm editor",1),rl=d('<button class="w_100 svelte-1g446ss" type="button"><!></button>'),nl=d('<!> <form class="realm_def_form"><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent svelte-1g446ss"><!></button> <!> <button type="button" class="svelte-1g446ss"><!></button> <!> <!> <!></form>',1);function ll(o,e){le(e,!0);const r=$(e,"editing",3,!1);let i=L(!1),c=L(O(e.realm_data.name));const _=u(()=>{var q;return(q=a(c))==null?void 0:q.trim()}),g=()=>tt.parse({id:e.realm_data.id,name:a(_),levels:e.realm_data.levels});Ee(()=>{console.log("set_realm_data",e.realm_data),m(c,O(e.realm_data.name))});const h=u(()=>a(_)!==e.realm_data.name);let b=L(!1),z=L(""),y=L("");const f=u(()=>a(z)!==a(y));let v=L("");Ee(()=>{e.realm_data,m(v,"")});let p=L(void 0),k=L(void 0);const I=Wt().realms;let T=L(!1);var J=nl(),X=be(J);w(X,()=>a(b),q=>{Ce(q,{onclose:()=>{var S;m(b,!1),(S=a(k))==null||S.focus()},children:(S,C)=>{var E=Dn(),B=l(E),V=t(t(B,!0));bt(V,{get text(){return a(y)},oncopy:()=>{var ee;(ee=a(p))==null||ee.select()}});var j=t(t(V,!0));Ie(j,ee=>m(p,ee),()=>a(p)),Fe(j);var D=t(t(j,!0));D.__click=[Tn,v,y,e,b],n(E),H(()=>{D.disabled=!a(f),Y(D,"title",a(f)?void 0:"data has not changed")}),he(j,()=>a(y),ee=>m(y,ee)),s(S,E)},$$slots:{default:!0}})});var ne=t(t(X,!0)),Z=l(ne),te=l(Z),se=l(te);w(se,r,q=>{var S=En();s(q,S)},q=>{var S=Mn();s(q,S)}),n(te),n(Z);var ve=t(t(Z,!0)),ie=l(ve),N=l(ie),R=t(t(N,!0));we(R),R.__keydown=[On,e,g],n(ie),n(ve);var U=t(t(ve,!0));U.__click=[Vn,e,g];var G=l(U);w(G,r,q=>{var S=Rn();s(q,S)},q=>{var S=Nn();s(q,S)}),n(U);var K=t(t(U,!0));w(K,()=>e.onremove&&r(),q=>{var S=Un(),C=be(S);C.__click=[Cn,i];var E=t(t(C,!0));w(E,()=>a(i),V=>{var j=Bn(),D=l(j);D.__click=[Fn,i,e],n(j),pe(3,j,()=>ye),s(V,j)});var B=t(t(E,!0));w(B,()=>e.onduplicate,V=>{var j=Jn();j.__click=[Hn,e],s(V,j)}),s(q,S)});var W=t(t(K,!0));Ie(W,q=>m(k,q),()=>a(k)),W.__click=[Ln,z,y,g,b];var F=l(W);w(F,r,q=>{var S=Wn();s(q,S)},q=>{var S=Yn();s(q,S)}),n(W);var P=t(t(W,!0));w(P,()=>!r(),q=>{var S=Zn(),C=be(S);C.__click=[Gn,T];var E=t(t(C,!0));w(E,()=>a(T),B=>{var V=Xn(),j=l(V);j.__click=[Kn,T,e];var D=l(j);n(j),n(V),H(()=>me(D,`create ${I.length??""} new realms`)),pe(3,V,()=>ye),s(B,V)}),s(q,S)});var A=t(t(P,!0));w(A,()=>a(v),q=>{var S=$n(),C=l(S);Qe(C,{status:"error",children:(E,B)=>{var V=Qn(),j=l(V);n(V),H(()=>me(j,a(v))),s(E,V)},$$slots:{default:!0}}),n(S),s(q,S)});var Q=t(t(A,!0));w(Q,()=>e.onclose&&r(),q=>{var S=rl();S.__click=[el,e];var C=l(S);w(C,()=>a(h),E=>{var B=tl();s(E,B)},E=>{var B=al();s(E,B)}),n(S),s(q,S)}),n(ne),H(()=>U.disabled=r()&&!a(h)),he(R,()=>a(c),q=>m(c,q)),s(o,J),oe()}je(["click","keydown"]);var ol=d('<div class="panel p_md"><!></div>');function il(o,e){le(e,!0);const r=$(e,"app",7),i=u(()=>r().remove_realm),c=u(()=>r().duplicate_realm),_=u(()=>r().update_realm),g=u(()=>r().create_realm),h=u(()=>r().editing_realm_data??tt.parse({})),b=u(()=>r().realms?r().realms.some(v=>v.id===a(h).id):!1),z=(v,p)=>{var k;(k=r().realms)!=null&&k.some(I=>I.id===v.id)?a(_)(v):a(g)(v,p)};var y=ol(),f=l(y);ll(f,{get editing(){return a(b)},get realm_data(){return a(h)},onsubmit:v=>{if(Array.isArray(v))for(let p=0;p<v.length;(p+=1)-1)z(v[p],p===0);else z(v,!0)},onremove:v=>a(i)(v),onduplicate:v=>a(c)(v),onclose:()=>r().editing_realm=!1}),n(y),s(o,y),oe()}var _l=(o,e)=>e.app.play_level(e.level_data.id),sl=async(o,e,r,i)=>{if(a(e))r.app.remove_level(r.level_data.id);else{const c=!a(i);if(r.app.edit_level(c?r.level_data:null),c){await ya();const _=document.querySelector(".level_def_form");_==null||_.scrollIntoView({behavior:"smooth",block:"center"})}}},dl=d("✕",1),cl=d("✎",1),vl=(o,e)=>m(e,!a(e)),ul=d("×",1),ml=d("✕",1),gl=d('<li class="level_map_item svelte-170pvnv"><!> <button type="button" class="level_button deselectable svelte-170pvnv" title="play this level"> </button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button></li>');function bl(o,e){le(e,!0);const r=u(()=>e.app.draft_level_data===e.level_data),i=u(()=>e.app.editing_level&&a(r)),c=u(()=>{var I;return(I=e.app.selected_project_data)==null?void 0:I.level_stats});let _=L(!1);const g=u(()=>a(i)||a(r));var h=gl(),b=l(h);w(b,()=>a(c),I=>{Ba(I,{get level_data(){return e.level_data},get level_stats(){return a(c)}})});var z=t(t(b,!0));z.__click=[_l,e];var y=l(z);n(z);var f=t(t(z,!0));f.__click=[sl,_,e,i];var v=l(f);w(v,()=>a(_),I=>{var T=dl();s(I,T)},I=>{var T=cl();s(I,T)}),n(f);var p=t(t(f,!0));p.__click=[vl,_];var k=l(p);w(k,()=>a(_),I=>{var T=ul();s(I,T)},I=>{var T=ml();s(I,T)}),n(p),n(h),H(()=>{ge(h,"selected",a(g)),ge(z,"selected",a(g)),me(y,e.level_data.name),Y(f,"title",a(_)?"remove level":a(i)?"stop editing level":"edit level"),ge(f,"selected",!a(_)&&a(i)),ge(f,"color_c",a(_)),Y(p,"title",a(_)?"cancel removing":"remove level")}),pe(3,h,()=>ye),s(o,h),oe()}je(["click"]);const fl=(o,e,r,i)=>{var c;a(e)?(c=document.querySelector(".level_def_form input"))==null||c.focus():r.app.edit_level(a(i)?null:$e.parse({}))};var hl=d('<div class="panel p_md"><header><h2 class="my_0">levels</h2> <h3 class="my_0"> </h3></header> <menu class="levels unstyled mb_0 svelte-wmjxbn"></menu> <button type="button" class="svelte-wmjxbn">create a new level</button></div>');function pl(o,e){le(e,!0);const r=u(()=>e.app.editing_level&&!e.levels.some(f=>f===e.app.draft_level_data)),i=u(()=>!e.levels.length);var c=hl(),_=l(c),g=l(_),h=t(t(g,!0)),b=l(h);n(h),n(_);var z=t(t(_,!0));Me(z,21,()=>e.levels,(f,v)=>f.id,(f,v,p)=>{bl(f,{get app(){return e.app},get level_data(){return a(v)}})}),n(z);var y=t(t(z,!0));y.__click=[fl,i,e,r],n(c),H(()=>{var f;me(b,(f=e.app.selected_realm_data)==null?void 0:f.name),ge(y,"selected",a(r)||a(i)),ge(y,"deselectable",!a(i))}),s(o,c),oe()}je(["click"]);const yl=(o,e,r,i,c)=>{m(e,"");try{const _=JSON.parse(a(r));_&&!_.id&&(_.id=Da());const g=et.parse(_);i.onsubmit(g)}catch(_){console.error("failed to import data",_),m(e,O(_.message||"unknown error"))}m(c,!1)},kl=(o,e,r,i,c)=>{m(e,O(m(r,O(JSON.stringify(i()))))),m(c,!0)};var wl=d('<div class="importing bg shadow_d_xl p_xl width_md box svelte-l3tcx7"><h2 class="my_0">import project data</h2> <!> <textarea class="svelte-l3tcx7"></textarea> <button type="button" class="svelte-l3tcx7">import project data</button></div>'),jl=d("editing project",1),xl=d("create a new project",1),zl=(o,e,r)=>{o.key==="Enter"&&(Yt(o),e.onsubmit(r()))},ql=(o,e,r)=>e.onsubmit(r()),Il=d("save changes to project",1),Sl=d("create project",1),Al=(o,e)=>m(e,!a(e)),Pl=(o,e,r)=>{m(e,!1),r.onremove(r.project_data.id)},Tl=d('<div class="pb_md"><button type="button" class="color_c w_100 svelte-l3tcx7">✕ confirm remove</button></div>'),Ll=(o,e)=>e.onduplicate(e.project_data.id),Dl=d('<button type="button" class="w_100 svelte-l3tcx7">duplicate project</button>'),El=d('<button class="w_100 svelte-l3tcx7" type="button">remove project</button> <!> <!>',1),Ml=d("import/export data",1),Ol=d("import data",1),Vl=d("<pre> </pre>"),Rl=d('<div class="overflow_x_auto"><!></div>'),Nl=(o,e)=>e.onclose(e.project_data.id),Cl=d("discard changes and stop editing",1),Fl=d("close project editor",1),Bl=d('<button type="button" class="w_100 svelte-l3tcx7"><!></button>'),Hl=d('<!> <form><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent w_100 svelte-l3tcx7"><!></button> <!> <button type="button" class="w_100 svelte-l3tcx7"><!></button> <!> <!></form>',1);function Jl(o,e){le(e,!0);const r=$(e,"editing",3,!1);let i=L(!1),c=L(O(e.project_data.name));const _=u(()=>a(c).trim()),g=()=>et.parse({id:e.project_data.id,name:a(_),realms:e.project_data.realms,level_stats:e.project_data.level_stats});Ee(()=>{console.log("set_project_data",e.project_data),m(c,O(e.project_data.name))});const h=u(()=>a(_)!==e.project_data.name);let b=L(!1),z=L(""),y=L("");const f=u(()=>a(z)!==a(y));let v=L("");Ee(()=>{e.project_data,m(v,"")});let p=L(void 0),k=L(void 0);var I=Hl(),T=be(I);w(T,()=>a(b),P=>{Ce(P,{onclose:()=>{var A;m(b,!1),(A=a(k))==null||A.focus()},children:(A,Q)=>{var q=wl(),S=l(q),C=t(t(S,!0));bt(C,{get text(){return a(y)},oncopy:()=>{var V;(V=a(p))==null||V.select()}});var E=t(t(C,!0));Ie(E,V=>m(p,V),()=>a(p)),Fe(E);var B=t(t(E,!0));B.__click=[yl,v,y,e,b],n(q),H(()=>{B.disabled=!a(f),Y(B,"title",a(f)?void 0:"data has not changed")}),he(E,()=>a(y),V=>m(y,V)),s(A,q)},$$slots:{default:!0}})});var J=t(t(T,!0)),X=l(J),ne=l(X),Z=l(ne);w(Z,r,P=>{var A=jl();s(P,A)},P=>{var A=xl();s(P,A)}),n(ne),n(X);var te=t(t(X,!0)),se=l(te),ve=l(se),ie=t(t(ve,!0));we(ie),ie.__keydown=[zl,e,g],n(se),n(te);var N=t(t(te,!0));N.__click=[ql,e,g];var R=l(N);w(R,r,P=>{var A=Il();s(P,A)},P=>{var A=Sl();s(P,A)}),n(N);var U=t(t(N,!0));w(U,()=>e.onremove&&r(),P=>{var A=El(),Q=be(A);Q.__click=[Al,i];var q=t(t(Q,!0));w(q,()=>a(i),C=>{var E=Tl(),B=l(E);B.__click=[Pl,i,e],n(E),pe(3,E,()=>ye),s(C,E)});var S=t(t(q,!0));w(S,()=>e.onduplicate,C=>{var E=Dl();E.__click=[Ll,e],s(C,E)}),s(P,A)});var G=t(t(U,!0));Ie(G,P=>m(k,P),()=>a(k)),G.__click=[kl,z,y,g,b];var K=l(G);w(K,r,P=>{var A=Ml();s(P,A)},P=>{var A=Ol();s(P,A)}),n(G);var W=t(t(G,!0));w(W,()=>a(v),P=>{var A=Rl(),Q=l(A);Qe(Q,{status:"error",children:(q,S)=>{var C=Vl(),E=l(C);n(C),H(()=>me(E,a(v))),s(q,C)},$$slots:{default:!0}}),n(A),s(P,A)});var F=t(t(W,!0));w(F,()=>e.onclose&&r(),P=>{var A=Bl();A.__click=[Nl,e];var Q=l(A);w(Q,()=>a(h),q=>{var S=Cl();s(q,S)},q=>{var S=Fl();s(q,S)}),n(A),s(P,A)}),n(J),H(()=>N.disabled=r()&&!a(h)),he(ie,()=>a(c),P=>m(c,P)),s(o,I),oe()}je(["click","keydown"]);var Ul=d('<div class="panel p_md"><!></div>');function Wl(o,e){le(e,!0);const r=$(e,"app",7),i=u(()=>r().remove_project),c=u(()=>r().duplicate_project),_=u(()=>r().update_project),g=u(()=>r().create_project),h=u(()=>r().editing_project_data??et.parse({})),b=u(()=>r().project_datas.some(v=>v.id===a(h).id));var z=Ul(),y=l(z),f=u(()=>a(b)?a(_):a(g));Jl(y,{get editing(){return a(b)},get project_data(){return a(h)},get onsubmit(){return a(f)},get onremove(){return a(i)},get onduplicate(){return a(c)},onclose:()=>r().editing_project=!1}),n(z),s(o,z),oe()}var Yl=d('<section class="card svelte-8muejm"><!></section>'),Gl=d('<section class="card svelte-8muejm"><!></section>'),Kl=d('<div class="width_sm svelte-8muejm"><!> <!> <section class="card svelte-8muejm"><div class="panel p_md"><header><h2 class="my_0">controls</h2></header> <!> <div class="mb_lg"><!></div> <!> <aside>Earbetter supports MIDI devices like piano keyboards, connect and click:</aside> <!></div></section></div>'),Xl=(o,e)=>a(e)(),Zl=d(`<section class="card svelte-8muejm"><div class="panel p_md"><p>Earbetter is an <a href="https://wikipedia.org/wiki/Ear_training">ear training</a> tool:</p> <ul><li>each level is a standalone challenge that's a series of trials</li> <li> </li> <li>realms group levels into bigger challenges</li> <li>projects group realms so you can customize various experiences</li> <li>levels can be shared via their links or exporting/importing data</li></ul> <p>See also the 3 minute <a href="https://www.youtube.com/watch?v=zW2zI1A_Ikw">video intro on YouTube</a> and <a href="https://github.com/ryanatkn/earbetter">the readme</a>.</p> <aside>Earbetter is in early development, and many things are unfinished and unknown - feedback
						is appreciated on <a href="https://github.com/ryanatkn/earbetter">the GitHub discussions and issues</a>.</aside> <div class="box row"><button type="button" class="m_0">ok, hide this</button></div></div></section>`),Ql=d('<section class="card svelte-8muejm"><!></section>'),$l=d('<section class="card svelte-8muejm"><!></section>'),eo=d('<section class="card svelte-8muejm"><div class="panel p_md"><!></div></section>'),to=d('<div class="width_sm svelte-8muejm"><!> <!></div>'),ao=d('<!> <div class="map svelte-8muejm"><!> <div class="width_sm svelte-8muejm"><!> <section class="card svelte-8muejm"><!></section> <!></div> <!></div>',1);function ro(o,e){le(e,!0);const r=$(e,"app",7),i=u(()=>r().toggle_trainer_help),c=u(()=>r().play_level),_=u(()=>r().edit_level),g=u(()=>r().remove_level),h=u(()=>r().duplicate_level),b=u(()=>r().create_level),z=u(()=>r().update_level),y=Ct();window.ac=y;const f=u(()=>r().draft_level_data??$e.parse({})),v=u(()=>r().levels?r().levels.some(N=>N.id===a(f).id):!1),p=u(()=>{var N;return!((N=r().realms)!=null&&N.length)});var k=ao(),I=be(k);$t(I,{get midi_access(){return r().midi_access},onnotestart:(N,R)=>{Bt(r(),y(),N,Ht(r().volume,R),r().instrument)},onnotestop:N=>{ut(N)}});var T=t(t(I,!0)),J=l(T);w(J,()=>r().project_datas.length,N=>{var R=Kl(),U=l(R);w(U,()=>r().selected_project_data,B=>{var V=Yl(),j=l(V);on(j,{get app(){return r()}}),n(V),pe(3,V,()=>ye),s(B,V)});var G=t(U,!0);G.nodeValue="  ";var K=t(G);w(K,()=>r().editing_project&&r().editing_project_data||!r().selected_project_data,B=>{var V=Gl(),j=l(V);Wl(j,{get app(){return r()}}),n(V),pe(3,V,()=>ye),s(B,V)});var W=t(t(K,!0)),F=l(W),P=l(F);l(P),n(P);var A=t(t(P,!0));dn(A,{});var Q=t(t(A,!0)),q=l(Q);Kt(q,{get volume(){return r().volume},set volume(B){r().volume=B}}),n(Q);var S=t(t(Q,!0));Gt(S,{get instrument(){return r().instrument},set instrument(B){r().instrument=B}});var C=t(t(S,!0)),E=t(t(C,!0));Xt(E,{get midi_state(){return r()}}),n(F),n(W),n(R),pe(3,W,()=>ye),s(N,R)});var X=t(t(J,!0)),ne=l(X);w(ne,()=>r().show_trainer_help,N=>{var R=Zl(),U=l(R),G=l(U);t(l(G)),Ae(),n(G);var K=t(t(G,!0)),W=l(K),F=t(t(W,!0)),P=l(F);P.nodeValue=`your level score is the sum of mistakes in your best ${Ut}
							runs, win a ★ at 0`,n(F);var A=t(t(F,!0)),Q=t(t(A,!0));t(t(Q,!0)),n(K);var q=t(t(K,!0)),S=t(l(q));t(t(S,!0)),Ae(),n(q);var C=t(t(q,!0));t(l(C)),Ae(),n(C);var E=t(t(C,!0)),B=l(E);B.__click=[Xl,i],n(E),n(U),n(R),pe(3,R,()=>ye),s(N,R)});var Z=t(t(ne,!0)),te=l(Z);Pn(te,{get app(){return r()}}),n(Z);var se=t(Z,!0);se.nodeValue="  ";var ve=t(se);w(ve,()=>r().editing_realm&&r().editing_realm_data||a(p),N=>{var R=Ql(),U=l(R);il(U,{get app(){return r()}}),n(R),pe(3,R,()=>ye),s(N,R)}),n(X);var ie=t(t(X,!0));w(ie,()=>r().project_datas.length,N=>{var R=to(),U=l(R);w(U,()=>r().levels,W=>{var F=$l(),P=l(F);pl(P,{get app(){return r()},get levels(){return r().levels}}),n(F),pe(3,F,()=>ye),s(W,F)});var G=t(U,!0);G.nodeValue="  ";var K=t(G);w(K,()=>{var W;return r().selected_realm_id&&(r().editing_level&&r().levels||((W=r().levels)==null?void 0:W.length)===0)},W=>{var F=eo(),P=l(F),A=l(P),Q=u(()=>a(v)?a(z):a(b));Hr(A,{get editing(){return a(v)},get level_data(){return a(f)},get onsubmit(){return a(Q)},get onremove(){return a(g)},get onduplicate(){return a(h)},onplay:async(q,S)=>{S&&a(z)(q),await a(c)(q.id)},onclose:()=>a(_)(null)}),n(P),n(F),pe(2,F,()=>ye),s(W,F)}),n(R),s(N,R)}),n(T),s(o,k),oe()}je(["click"]);var no=d('<main><!> <!> <!> <div class="box"><!></div></main>');function ko(o,e){le(e,!0);const r=Jt();var i=no();ha(z=>{pa.title="Earbetter trainer"});var c=l(i);Ca(c,{onclick:()=>ka(wa+"/")});var _=t(t(c,!0));ja(_);var g=t(t(_,!0));ro(g,{app:r});var h=t(t(g,!0)),b=l(h);za(b,{}),n(h),n(i),s(o,i),oe()}export{ko as component};
