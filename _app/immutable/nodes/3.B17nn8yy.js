import"../chunks/DsnmJJEf.js";import{p as Q,f as C,t as S,b as w,c as X,s,d as i,i as d,j as se,e as B,r as n,n as de,l as ne,a as re,a3 as me,$ as G,O as L,_ as ce,a4 as ue,a5 as pe,Q as K}from"../chunks/CJaerUHp.js";import{p as R,i as Y}from"../chunks/C-YpJhoF.js";import{s as v,b as fe,d as F,e as U,i as ge,f as be,g as xe,r as he,c as ye}from"../chunks/yq475m88.js";import{M as ke,B as we,b as Ie,P as Me}from"../chunks/B077m1lY.js";import{g as Ae}from"../chunks/Bv49_G5z.js";import{m as Z,a as H,b as N,t as $e,c as Se,l as Be,d as Ce,p as Ee,e as ee,f as Pe,o as Te,g as te,h as je,j as De,k as Fe,n as ae,q as He,w as Ne}from"../chunks/1gEw6I4J.js";import{b as O,I as Oe,V as Re,a as Ve}from"../chunks/mg-1psfP.js";import{H as We}from"../chunks/9h-00wla.js";import{F as qe}from"../chunks/SeRD_1VY.js";import{A as ze}from"../chunks/CFnVj1PO.js";var Ge=C("<div><!></div>"),Ke=C('<div><div class="box row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="range"/> <input type="number"/></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="range"/> <input type="number"/></label></div> <!></div>');function Qe(I,m){Q(m,!0);let e=R(m,"min_note",15),b=R(m,"max_note",15);const x=se(()=>e()>b()?"note min cannot be larger than the max":!1);var c=Ke();let o;var u=i(c),y=i(u),k=s(i(y),2),p=i(k,!0);n(k);var r=s(k,2);F(r),v(r,"step",1);var a=s(r,2);F(a),v(a,"step",1),n(y);var h=s(y,2),f=s(i(h),2),A=i(f,!0);n(f);var _=s(f,2);F(_),v(_,"step",1);var l=s(_,2);F(l),v(l,"step",1),n(h),n(u);var M=s(u,2);{var j=g=>{var $=Ge(),V=i($);ze(V,{status:"error",children:(E,D)=>{de();var P=ne();S(()=>B(P,d(x))),w(E,P)},$$slots:{default:!0}}),n($),$e(3,$,()=>Se),w(g,$)};Y(M,g=>{d(x)&&g(j)})}n(c),S(g=>{o=fe(c,1,"midi-range-control",null,o,g),B(p,Z[e()]),v(r,"min",H),v(r,"max",N),v(a,"min",H),v(a,"max",N),B(A,Z[b()]),v(_,"min",H),v(_,"max",N),v(l,"min",H),v(l,"max",N)},[()=>({error:!!d(x)})]),O(r,e),O(a,e),O(_,b),O(l,b),w(I,c),X()}var Xe=(I,m)=>m(Be(I.currentTarget.value)),Ye=C("<option> </option>"),Je=C("<option> <!></option>"),Le=C('<label class="text_align_center svelte-199vc6u"><div class="title">scale</div> <select></select></label> <label class="text_align_center svelte-199vc6u"><div class="title">key</div> <select></select></label>',1);function Ue(I,m){Q(m,!0);let e=R(m,"scale",15),b=R(m,"key",15);var x=Le(),c=re(x),o=s(i(c),2);o.__input=[Xe,e],U(o,20,()=>Ce,p=>p,(p,r)=>{var a=Ye(),h=i(a,!0);n(a);var f={};S(()=>{B(h,r.name),f!==(f=r.name)&&(a.value=(a.__value=r.name)??"")}),w(p,a)}),n(o);var u;ge(o),n(c);var y=s(c,2),k=s(i(y),2);U(k,20,()=>Ee,p=>p,(p,r)=>{var a=Je(),h=i(a,!0),f=s(h);{var A=l=>{var M=ne();S(()=>B(M,`/${ee[r]??""}`)),w(l,M)};Y(f,l=>{r in ee&&l(A)})}n(a);var _={};S(()=>{B(h,r),_!==(_=r)&&(a.value=(a.__value=r)??"")}),w(p,a)}),n(k),n(y),S(()=>{u!==(u=e().name)&&(o.value=(o.__value=e().name)??"",xe(o,e().name))}),be(k,b),w(I,x),X()}me(["input"]);var Ze=C('<!> <main class="svelte-3fkhg9"><!> <!> <div class="piano_wrapper svelte-3fkhg9"><!></div> <form class="width_sm panel p_md"><fieldset><!> <div class="row mb_lg"><!></div> <!></fieldset> <fieldset><!></fieldset> <fieldset class="row"><!></fieldset></form> <!></main>',1);function dt(I,m){Q(m,!0);const e=Pe.get(),b=Te({min_note:te.default(36),max_note:te.default(96)}),x="piano",c=je(x,()=>b.parse({}),b.parse);let o=G(L(c.min_note)),u=G(L(c.max_note));const y=()=>({min_note:d(o),max_note:d(u)});ce(()=>De(x,y()));const p=Fe.get(),{playing_notes:r}=e;let a=G(void 0);const h=20,f=(t,T=null)=>{(!e.enabled_notes||e.enabled_notes.has(t))&&He(e,p(),t,Ne(e.volume,T),e.instrument)};var A=Ze();ue(t=>{pe.title="Earbetter: piano"});var _=re(A);ke(_,{get midi_access(){return e.midi_access},onnotestart:(t,T)=>f(t,T),onnotestop:t=>ae(t)});var l=s(_,2),M=i(l);we(M,{onclick:()=>Ae(he("/"))});var j=s(M,2);We(j);var g=s(j,2);ye(g,"",{},{padding:"20px"});var $=i(g);{var V=t=>{{let T=se(()=>d(a)-h*2);Me(t,{get width(){return d(T)},get min_note(){return d(o)},get max_note(){return d(u)},get pressed_keys(){return r},get enabled_notes(){return e.enabled_notes},onpress:z=>f(z),onrelease:z=>ae(z),middle_c_label:!0,allow_sticking:!0})}};Y($,t=>{d(a)&&t(V)})}n(g);var E=s(g,2),D=i(E),P=i(D);Oe(P,{get instrument(){return e.instrument},set instrument(t){e.instrument=t}});var W=s(P,2),ie=i(W);Ue(ie,{get scale(){return e.scale},set scale(t){e.scale=t},get key(){return e.key},set key(t){e.key=t}}),n(W);var oe=s(W,2);Re(oe,{get volume(){return e.volume},set volume(t){e.volume=t}}),n(D);var q=s(D,2),le=i(q);Ve(le,{get midi_state(){return e}}),n(q);var J=s(q,2),_e=i(J);Qe(_e,{get min_note(){return d(o)},set min_note(t){K(o,t,!0)},get max_note(){return d(u)},set max_note(t){K(u,t,!0)}}),n(J),n(E);var ve=s(E,2);qe(ve,{}),n(l),Ie(l,"clientWidth",t=>K(a,t)),w(I,A),X()}export{dt as component};
