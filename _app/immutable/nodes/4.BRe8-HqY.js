import{h as xe,b as me,a as _,t as y,e as E,d as zt,i as Zt}from"../chunks/disclose-version.BKNlT-YU.js";import{p as re,a1 as S,f as ye,c as s,r as o,s as i,t as B,g as t,a as ne,k as v,d,$ as Le,n as Ee,ap as kt,a8 as $t,a3 as ea}from"../chunks/index-client.BoyXeee0.js";import{g as ta,b as aa}from"../chunks/entry.DoDRAIkj.js";import{H as la}from"../chunks/Header.Cq7B4YxL.js";import{m as ra,F as na}from"../chunks/Footer.CMs43niJ.js";import{J as qt,Q as it,d as It,l as ia,R as St,T as oa,K as sa,j as Tt,k as ot,p as _a,U as st,W as At,n as Pt,w as Et,X as ca,f as Lt,a as Ye,b as Ge,t as he,Y as da,Z as Qe,m as xt,c as pe,_ as Ze,M as Mt,$ as $e,a0 as Dt,a1 as va,s as Ot,a2 as ua}from"../chunks/index.hvl88Cid.js";import{p as X,a as C,i as k}from"../chunks/props.D3HXCBXF.js";import{l as ma,i as ga,s as ba,b as fe,I as Rt,V as Ct,c as Nt,a as fa}from"../chunks/Init_Midi_Button.Dz0GB9NO.js";import{j as Fe,e as Me,r as ke,s as V,k as Ke,c as Ft,a as Jt,p as ha,t as ge,l as pa}from"../chunks/string.CDuhMoWR.js";import{M as Bt,P as Ht,b as ya,B as ka}from"../chunks/Back_Button.CvlWOvEL.js";import{b as ze}from"../chunks/this.DQxifKK9.js";import{D as Ne}from"../chunks/Dialog.DeqOwOk6.js";import{A as Xe}from"../chunks/Alert.C_cEhEOU.js";import{L as xa}from"../chunks/Level_Stats_Summary.CoR_0ych.js";function wa(l,e){ma(window,["resize"],()=>e(window[l]))}var wt=Object.prototype.hasOwnProperty;function jt(l,e,a){for(a of l.keys())if(qe(a,e))return a}function qe(l,e){var a,r,c;if(l===e)return!0;if(l&&e&&(a=l.constructor)===e.constructor){if(a===Date)return l.getTime()===e.getTime();if(a===RegExp)return l.toString()===e.toString();if(a===Array){if((r=l.length)===e.length)for(;r--&&qe(l[r],e[r]););return r===-1}if(a===Set){if(l.size!==e.size)return!1;for(r of l)if(c=r,c&&typeof c=="object"&&(c=jt(e,c),!c)||!e.has(c))return!1;return!0}if(a===Map){if(l.size!==e.size)return!1;for(r of l)if(c=r[0],c&&typeof c=="object"&&(c=jt(e,c),!c)||!qe(r[1],e.get(c)))return!1;return!0}if(a===ArrayBuffer)l=new Uint8Array(l),e=new Uint8Array(e);else if(a===DataView){if((r=l.byteLength)===e.byteLength)for(;r--&&l.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(l)){if((r=l.byteLength)===e.byteLength)for(;r--&&l[r]===e[r];);return r===-1}if(!a||typeof l=="object"){r=0;for(a in l)if(wt.call(l,a)&&++r&&!wt.call(e,a)||!(a in e)||!qe(l[a],e[a]))return!1;return Object.keys(e).length===r}}return l!==l&&e!==e}var ja=(l,e)=>v(e,C(l.currentTarget.value)),za=(l,e,a,r,c,n)=>{var m;return(m=e.oninput)==null?void 0:m.call(e,t(a),t(r)?{scale:c(),octaves:n()}:void 0)},qa=(l,e)=>e(ia(l.currentTarget.value)),Ia=y("<option> </option>"),Sa=y('<small><textarea class="preview width_sm panel svelte-1n8fnqy"></textarea></small> <button type="button" class="accent mb_lg">use these intervals</button> <label><div class="title text_align_center">scale</div> <select></select></label> <label><div class="title text_align_center">octaves</div> <div class="text_align_center"> </div> <input type="range"></label>',1);function Ta(l,e){re(e,!0);let a=X(e,"scale",31,()=>C(qt)),r=X(e,"octaves",15,1);const c=d(()=>oa(a(),r())),n=d(()=>it(t(c))),m=C(it(e.intervals));let p=S(C(m));const f=d(()=>(t(c),Date.now())),z=d(()=>(e.intervals,t(p),Date.now())),h=d(()=>t(f)>t(z)),u=d(()=>t(h)?t(n):t(p)),g=d(()=>St(t(u))),b=d(()=>!qe(e.intervals,t(g))),T=d(()=>!!t(g).length);var A=Sa(),L=ye(A),ie=s(L);Fe(ie),ie.__input=[ja,p],o(L);var ee=i(L,2);ee.__click=[za,e,g,h,a,r];var oe=i(ee,2),W=i(s(oe),2);ga(W,()=>a().name);var se;W.__change=[qa,a],Me(W,20,()=>It,H=>H,(H,Y)=>{var U=Ia(),J={},te=s(U,!0);o(U),B(()=>{J!==(J=Y.name)&&(U.value=(U.__value=Y.name)==null?"":Y.name),me(te,Y.name)}),_(H,U)}),o(W),o(oe);var _e=i(oe,2),ae=i(s(_e),2),N=s(ae,!0);o(ae);var F=i(ae,2);ke(F),V(F,"min",1),V(F,"max",6),o(_e),B(()=>{Ke(ie,t(u)),ee.disabled=!t(b)||!t(T),se!==(se=a().name)&&(W.value=(W.__value=a().name)==null?"":a().name,ba(W,a().name)),me(N,r())}),fe(F,r),_(l,A),ne()}xe(["input","click","change"]);var Aa=(l,e)=>{v(e,C(new Set))},Pa=(l,e,a)=>{var r;(r=e.oninput)==null||r.call(e,t(a))},Ea=y('<!> <button class="mb_lg" type="button">clear selection</button> <button type="button" class="accent">select <!> </button>',1),La=y("<option> </option>"),Ma=(l,e,a)=>e(t(a)),Da=y('<button type="button"> </button>'),Oa=(l,e)=>e(l.currentTarget.value),Ra=y('<!> <div class="notes_input pt_lg svelte-18obm47"><!> <div class="piano_wrapper svelte-18obm47"><!></div> <section class="box"><label class="mb_lg"><div class="title text_align_center">key</div> <select></select></label> <div class="scales mb_lg svelte-18obm47"></div> <!> <div class="notes width_sm svelte-18obm47"><blockquote class="panel my_lg"><textarea></textarea></blockquote></div></section> <form class="width_sm panel p_md"><fieldset><!> <!></fieldset> <fieldset><!></fieldset></form></div>',1);function Ca(l,e){re(e,!0);const a=w=>{var I=Ea(),K=ye(I);Jt(K,()=>e.before_buttons);var be=i(K,2);be.__click=[Aa,n];var we=i(be,2);we.__click=[Pa,e,m];var Ie=i(s(we));k(Ie,()=>t(f)===0,Se=>{var je=E("all");_(Se,je)},Se=>{var je=E();B(()=>me(je,t(f))),_(Se,je)});var Je=i(Ie);B(()=>me(Je,` tonic${ha(t(f))??""}`)),o(we),B(()=>{be.disabled=t(f)===0,we.disabled=!t(g)}),_(w,I)},r=X(e,"audio_state",7),{playing_notes:c}=r();let n=S(void 0);const m=d(()=>t(n)&&Array.from(t(n)).sort((w,I)=>w-I)),p=d(()=>t(n)??e.notes),f=d(()=>t(p).size),z=d(()=>t(m)&&st(t(m))),h=w=>{v(n,C(new Set(At(w))))},u=d(()=>st(Array.from(e.notes).sort((w,I)=>w-I))),g=d(()=>!!t(m)&&t(z)!==t(u)),b=w=>{const I=new Set(t(p));I.has(w)?I.delete(w):I.add(w),v(n,C(I))};let T=S(C(sa));const A=Tt.get();let L=S(void 0);const ie=20,ee=(w,I=null)=>{Pt(r(),A(),w,Et(r().volume,I),r().instrument)},oe=w=>{const I=ca(w,t(T),e.min_note,e.max_note);if(!t(n)||!t(m)){v(n,C(I));return}let K=!0;for(const we of I)if(!t(n).has(we)){K=!1;break}const be=K?t(m).filter(we=>!I.has(we)):t(m).concat(Array.from(I));v(n,C(new Set(be)))};var W=Ra(),se=ye(W);Bt(se,{get midi_access(){return r().midi_access},onnotestart:(w,I)=>ee(w,I),onnotestop:w=>ot(w)});var _e=i(se,2),ae=s(_e);a(ae);var N=i(ae,2);Ft(N,"padding",`${ie}px`);var F=s(N);k(F,()=>t(L),w=>{var I=d(()=>t(L)-ie*5);Ht(w,{get width(){return t(I)},get min_note(){return e.min_note},get max_note(){return e.max_note},max_height:300,pressed_keys:c,get highlighted_keys(){return t(p)},middle_c_label:!0,allow_sticking:!0,onpress:K=>{b(K),ee(K)},onrelease:K=>{ot(K)}})}),o(N);var H=i(N,2),Y=s(H),U=i(s(Y),2);Me(U,20,()=>_a,w=>w,(w,I)=>{var K=La(),be={},we=s(K,!0);o(K),B(()=>{be!==(be=I)&&(K.value=(K.__value=I)==null?"":I),me(we,I)}),_(w,K)}),o(U),o(Y);var J=i(Y,2);Me(J,21,()=>It,w=>w.name,(w,I)=>{var K=Da();K.__click=[Ma,oe,I];var be=s(K,!0);o(K),B(()=>me(be,t(I).name)),_(w,K)}),o(J);var te=i(J,2);a(te);var M=i(te,2),P=s(M),Q=s(P);Fe(Q),Q.__change=[Oa,h],o(P),o(M),o(H);var q=i(H,2),j=s(q),D=s(j);Rt(D,{get instrument(){return r().instrument},set instrument(w){r().instrument=w}});var R=i(D,2);Ct(R,{get volume(){return r().volume},set volume(w){r().volume=w}}),o(j);var G=i(j,2),Z=s(G);Nt(Z,{get midi_state(){return r()}}),o(G),o(q),o(_e),B(()=>Ke(Q,t(z))),wa("innerWidth",w=>v(L,C(w))),fa(U,()=>t(T),w=>v(T,w)),_(l,W),ne()}xe(["click","change"]);var Na=(l,e)=>{var a;navigator.clipboard.writeText(e.text),(a=e.oncopy)==null||a.call(e)},Fa=y('<button type="button" class="my_lg"><!></button>');function _t(l,e){re(e,!0);var a=Fa();a.__click=[Na,e];var r=s(a);k(r,()=>e.children,c=>{var n=zt(),m=ye(n);Jt(m,()=>e.children),_(c,n)},c=>{var n=E("copy to clipboard");_(c,n)}),o(a),_(l,a),ne()}xe(["click"]);const Ja=(l,e,a,r,c)=>{v(e,"");try{const n=JSON.parse(t(a));n&&!n.id&&(n.id=da());const m=Qe.parse(n);r.onsubmit(m)}catch(n){console.error("failed to import data",n),v(e,C(n.message||"unknown error"))}v(c,!1)},Ba=(l,e,a,r,c)=>{v(e,C(v(a,C(JSON.stringify(r()))))),v(c,!0)};var Ha=(l,e)=>v(e,St(l.currentTarget.value)),Ua=(l,e)=>v(e,!0),Va=y("<!> <br>",1),Wa=(l,e)=>v(e,At(l.currentTarget.value)),Ya=(l,e)=>v(e,!0),Ga=(l,e,a)=>e.onsubmit(a()),Ka=(l,e)=>v(e,!t(e)),Xa=(l,e,a)=>{v(e,!1),a.onremove(a.level_data.id)},Qa=y('<div class="pb_md"><button type="button" class="color_c w_100 svelte-h4qokl">✕ confirm remove</button></div>'),Za=(l,e)=>e.onduplicate(e.level_data.id),$a=y('<button type="button" class="svelte-h4qokl">duplicate level</button>'),el=y('<button type="button" class="svelte-h4qokl">remove level</button> <!> <!>',1),tl=y("<pre> </pre>"),al=y('<div class="overflow_x_auto"><!></div>'),ll=(l,e,a,r)=>e.onplay(t(a)?r():e.level_data,t(a)),rl=y('<button type="button" class="svelte-h4qokl">play!</button>'),nl=(l,e)=>e.onclose(e.level_data.id),il=y('<button type="button" class="svelte-h4qokl"><!></button>'),ol=y('<div class="importing bg shadow_d_xl p_xl width_md box svelte-h4qokl"><h2 class="my_0">import level data</h2> <!> <textarea class="svelte-h4qokl"></textarea> <button type="button" class="svelte-h4qokl">import project data</button></div>'),sl=y('<div class="bg shadow_d_xl p_xl width_md box"><h2 class="my_0">pick intervals</h2> <!> <button type="button" class="svelte-h4qokl">cancel</button></div>'),_l=y('<button type="button" class="mb_lg svelte-h4qokl">cancel</button>'),cl=y('<div class="bg shadow_d_xl py_xl box"><h2 class="my_0">pick tonics</h2> <!></div>'),dl=y(`<form class="level_def_form w_100"><header><h2 class="my_0"><!></h2></header> <div class="fields svelte-h4qokl"><fieldset><label><div class="title">name</div> <input></label></fieldset> <fieldset><label class="mb_0" title="the semitones to include relative to the tonic"><div class="title">intervals</div> <input></label> <button type="button" class="svelte-h4qokl">pick intervals</button> <details><summary>about <code>intervals</code></summary> <p><code>intervals</code> is a comma-separated list of numbers representing the <a href="https://wikipedia.org/wiki/Interval_(music)">musical intervals</a> used in the
					level, aka the number of piano keys (<a href="https://wikipedia.org/wiki/Semitone">semitones</a>) separating each note from the <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> (see below)</p> <p>for example, to practice distinguishing between the <a href="https://wikipedia.org/wiki/Perfect_fourth">perfect fourth</a> and <a href="https://wikipedia.org/wiki/Perfect_fifth">perfect fifth</a>, enter "<code>5, 7</code>"</p> <p>negative numbers are allowed</p></details></fieldset> <fieldset><label title="the number of trials per level"><div class="title">trial count</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset><label title="the number of notes per trial"><div class="title">sequence length</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset class="row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="number"> <input type="range"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="number"> <input type="range"></label></fieldset> <!> <fieldset><label class="mb_0" title="the possible starting notes for each trial"><div class="title">tonics</div> <input placeholder="all"></label> <button type="button" class="svelte-h4qokl">pick tonics</button> <details><summary>about <code>tonics</code></summary> <p>The <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> is like the "base" or "home"
					note, and for our purposes it's always the first note played in a trial. Other notes in the
					trial are calculated from the tonic and intervals. (see above)</p></details></fieldset> <button type="button" class="accent svelte-h4qokl"><!></button> <!> <button type="button" class="svelte-h4qokl"><!></button> <!> <!> <!></div></form> <!> <!> <!>`,1);function vl(l,e){re(e,!0);const a=X(e,"editing",3,!1),r=Lt.get();let c=S(!1),n=S(C(e.level_data.name));const m=d(()=>{var x;return(x=t(n))==null?void 0:x.trim()});let p=S(e.level_data.intervals),f=S(e.level_data.tonics);const z=d(()=>t(f)?t(f).filter(x=>x>=t(g)&&x<=t(b)):t(f));let h=S(C(e.level_data.trial_count)),u=S(C(e.level_data.sequence_length)),g=S(C(e.level_data.min_note)),b=S(C(e.level_data.max_note));const T=()=>Qe.parse({id:e.level_data.id,name:t(m),intervals:t(p),tonics:t(z),trial_count:t(h),sequence_length:t(u),min_note:t(g),max_note:t(b)});Le(()=>{v(n,C(e.level_data.name)),v(p,e.level_data.intervals),v(f,e.level_data.tonics),v(h,C(e.level_data.trial_count)),v(u,C(e.level_data.sequence_length)),v(g,C(e.level_data.min_note)),v(b,C(e.level_data.max_note))});const A=d(()=>t(m)!==e.level_data.name||t(h)!==e.level_data.trial_count||t(u)!==e.level_data.sequence_length||t(g)!==e.level_data.min_note||t(b)!==e.level_data.max_note||!qe(t(p),e.level_data.intervals)||!qe(t(z),e.level_data.tonics));let L=S(!1),ie=S(!1),ee=S(!1),oe=S(""),W=S("");const se=d(()=>t(oe)!==t(W));let _e=S("");Le(()=>{e.level_data,v(_e,"")});let ae=S(void 0),N=S(void 0),F=S(void 0),H=S(void 0);const Y=d(()=>t(f)&&new Set(t(f)));let U=S(C(qt)),J=S(1),te=S(void 0);const M=d(()=>t(g)>=t(b));var P=dl(),Q=ye(P),q=s(Q),j=s(q),D=s(j);k(D,a,x=>{var O=E("editing level");_(x,O)},x=>{var O=E("create a new level");_(x,O)}),o(j),o(q);var R=i(q,2),G=s(R),Z=s(G),w=i(s(Z),2);ke(w),o(Z),o(G);var I=i(G,2),K=s(I),be=i(s(K),2);ze(be,x=>v(F,x),()=>t(F)),ke(be),B(()=>Ke(be,it(t(p)))),be.__change=[Ha,p],o(K);var we=i(K,2);we.__click=[Ua,ie],Ee(2),o(I);var Ie=i(I,2),Je=s(Ie),Se=i(s(Je),2),je=s(Se);ke(je),V(je,"min",1);var Be=i(je,2);ke(Be),V(Be,"min",1),V(Be,"max",20),o(Se),o(Je),o(Ie);var et=i(Ie,2),ct=s(et),dt=i(s(ct),2),He=s(dt);ke(He),V(He,"min",2);var Ue=i(He,2);ke(Ue),V(Ue,"min",2),V(Ue,"max",16),o(dt),o(ct),o(et);var tt=i(et,2),at=s(tt),lt=i(s(at),2),Ut=s(lt,!0);o(lt);var Te=i(lt,2);ke(Te),V(Te,"step",1),V(Te,"min",Ye),V(Te,"max",Ge);var De=i(Te,2);ke(De),V(De,"step",1),V(De,"min",Ye),V(De,"max",Ge),o(at);var vt=i(at,2),rt=i(s(vt),2),Vt=s(rt,!0);o(rt);var Ae=i(rt,2);ke(Ae),V(Ae,"step",1),V(Ae,"min",Ye),V(Ae,"max",Ge);var Oe=i(Ae,2);ke(Oe),V(Oe,"step",1),V(Oe,"min",Ye),V(Oe,"max",Ge),o(vt),o(tt);var ut=i(tt,2);k(ut,()=>t(M),x=>{Xe(x,{status:"error",children:(O,le)=>{Ee();var $=E("the lowest note must be lower than the highest");_(O,$)},$$slots:{default:!0}})},x=>{var O=Va(),le=ye(O),$=d(()=>t(te)??0);Ht(le,{get width(){return t($)},max_height:50,get min_note(){return t(g)},get max_note(){return t(b)},get highlighted_keys(){return t(Y)},clickable:!1,middle_c_label:!0}),Ee(2),_(x,O)});var Ve=i(ut,2),nt=s(Ve),We=i(s(nt),2);ze(We,x=>v(H,x),()=>t(H)),ke(We),B(()=>Ke(We,st(t(f)))),We.__change=[Wa,f],o(nt);var Wt=i(nt,2);Wt.__click=[Ya,ee],Ee(2),o(Ve);var Re=i(Ve,2);Re.__click=[Ga,e,T];var Yt=s(Re);k(Yt,a,x=>{var O=E("save changes to level");_(x,O)},x=>{var O=E("create level");_(x,O)}),o(Re);var mt=i(Re,2);k(mt,()=>e.onremove&&a(),x=>{var O=el(),le=ye(O);le.__click=[Ka,c];var $=i(le,2);k($,()=>t(c),de=>{var ve=Qa(),ue=s(ve);ue.__click=[Xa,c,e],o(ve),he(3,ve,()=>pe),_(de,ve)});var ce=i($,2);k(ce,()=>e.onduplicate,de=>{var ve=$a();ve.__click=[Za,e],_(de,ve)}),_(x,O)});var Ce=i(mt,2);ze(Ce,x=>v(N,x),()=>t(N)),Ce.__click=[Ba,oe,W,T,L];var Gt=s(Ce);k(Gt,a,x=>{var O=E("import/export data");_(x,O)},x=>{var O=E("import data");_(x,O)}),o(Ce);var gt=i(Ce,2);k(gt,()=>t(_e),x=>{var O=al(),le=s(O);Xe(le,{status:"error",children:($,ce)=>{var de=tl(),ve=s(de,!0);o(de),B(()=>me(ve,t(_e))),_($,de)},$$slots:{default:!0}}),o(O),_(x,O)});var bt=i(gt,2);k(bt,()=>e.onplay&&a(),x=>{var O=rl();O.__click=[ll,e,A,T],_(x,O)});var Kt=i(bt,2);k(Kt,()=>e.onclose&&a(),x=>{var O=il();O.__click=[nl,e];var le=s(O);k(le,()=>t(A),$=>{var ce=E("discard changes and stop editing");_($,ce)},$=>{var ce=E("close level editor");_($,ce)}),o(O),_(x,O)}),o(R),o(Q);var ft=i(Q,2);k(ft,()=>t(L),x=>{Ne(x,{onclose:()=>{var O;v(L,!1),(O=t(N))==null||O.focus()},children:(O,le)=>{var $=ol(),ce=i(s($),2);_t(ce,{get text(){return t(W)},oncopy:()=>{var ue;(ue=t(ae))==null||ue.select()}});var de=i(ce,2);ze(de,ue=>v(ae,ue),()=>t(ae)),Fe(de);var ve=i(de,2);ve.__click=[Ja,_e,W,e,L],o($),B(()=>{ve.disabled=!t(se),V(ve,"title",t(se)?void 0:"data has not changed")}),fe(de,()=>t(W),ue=>v(W,ue)),_(O,$)},$$slots:{default:!0}})});var ht=i(ft,2);k(ht,()=>t(ie),x=>{Ne(x,{onclose:()=>{var le;v(ie,!1),(le=t(F))==null||le.focus()},children:(le,$=kt)=>{var ce=sl(),de=i(s(ce),2);Ta(de,{get intervals(){return t(p)},get scale(){return t(U)},set scale(ue){v(U,C(ue))},get octaves(){return t(J)},set octaves(ue){v(J,C(ue))},oninput:ue=>{v(p,ue),$()()}});var ve=i(de,2);ve.__click=function(...ue){var Pe;(Pe=$())==null||Pe.apply(this,ue)},o(ce),_(le,ce)},$$slots:{default:!0}})});var Xt=i(ht,2);k(Xt,()=>t(ee),x=>{Ne(x,{onclose:()=>{var le;v(ee,!1),(le=t(H))==null||le.focus()},children:(le,$=kt)=>{var ce=cl(),de=i(s(ce),2),ve=d(()=>new Set(t(f)));Ca(de,{audio_state:r,get notes(){return t(ve)},get min_note(){return t(g)},get max_note(){return t(b)},oninput:Pe=>{v(f,Pe),$()()},before_buttons:Pe=>{var pt=_l();pt.__click=function(...Qt){var yt;(yt=$())==null||yt.apply(this,Qt)},_(Pe,pt)},$$slots:{before_buttons:!0}}),o(ce),_(le,ce)},$$slots:{default:!0}})}),B(()=>{me(Ut,xt[t(g)]),me(Vt,xt[t(b)]),Re.disabled=a()&&!t(A)||t(M)}),fe(w,()=>t(n),x=>v(n,x)),fe(je,()=>t(h),x=>v(h,x)),fe(Be,()=>t(h),x=>v(h,x)),fe(He,()=>t(u),x=>v(u,x)),fe(Ue,()=>t(u),x=>v(u,x)),fe(Te,()=>t(g),x=>v(g,x)),fe(De,()=>t(g),x=>v(g,x)),fe(Ae,()=>t(b),x=>v(b,x)),fe(Oe,()=>t(b),x=>v(b,x)),ya(Ve,"clientWidth",x=>v(te,x)),_(l,P),ne()}xe(["change","click"]);var ul=(l,e,a)=>e()(a.project.id),ml=y('<button type="button" class="flex_1"> </button>'),gl=(l,e,a,r,c)=>{var n,m;return t(e)?(n=a())==null?void 0:n(r.project.id):(m=c())==null?void 0:m(r.project_data??r.load(r.project.id))},bl=y('<button type="button" class="icon_button plain_button size_xl deselectable svelte-12y7az0"><!></button>'),fl=(l,e)=>v(e,!t(e)),hl=y('<button type="button" class="icon_button plain_button size_xl svelte-12y7az0"><!></button>'),pl=y('<li class="project_item svelte-12y7az0"><!>  <!> <!></li>');function yl(l,e){re(e,!0);const a=X(e,"select",3,null),r=X(e,"edit",3,null),c=X(e,"remove",3,null);let n=S(!1);var m=pl(),p=s(m);k(p,a,h=>{var u=ml();u.__click=[ul,a,e];var g=s(u,!0);o(u),B(()=>{ge(u,"selected",e.selected),me(g,e.project.name)}),_(h,u)});var f=i(p,2);k(f,()=>t(n)&&c()||!t(n)&&r(),h=>{var u=bl();u.__click=[gl,n,c,e,r];var g=s(u);k(g,()=>t(n),b=>{var T=E("✕");_(b,T)},b=>{var T=E("✎");_(b,T)}),o(u),B(()=>{V(u,"title",t(n)?"remove project":"edit project"),ge(u,"selected",e.selected&&!t(n)&&e.editing),ge(u,"color_c",t(n))}),_(h,u)});var z=i(f,2);k(z,c,h=>{var u=hl();u.__click=[fl,n];var g=s(u);k(g,()=>t(n),b=>{var T=E("×");_(b,T)},b=>{var T=E("✕");_(b,T)}),o(u),B(()=>V(u,"title",t(n)?"cancel removing":"remove project")),_(h,u)}),o(m),B(()=>ge(m,"selected",e.selected)),he(3,m,()=>pe),_(l,m),ne()}xe(["click"]);var kl=y('<menu class="unstyled width_sm mb_0"></menu>');function xl(l,e){re(e,!0);const a=X(e,"selected_project_id",3,null),r=X(e,"editing_project_id",3,null),c=X(e,"projects",19,()=>[]),n=X(e,"project_datas",19,()=>[]);var m=kl();Me(m,21,c,p=>p.id,(p,f)=>{var z=d(()=>n().find(g=>g.id===t(f).id)),h=d(()=>t(f).id===a()),u=d(()=>t(f).id===r());yl(p,{get project(){return t(f)},get project_data(){return t(z)},get load(){return e.load_project},get select(){return e.select_project},get edit(){return e.edit_project},get remove(){return e.remove_project},get selected(){return t(h)},get editing(){return t(u)}})}),o(m),_(l,m),ne()}var wl=(l,e,a,r)=>{t(e)?a().editing_project=!1:t(r)(Ze.parse({}))},jl=y('<div class="panel p_md"><header><h2 class="my_0">projects</h2></header> <!> <button type="button" class="w_100 mt_md deselectable">create a new project</button></div>');function zl(l,e){re(e,!0);const a=X(e,"app",7),r=d(()=>a().load_project),c=d(()=>a().select_project),n=d(()=>a().edit_project),m=d(()=>a().remove_project),p=d(()=>a().editing_project&&a().selected_project_id!==a().editing_project_id),f=d(()=>a().app_data),z=d(()=>t(f).projects);var h=jl(),u=i(s(h),2),g=d(()=>a().editing_project?a().editing_project_id:null);xl(u,{get selected_project_id(){return a().selected_project_id},get editing_project_id(){return t(g)},get projects(){return t(z)},get project_datas(){return a().project_datas},get load_project(){return t(r)},get select_project(){return t(c)},edit_project:T=>t(n)(T===a().editing_project_data&&a().editing_project?null:T),get remove_project(){return t(m)}});var b=i(u,2);b.__click=[wl,p,a,n],o(h),B(()=>ge(b,"selected",t(p))),_(l,h),ne()}xe(["click"]);var ql=(l,e)=>e.toggle(),Il=y(`<aside>devices with smaller screens aren't well supported yet, see <a href="https://github.com/ryanatkn/earbetter/issues/2">issue #2</a></aside> <table><tbody><tr><td class="svelte-1gwge1y"><code>Spacebar</code></td><td class="svelte-1gwge1y">replay trial</td></tr><tr><td class="svelte-1gwge1y"><code>r</code></td><td class="svelte-1gwge1y">restart level</td></tr><tr><td class="svelte-1gwge1y"><code>Escape</code></td><td class="svelte-1gwge1y"><button type="button" class="inline">toggle main menu</button></td></tr><tr><td class="svelte-1gwge1y"><code>1 to 4</code></td><td class="svelte-1gwge1y">set instrument</td></tr><tr><td class="svelte-1gwge1y"><code>c</code></td><td class="svelte-1gwge1y">connect MIDI</td></tr><tr><td class="svelte-1gwge1y"><code>up/down arrows</code></td><td class="svelte-1gwge1y">adjust volume</td></tr></tbody></table>`,1);function Sl(l,e){re(e,!0);const a=ra.get();var r=Il(),c=i(ye(r),2),n=s(c),m=i(s(n),2),p=i(s(m)),f=s(p);f.__click=[ql,a],Ft(f,"min-width","172px"),o(p),o(m),Ee(3),o(n),o(c),_(l,r),ne()}xe(["click"]);var Tl=y('<div class="realm_stats_summary svelte-1mwdoug" title="you performed flawlessly in every level of this realm!">★</div>');function Al(l,e){re(e,!0);const a=d(()=>e.realm_data.levels.map(h=>e.level_stats.mistakes[h.id]??[])),r=d(()=>t(a).reduce((h,u)=>h+u.length,0)),c=d(()=>Mt*t(a).length),n=d(()=>!!t(r)&&t(r)>=t(c)),m=d(()=>t(n)?t(a).reduce((h,u)=>h+u.reduce((g,b)=>g+b,0),0):void 0),p=d(()=>t(m)===0);var f=zt(),z=ye(f);k(z,()=>t(p),h=>{var u=Tl();_(h,u)}),_(l,f),ne()}var Pl=(l,e,a)=>e()(a.realm_data.id),El=y('<button type="button" class="realm_button svelte-1joa4ch"> </button>'),Ll=(l,e,a,r,c)=>{var n,m;return t(e)?(n=a())==null?void 0:n(r.realm_data.id):(m=c())==null?void 0:m(r.realm_data)},Ml=y('<button type="button" class="icon_button plain_button size_xl deselectable svelte-1joa4ch"><!></button>'),Dl=(l,e)=>v(e,!t(e)),Ol=y('<button type="button" class="icon_button plain_button size_xl svelte-1joa4ch"><!></button>'),Rl=y('<li class="realm_item svelte-1joa4ch"><!> <!>  <!> <!></li>');function Cl(l,e){re(e,!0);const a=X(e,"select",3,null),r=X(e,"edit",3,null),c=X(e,"remove",3,null);let n=S(!1);const m=d(()=>e.project_data.level_stats);var p=Rl(),f=s(p);k(f,()=>t(m),g=>{Al(g,{get realm_data(){return e.realm_data},get level_stats(){return t(m)}})});var z=i(f,2);k(z,a,g=>{var b=El();b.__click=[Pl,a,e];var T=s(b,!0);o(b),B(()=>{ge(b,"selected",e.selected),me(T,e.realm_data.name)}),_(g,b)});var h=i(z,2);k(h,()=>t(n)&&c()||!t(n)&&r(),g=>{var b=Ml();b.__click=[Ll,n,c,e,r];var T=s(b);k(T,()=>t(n),A=>{var L=E("✕");_(A,L)},A=>{var L=E("✎");_(A,L)}),o(b),B(()=>{V(b,"title",t(n)?"remove realm":e.editing?"stop editing realm":"edit realm"),ge(b,"selected",e.selected&&!t(n)&&e.editing),ge(b,"color_c",t(n))}),_(g,b)});var u=i(h,2);k(u,c,g=>{var b=Ol();b.__click=[Dl,n];var T=s(b);k(T,()=>t(n),A=>{var L=E("×");_(A,L)},A=>{var L=E("✕");_(A,L)}),o(b),B(()=>V(b,"title",t(n)?"cancel removing":"remove realm")),_(g,b)}),o(p),B(()=>ge(p,"selected",e.selected)),he(3,p,()=>pe),_(l,p),ne()}xe(["click"]);var Nl=y('<menu class="unstyled width_sm mb_0"></menu>');function Fl(l,e){re(e,!0);const a=X(e,"selected_realm_data",3,null),r=X(e,"editing_realm_id",3,null),c=X(e,"realms",19,()=>[]),n=d(()=>new Map(c().map(f=>[f.id,f]))),m=f=>t(n).get(f);var p=Nl();Me(p,21,c,f=>f.id,(f,z)=>{var h=d(()=>m(t(z).id)),u=d(()=>{var b;return t(z).id===((b=a())==null?void 0:b.id)}),g=d(()=>t(z).id===r());Cl(f,{get realm_data(){return t(h)},get project_data(){return e.project_data},get select(){return e.select_realm},get edit(){return e.edit_realm},get remove(){return e.remove_realm},get selected(){return t(u)},get editing(){return t(g)}})}),o(p),_(l,p),ne()}const Jl=(l,e,a,r,c)=>{var n;t(e)?(n=document.querySelector(".realm_def_form input"))==null||n.focus():t(a)?r().editing_realm=!1:t(c)($e.parse({}))};var Bl=y("<div><!></div>"),Hl=y('<div class="panel p_md"><header><h2 class="my_0">realms</h2></header> <!> <button type="button">create a new realm</button></div>');function Ul(l,e){re(e,!0);const a=X(e,"app",7),r=d(()=>a().select_realm),c=d(()=>a().edit_realm),n=d(()=>a().remove_realm),m=d(()=>{var u;return a().editing_realm&&!!a().editing_realm_data&&((u=a().selected_realm_data)==null?void 0:u.id)!==a().editing_realm_data.id}),p=d(()=>{var u;return!((u=a().realms)!=null&&u.length)});var f=Hl(),z=i(s(f),2);k(z,()=>a().realms&&a().selected_project_data,u=>{var g=Bl(),b=s(g),T=d(()=>a().editing_realm?a().editing_realm_id:null);Fl(b,{get project_data(){return a().selected_project_data},get selected_realm_data(){return a().selected_realm_data},get realms(){return a().realms},get editing_realm_id(){return t(T)},get select_realm(){return t(r)},edit_realm:A=>t(c)(A===a().editing_realm_data&&a().editing_realm?null:A),get remove_realm(){return t(n)}}),o(g),he(3,g,()=>pe),_(u,g)});var h=i(z,2);h.__click=[Jl,p,m,a,c],o(f),B(()=>{pa(h,`${(t(p)?void 0:"deselectable")??""} svelte-100yq62`),ge(h,"selected",t(m)||t(p))}),_(l,f),ne()}xe(["click"]);const Vl=(l,e,a,r,c)=>{v(e,"");try{const n=JSON.parse(t(a));n&&!n.id&&(n.id=va());const m=$e.parse(n);r.onsubmit(m)}catch(n){console.error("failed to import data",n),v(e,C(n.message||"unknown error"))}v(c,!1)},Wl=(l,e,a,r,c)=>{v(e,C(v(a,C(JSON.stringify(r()))))),v(c,!0)};var Yl=y('<div class="importing bg shadow_d_xl p_xl width_md box svelte-1g446ss"><h2 class="my_0">import realm data</h2> <!> <textarea class="svelte-1g446ss"></textarea> <button type="button" class="svelte-1g446ss">import realm data</button></div>'),Gl=(l,e,a)=>{l.key==="Enter"&&(Ot(l),e.onsubmit(a()))},Kl=(l,e,a)=>e.onsubmit(a()),Xl=(l,e)=>v(e,!t(e)),Ql=(l,e,a)=>{v(e,!1),a.onremove(a.realm_data.id)},Zl=y('<div class="pb_md"><button type="button" class="color_c w_100 svelte-1g446ss">✕ confirm remove</button></div>'),$l=(l,e)=>e.onduplicate(e.realm_data.id),er=y('<button type="button" class="svelte-1g446ss">duplicate realm</button>'),tr=y('<button type="button" class="svelte-1g446ss">remove realm</button> <!> <!>',1),ar=(l,e)=>v(e,!t(e)),lr=(l,e,a)=>{v(e,!1),a.onsubmit(Dt().realms)},rr=y('<div><button type="button" class="w_100 svelte-1g446ss"> </button></div>'),nr=y('<button type="button" class="svelte-1g446ss">create default realms</button> <!>',1),ir=y("<pre> </pre>"),or=y('<div class="message-wrapper svelte-1g446ss"><!></div>'),sr=(l,e)=>e.onclose(e.realm_data.id),_r=y('<button class="w_100 svelte-1g446ss" type="button"><!></button>'),cr=y('<!> <form class="realm_def_form"><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent svelte-1g446ss"><!></button> <!> <button type="button" class="svelte-1g446ss"><!></button> <!> <!> <!></form>',1);function dr(l,e){re(e,!0);const a=X(e,"editing",3,!1);let r=S(!1),c=S(C(e.realm_data.name));const n=d(()=>{var q;return(q=t(c))==null?void 0:q.trim()}),m=()=>$e.parse({id:e.realm_data.id,name:t(n),levels:e.realm_data.levels});Le(()=>{console.log("set_realm_data",e.realm_data),v(c,C(e.realm_data.name))});const p=d(()=>t(n)!==e.realm_data.name);let f=S(!1),z=S(""),h=S("");const u=d(()=>t(z)!==t(h));let g=S("");Le(()=>{e.realm_data,v(g,"")});let b=S(void 0),T=S(void 0);const A=Dt().realms;let L=S(!1);var ie=cr(),ee=ye(ie);k(ee,()=>t(f),q=>{Ne(q,{onclose:()=>{var j;v(f,!1),(j=t(T))==null||j.focus()},children:(j,D)=>{var R=Yl(),G=i(s(R),2);_t(G,{get text(){return t(h)},oncopy:()=>{var I;(I=t(b))==null||I.select()}});var Z=i(G,2);ze(Z,I=>v(b,I),()=>t(b)),Fe(Z);var w=i(Z,2);w.__click=[Vl,g,h,e,f],o(R),B(()=>{w.disabled=!t(u),V(w,"title",t(u)?void 0:"data has not changed")}),fe(Z,()=>t(h),I=>v(h,I)),_(j,R)},$$slots:{default:!0}})});var oe=i(ee,2),W=s(oe),se=s(W),_e=s(se);k(_e,a,q=>{var j=E("editing realm");_(q,j)},q=>{var j=E("create a new realm");_(q,j)}),o(se),o(W);var ae=i(W,2),N=s(ae),F=i(s(N),2);ke(F),F.__keydown=[Gl,e,m],o(N),o(ae);var H=i(ae,2);H.__click=[Kl,e,m];var Y=s(H);k(Y,a,q=>{var j=E("save changes to realm");_(q,j)},q=>{var j=E("create realm");_(q,j)}),o(H);var U=i(H,2);k(U,()=>e.onremove&&a(),q=>{var j=tr(),D=ye(j);D.__click=[Xl,r];var R=i(D,2);k(R,()=>t(r),Z=>{var w=Zl(),I=s(w);I.__click=[Ql,r,e],o(w),he(3,w,()=>pe),_(Z,w)});var G=i(R,2);k(G,()=>e.onduplicate,Z=>{var w=er();w.__click=[$l,e],_(Z,w)}),_(q,j)});var J=i(U,2);ze(J,q=>v(T,q),()=>t(T)),J.__click=[Wl,z,h,m,f];var te=s(J);k(te,a,q=>{var j=E("import/export data");_(q,j)},q=>{var j=E("import data");_(q,j)}),o(J);var M=i(J,2);k(M,()=>!a(),q=>{var j=nr(),D=ye(j);D.__click=[ar,L];var R=i(D,2);k(R,()=>t(L),G=>{var Z=rr(),w=s(Z);w.__click=[lr,L,e];var I=s(w);o(w),o(Z),B(()=>me(I,`create ${A.length??""} new realms`)),he(3,Z,()=>pe),_(G,Z)}),_(q,j)});var P=i(M,2);k(P,()=>t(g),q=>{var j=or(),D=s(j);Xe(D,{status:"error",children:(R,G)=>{var Z=ir(),w=s(Z,!0);o(Z),B(()=>me(w,t(g))),_(R,Z)},$$slots:{default:!0}}),o(j),_(q,j)});var Q=i(P,2);k(Q,()=>e.onclose&&a(),q=>{var j=_r();j.__click=[sr,e];var D=s(j);k(D,()=>t(p),R=>{var G=E("discard changes");_(R,G)},R=>{var G=E("close realm editor");_(R,G)}),o(j),_(q,j)}),o(oe),B(()=>H.disabled=a()&&!t(p)),fe(F,()=>t(c),q=>v(c,q)),_(l,ie),ne()}xe(["click","keydown"]);var vr=y('<div class="panel p_md"><!></div>');function ur(l,e){re(e,!0);const a=X(e,"app",7),r=d(()=>a().remove_realm),c=d(()=>a().duplicate_realm),n=d(()=>a().update_realm),m=d(()=>a().create_realm),p=d(()=>a().editing_realm_data??$e.parse({})),f=d(()=>a().realms?a().realms.some(g=>g.id===t(p).id):!1),z=(g,b)=>{var T;(T=a().realms)!=null&&T.some(A=>A.id===g.id)?t(n)(g):t(m)(g,b)};var h=vr(),u=s(h);dr(u,{get editing(){return t(f)},get realm_data(){return t(p)},onsubmit:g=>{if(Array.isArray(g))for(let b=0;b<g.length;(b+=1)-1)z(g[b],b===0);else z(g,!0)},onremove:g=>t(r)(g),onduplicate:g=>t(c)(g),onclose:()=>a().editing_realm=!1}),o(h),_(l,h),ne()}var mr=(l,e)=>e.app.play_level(e.level_data.id),gr=async(l,e,a,r)=>{if(t(e))a.app.remove_level(a.level_data.id);else{const c=!t(r);if(a.app.edit_level(c?a.level_data:null),c){await $t();const n=document.querySelector(".level_def_form");n==null||n.scrollIntoView({behavior:"smooth",block:"center"})}}},br=(l,e)=>v(e,!t(e)),fr=y('<li class="level_map_item svelte-170pvnv"><!> <button type="button" class="level_button deselectable svelte-170pvnv" title="play this level"> </button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button></li>');function hr(l,e){re(e,!0);const a=d(()=>e.app.draft_level_data===e.level_data),r=d(()=>e.app.editing_level&&t(a)),c=d(()=>{var A;return(A=e.app.selected_project_data)==null?void 0:A.level_stats});let n=S(!1);const m=d(()=>t(r)||t(a));var p=fr(),f=s(p);k(f,()=>t(c),A=>{xa(A,{get level_data(){return e.level_data},get level_stats(){return t(c)}})});var z=i(f,2);z.__click=[mr,e];var h=s(z,!0);o(z);var u=i(z,2);u.__click=[gr,n,e,r];var g=s(u);k(g,()=>t(n),A=>{var L=E("✕");_(A,L)},A=>{var L=E("✎");_(A,L)}),o(u);var b=i(u,2);b.__click=[br,n];var T=s(b);k(T,()=>t(n),A=>{var L=E("×");_(A,L)},A=>{var L=E("✕");_(A,L)}),o(b),o(p),B(()=>{ge(p,"selected",t(m)),ge(z,"selected",t(m)),me(h,e.level_data.name),V(u,"title",t(n)?"remove level":t(r)?"stop editing level":"edit level"),ge(u,"selected",!t(n)&&t(r)),ge(u,"color_c",t(n)),V(b,"title",t(n)?"cancel removing":"remove level")}),he(3,p,()=>pe),_(l,p),ne()}xe(["click"]);const pr=(l,e,a,r)=>{var c;t(e)?(c=document.querySelector(".level_def_form input"))==null||c.focus():a.app.edit_level(t(r)?null:Qe.parse({}))};var yr=y('<div class="panel p_md"><header><h2 class="my_0">levels</h2> <h3 class="my_0"> </h3></header> <menu class="levels unstyled mb_0 svelte-wmjxbn"></menu> <button type="button" class="svelte-wmjxbn">create a new level</button></div>');function kr(l,e){re(e,!0);const a=d(()=>e.app.editing_level&&!e.levels.some(h=>h===e.app.draft_level_data)),r=d(()=>!e.levels.length);var c=yr(),n=s(c),m=i(s(n),2),p=s(m,!0);o(m),o(n);var f=i(n,2);Me(f,21,()=>e.levels,h=>h.id,(h,u)=>{hr(h,{get app(){return e.app},get level_data(){return t(u)}})}),o(f);var z=i(f,2);z.__click=[pr,r,e,a],o(c),B(()=>{var h;me(p,(h=e.app.selected_realm_data)==null?void 0:h.name),ge(z,"selected",t(a)||t(r)),ge(z,"deselectable",!t(r))}),_(l,c),ne()}xe(["click"]);const xr=(l,e,a,r,c)=>{v(e,"");try{const n=JSON.parse(t(a));n&&!n.id&&(n.id=ua());const m=Ze.parse(n);r.onsubmit(m)}catch(n){console.error("failed to import data",n),v(e,C(n.message||"unknown error"))}v(c,!1)},wr=(l,e,a,r,c)=>{v(e,C(v(a,C(JSON.stringify(r()))))),v(c,!0)};var jr=y('<div class="importing bg shadow_d_xl p_xl width_md box svelte-l3tcx7"><h2 class="my_0">import project data</h2> <!> <textarea class="svelte-l3tcx7"></textarea> <button type="button" class="svelte-l3tcx7">import project data</button></div>'),zr=(l,e,a)=>{l.key==="Enter"&&(Ot(l),e.onsubmit(a()))},qr=(l,e,a)=>e.onsubmit(a()),Ir=(l,e)=>v(e,!t(e)),Sr=(l,e,a)=>{v(e,!1),a.onremove(a.project_data.id)},Tr=y('<div class="pb_md"><button type="button" class="color_c w_100 svelte-l3tcx7">✕ confirm remove</button></div>'),Ar=(l,e)=>e.onduplicate(e.project_data.id),Pr=y('<button type="button" class="w_100 svelte-l3tcx7">duplicate project</button>'),Er=y('<button class="w_100 svelte-l3tcx7" type="button">remove project</button> <!> <!>',1),Lr=y("<pre> </pre>"),Mr=y('<div class="overflow_x_auto"><!></div>'),Dr=(l,e)=>e.onclose(e.project_data.id),Or=y('<button type="button" class="w_100 svelte-l3tcx7"><!></button>'),Rr=y('<!> <form><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent w_100 svelte-l3tcx7"><!></button> <!> <button type="button" class="w_100 svelte-l3tcx7"><!></button> <!> <!></form>',1);function Cr(l,e){re(e,!0);const a=X(e,"editing",3,!1);let r=S(!1),c=S(C(e.project_data.name));const n=d(()=>t(c).trim()),m=()=>Ze.parse({id:e.project_data.id,name:t(n),realms:e.project_data.realms,level_stats:e.project_data.level_stats});Le(()=>{console.log("set_project_data",e.project_data),v(c,C(e.project_data.name))});const p=d(()=>t(n)!==e.project_data.name);let f=S(!1),z=S(""),h=S("");const u=d(()=>t(z)!==t(h));let g=S("");Le(()=>{e.project_data,v(g,"")});let b=S(void 0),T=S(void 0);var A=Rr(),L=ye(A);k(L,()=>t(f),M=>{Ne(M,{onclose:()=>{var P;v(f,!1),(P=t(T))==null||P.focus()},children:(P,Q)=>{var q=jr(),j=i(s(q),2);_t(j,{get text(){return t(h)},oncopy:()=>{var G;(G=t(b))==null||G.select()}});var D=i(j,2);ze(D,G=>v(b,G),()=>t(b)),Fe(D);var R=i(D,2);R.__click=[xr,g,h,e,f],o(q),B(()=>{R.disabled=!t(u),V(R,"title",t(u)?void 0:"data has not changed")}),fe(D,()=>t(h),G=>v(h,G)),_(P,q)},$$slots:{default:!0}})});var ie=i(L,2),ee=s(ie),oe=s(ee),W=s(oe);k(W,a,M=>{var P=E("editing project");_(M,P)},M=>{var P=E("create a new project");_(M,P)}),o(oe),o(ee);var se=i(ee,2),_e=s(se),ae=i(s(_e),2);ke(ae),ae.__keydown=[zr,e,m],o(_e),o(se);var N=i(se,2);N.__click=[qr,e,m];var F=s(N);k(F,a,M=>{var P=E("save changes to project");_(M,P)},M=>{var P=E("create project");_(M,P)}),o(N);var H=i(N,2);k(H,()=>e.onremove&&a(),M=>{var P=Er(),Q=ye(P);Q.__click=[Ir,r];var q=i(Q,2);k(q,()=>t(r),D=>{var R=Tr(),G=s(R);G.__click=[Sr,r,e],o(R),he(3,R,()=>pe),_(D,R)});var j=i(q,2);k(j,()=>e.onduplicate,D=>{var R=Pr();R.__click=[Ar,e],_(D,R)}),_(M,P)});var Y=i(H,2);ze(Y,M=>v(T,M),()=>t(T)),Y.__click=[wr,z,h,m,f];var U=s(Y);k(U,a,M=>{var P=E("import/export data");_(M,P)},M=>{var P=E("import data");_(M,P)}),o(Y);var J=i(Y,2);k(J,()=>t(g),M=>{var P=Mr(),Q=s(P);Xe(Q,{status:"error",children:(q,j)=>{var D=Lr(),R=s(D,!0);o(D),B(()=>me(R,t(g))),_(q,D)},$$slots:{default:!0}}),o(P),_(M,P)});var te=i(J,2);k(te,()=>e.onclose&&a(),M=>{var P=Or();P.__click=[Dr,e];var Q=s(P);k(Q,()=>t(p),q=>{var j=E("discard changes and stop editing");_(q,j)},q=>{var j=E("close project editor");_(q,j)}),o(P),_(M,P)}),o(ie),B(()=>N.disabled=a()&&!t(p)),fe(ae,()=>t(c),M=>v(c,M)),_(l,A),ne()}xe(["click","keydown"]);var Nr=y('<div class="panel p_md"><!></div>');function Fr(l,e){re(e,!0);const a=X(e,"app",7),r=d(()=>a().remove_project),c=d(()=>a().duplicate_project),n=d(()=>a().update_project),m=d(()=>a().create_project),p=d(()=>a().editing_project_data??Ze.parse({})),f=d(()=>a().project_datas.some(g=>g.id===t(p).id));var z=Nr(),h=s(z),u=d(()=>t(f)?t(n):t(m));Cr(h,{get editing(){return t(f)},get project_data(){return t(p)},get onsubmit(){return t(u)},get onremove(){return t(r)},get onduplicate(){return t(c)},onclose:()=>a().editing_project=!1}),o(z),_(l,z),ne()}var Jr=y('<section class="card svelte-8muejm"><!></section>'),Br=y('<section class="card svelte-8muejm"><!></section>'),Hr=y('<div class="width_sm svelte-8muejm"><!>  <!> <section class="card svelte-8muejm"><div class="panel p_md"><header><h2 class="my_0">controls</h2></header> <!> <div class="mb_lg"><!></div> <!> <aside>Earbetter supports MIDI devices like piano keyboards, connect and click:</aside> <!></div></section></div>'),Ur=(l,e)=>t(e)(),Vr=y(`<section class="card svelte-8muejm"><div class="panel p_md"><p>Earbetter is an <a href="https://wikipedia.org/wiki/Ear_training">ear training</a> tool:</p> <ul><li>each level is a standalone challenge that's a series of trials</li> <li></li> <li>realms group levels into bigger challenges</li> <li>projects group realms so you can customize various experiences</li> <li>levels can be shared via their links or exporting/importing data</li></ul> <p>See also the 3 minute <a href="https://www.youtube.com/watch?v=zW2zI1A_Ikw">video intro on YouTube</a> and <a href="https://github.com/ryanatkn/earbetter">the readme</a>.</p> <aside>Earbetter is in early development, and many things are unfinished and unknown - feedback
						is appreciated on <a href="https://github.com/ryanatkn/earbetter">the GitHub discussions and issues</a>.</aside> <div class="box row"><button type="button" class="m_0">ok, hide this</button></div></div></section>`),Wr=y('<section class="card svelte-8muejm"><!></section>'),Yr=y('<section class="card svelte-8muejm"><!></section>'),Gr=y('<section class="card svelte-8muejm"><div class="panel p_md"><!></div></section>'),Kr=y('<div class="width_sm svelte-8muejm"><!>  <!></div>'),Xr=y('<!> <div class="map svelte-8muejm"><!> <div class="width_sm svelte-8muejm"><!> <section class="card svelte-8muejm"><!></section>  <!></div> <!></div>',1);function Qr(l,e){re(e,!0);const a=X(e,"app",7),r=d(()=>a().toggle_trainer_help),c=d(()=>a().play_level),n=d(()=>a().edit_level),m=d(()=>a().remove_level),p=d(()=>a().duplicate_level),f=d(()=>a().create_level),z=d(()=>a().update_level),h=Tt.get();window.ac=h;const u=d(()=>a().draft_level_data??Qe.parse({})),g=d(()=>a().levels?a().levels.some(N=>N.id===t(u).id):!1),b=d(()=>{var N;return!((N=a().realms)!=null&&N.length)});var T=Xr(),A=ye(T);Bt(A,{get midi_access(){return a().midi_access},onnotestart:(N,F)=>{Pt(a(),h(),N,Et(a().volume,F),a().instrument)},onnotestop:N=>{ot(N)}});var L=i(A,2),ie=s(L);k(ie,()=>a().project_datas.length,N=>{var F=Hr(),H=s(F);k(H,()=>a().selected_project_data,j=>{var D=Jr(),R=s(D);zl(R,{get app(){return a()}}),o(D),he(3,D,()=>pe),_(j,D)});var Y=i(H,2);k(Y,()=>a().editing_project&&a().editing_project_data||!a().selected_project_data,j=>{var D=Br(),R=s(D);Fr(R,{get app(){return a()}}),o(D),he(3,D,()=>pe),_(j,D)});var U=i(Y,2),J=s(U),te=i(s(J),2);Sl(te,{});var M=i(te,2),P=s(M);Ct(P,{get volume(){return a().volume},set volume(j){a().volume=j}}),o(M);var Q=i(M,2);Rt(Q,{get instrument(){return a().instrument},set instrument(j){a().instrument=j}});var q=i(Q,4);Nt(q,{get midi_state(){return a()}}),o(J),o(U),o(F),he(3,U,()=>pe),_(N,F)});var ee=i(ie,2),oe=s(ee);k(oe,()=>a().show_trainer_help,N=>{var F=Vr(),H=s(F),Y=i(s(H),2),U=i(s(Y),2);U.textContent=`your level score is the sum of mistakes in your best ${Mt}
							runs, win a ★ at 0`,Ee(6),o(Y);var J=i(Y,6),te=s(J);te.__click=[Ur,r],o(J),o(H),o(F),he(3,F,()=>pe),_(N,F)});var W=i(oe,2),se=s(W);Ul(se,{get app(){return a()}}),o(W);var _e=i(W,2);k(_e,()=>a().editing_realm&&a().editing_realm_data||t(b),N=>{var F=Wr(),H=s(F);ur(H,{get app(){return a()}}),o(F),he(3,F,()=>pe),_(N,F)}),o(ee);var ae=i(ee,2);k(ae,()=>a().project_datas.length,N=>{var F=Kr(),H=s(F);k(H,()=>a().levels,U=>{var J=Yr(),te=s(J);kr(te,{get app(){return a()},get levels(){return a().levels}}),o(J),he(3,J,()=>pe),_(U,J)});var Y=i(H,2);k(Y,()=>{var U;return a().selected_realm_id&&(a().editing_level&&a().levels||((U=a().levels)==null?void 0:U.length)===0)},U=>{var J=Gr(),te=s(J),M=s(te),P=d(()=>t(g)?t(z):t(f));vl(M,{get editing(){return t(g)},get level_data(){return t(u)},get onsubmit(){return t(P)},get onremove(){return t(m)},get onduplicate(){return t(p)},onplay:async(Q,q)=>{q&&t(z)(Q),await t(c)(Q.id)},onclose:()=>t(n)(null)}),o(te),o(J),he(2,J,()=>pe),_(U,J)}),o(F),_(N,F)}),o(L),_(l,T),ne()}xe(["click"]);var Zr=y('<main><!> <!> <!> <div class="box"><!></div></main>');function mn(l,e){re(e,!0);const a=Lt.get();var r=Zr();Zt(z=>{ea.title="Earbetter trainer"});var c=s(r);ka(c,{onclick:()=>ta(aa+"/")});var n=i(c,2);la(n);var m=i(n,2);Qr(m,{app:a});var p=i(m,2),f=s(p);na(f,{}),o(p),o(r),_(l,r),ne()}export{mn as component};
