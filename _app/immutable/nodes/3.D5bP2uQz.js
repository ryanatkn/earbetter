import{a as w,t as P,s as E,b as ae,d as ve,h as de}from"../chunks/disclose-version.t6-SPuTG.js";import{p as O,t as C,a as X,c as r,s as a,r as s,g as c,d as se,n as me,f as ne,v as G,Y as ce,_ as ue,j as K}from"../chunks/index-client.tN2euk7f.js";import{p as N,i as q,a as j}from"../chunks/props.CjJeOVXC.js";import{s as m,r as D,t as pe,e as Q,b as ge}from"../chunks/style.DXnKmRQF.js";import{M as fe,B as be,b as xe,P as he}from"../chunks/Back_Button.CM8frOgd.js";import{a as z,b as F,m as U,t as ye,c as ke,l as we,d as Ie,p as Me,e as Z,g as Ae,z as $e,f as ee,h as Be,j as Ce,k as te,n as Ee,w as Pe,o as Se}from"../chunks/index.o74CadRn.js";import{g as Te,b as je}from"../chunks/entry.DZUVsf_l.js";import{b as H,i as De,a as ze,s as Fe,I as He,V as Ne,c as Re}from"../chunks/Init_Midi_Button.DrFHPmpe.js";import{H as Ve}from"../chunks/Header.CwczZtBs.js";import{F as We}from"../chunks/Footer.CQ8JMu0r.js";import{A as Ye}from"../chunks/Alert.D4NZ_mtl.js";var Ge=P("<div><!></div>"),Ke=P('<div class="midi-range-control"><div class="box row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="range"> <input type="number"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="range"> <input type="number"></label></div> <!></div>');function Oe(I,u){O(u,!0);let e=N(u,"min_note",15),_=N(u,"max_note",15);const x=se(()=>e()>_()?"note min cannot be larger than the max":!1);var p=Ke(),l=r(p),g=r(l),y=a(r(g),2),A=r(y);s(y);var i=a(y,2);D(i),m(i,"step",1),m(i,"min",z),m(i,"max",F);var n=a(i,2);D(n),m(n,"step",1),m(n,"min",z),m(n,"max",F),s(g);var o=a(g,2),v=a(r(o),2),h=r(v);s(v);var f=a(v,2);D(f),m(f,"step",1),m(f,"min",z),m(f,"max",F);var b=a(f,2);D(b),m(b,"step",1),m(b,"min",z),m(b,"max",F),s(o),s(l);var k=a(l,2);q(k,()=>c(x),d=>{var M=Ge(),$=r(M);Ye($,{status:"error",children:(R,T)=>{me();var B=ae();C(()=>E(B,c(x))),w(R,B)},$$slots:{default:!0}}),s(M),ye(3,M,()=>ke),w(d,M)}),s(p),C(()=>{pe(p,"error",!!c(x)),E(A,U[e()]),E(h,U[_()])}),H(i,e,d=>e(d)),H(n,e,d=>e(d)),H(f,_,d=>_(d)),H(b,_,d=>_(d)),w(I,p),X()}var Xe=(I,u)=>u(we(I.currentTarget.value)),qe=P("<option> </option>"),Je=P("<option> <!></option>"),Le=P('<label class="text_align_center svelte-199vc6u"><div class="title">scale</div> <select></select></label> <label class="text_align_center svelte-199vc6u"><div class="title">key</div> <select></select></label>',1);function Qe(I,u){O(u,!0);let e=N(u,"scale",15),_=N(u,"key",15);var x=Le(),p=ne(x),l=a(r(p),2);De(l,()=>e().name);var g;l.__input=[Xe,e],Q(l,20,()=>Ie,i=>i,(i,n)=>{var o=qe(),v={},h=r(o);s(o),C(()=>{v!==(v=n.name)&&(o.value=(o.__value=n.name)==null?"":n.name),E(h,n.name)}),w(i,o)}),s(l),s(p);var y=a(p,2),A=a(r(y),2);Q(A,20,()=>Me,i=>i,(i,n)=>{var o=Je(),v={},h=r(o),f=a(h);q(f,()=>n in Z,b=>{var k=ae();C(()=>E(k,`/${Z[n]??""}`)),w(b,k)}),s(o),C(()=>{v!==(v=n)&&(o.value=(o.__value=n)==null?"":n),E(h,n)}),w(i,o)}),s(A),s(y),C(()=>{g!==(g=e().name)&&(l.value=(l.__value=e().name)==null?"":e().name,Fe(l,e().name))}),ze(A,_,i=>_(i)),w(I,x),X()}ve(["input"]);var Ue=P('<!> <main class="svelte-3fkhg9"><!> <!> <div class="piano_wrapper svelte-3fkhg9"><!></div> <form class="width_sm panel p_md"><fieldset><!> <div class="row mb_lg"><!></div> <!></fieldset> <fieldset><!></fieldset> <fieldset class="row"><!></fieldset></form> <!></main>',1);function vt(I,u){O(u,!0);const e=Ae(),_=$e.object({min_note:ee.default(36),max_note:ee.default(96)}),x="piano",p=Be(x,()=>_.parse({}),_.parse);let l=G(j(p.min_note)),g=G(j(p.max_note));const y=()=>({min_note:c(l),max_note:c(g)});ce(()=>Se(x,y()));const i=Ce(),{playing_notes:n}=e;let o=G(void 0);const v=20,h=(t,S=null)=>{(!e.enabled_notes||e.enabled_notes.has(t))&&Ee(e,i(),t,Pe(e.volume,S),e.instrument)};var f=Ue();de(t=>{ue.title="Earbetter: piano"});var b=ne(f);fe(b,{get midi_access(){return e.midi_access},onnotestart:(t,S)=>h(t,S),onnotestop:t=>te(t)});var k=a(b,2),d=r(k);be(d,{onclick:()=>Te(je+"/")});var M=a(d,2);Ve(M);var $=a(M,2);ge($,"padding",`${v}px`);var R=r($);q(R,()=>c(o),t=>{var S=se(()=>c(o)-v*2);he(t,{get width(){return c(S)},get min_note(){return c(l)},get max_note(){return c(g)},pressed_keys:n,get enabled_notes(){return e.enabled_notes},onpress:Y=>h(Y),onrelease:Y=>te(Y),middle_c_label:!0,allow_sticking:!0})}),s($);var T=a($,2),B=r(T),J=r(B);He(J,{get instrument(){return e.instrument},set instrument(t){e.instrument=t}});var V=a(J,2),ie=r(V);Qe(ie,{get scale(){return e.scale},set scale(t){e.scale=t},get key(){return e.key},set key(t){e.key=t}}),s(V);var oe=a(V,2);Ne(oe,{get volume(){return e.volume},set volume(t){e.volume=t}}),s(B);var W=a(B,2),re=r(W);Re(re,{midi_state:e}),s(W);var L=a(W,2),le=r(L);Oe(le,{get min_note(){return c(l)},set min_note(t){K(l,j(t))},get max_note(){return c(g)},set max_note(t){K(g,j(t))}}),s(L),s(T);var _e=a(T,2);We(_e,{}),s(k),xe(k,"clientWidth",t=>K(o,t)),w(I,f),X()}export{vt as component};
