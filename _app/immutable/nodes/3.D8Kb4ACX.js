import{t as C,a as w,s as B,b as se,d as de,h as me}from"../chunks/D6FQBtKd.js";import{p as Y,t as T,d as q,s,c as r,g as v,a as n,b as ne,n as ce,f as ie,V as K,M as Q,T as ue,X as pe,G as O}from"../chunks/Drfw-9es.js";import{p as H,i as J}from"../chunks/CnDERkxj.js";import{s as _,c as fe,r as j,e as U,d as ge}from"../chunks/wr1Q2OBW.js";import{M as be,B as xe,b as he,P as ye}from"../chunks/Bb9lJ5m4.js";import{a as z,b as F,m as Z,t as ke,c as we,l as Ie,d as Me,p as Ae,e as ee,f as Se,z as Te,g as te,h as Be,j as Ce,k as Ee,n as ae,o as Pe,w as $e}from"../chunks/CPUX8dqx.js";import{g as De,b as Ve}from"../chunks/DGs4Uxve.js";import{b as G,i as je,a as ze,s as Fe,I as Ge,V as He,c as Ne}from"../chunks/BpNc9_EQ.js";import{H as Re}from"../chunks/DIMrDfL4.js";import{F as We}from"../chunks/CxoK_AUc.js";import{A as Xe}from"../chunks/rZfaOUOJ.js";var Ke=C("<div><!></div>"),Oe=C('<div><div class="box row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="range"> <input type="number"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="range"> <input type="number"></label></div> <!></div>');function Ye(I,d){Y(d,!0);let e=H(d,"min_note",15),x=H(d,"max_note",15);const h=ne(()=>e()>x()?"note min cannot be larger than the max":!1);var m=Oe();let o;var c=r(m),y=r(c),k=s(r(y),2),u=r(k,!0);n(k);var i=s(k,2);j(i),_(i,"step",1),_(i,"min",z),_(i,"max",F);var a=s(i,2);j(a),_(a,"step",1),_(a,"min",z),_(a,"max",F),n(y);var g=s(y,2),p=s(r(g),2),A=r(p,!0);n(p);var f=s(p,2);j(f),_(f,"step",1),_(f,"min",z),_(f,"max",F);var l=s(f,2);j(l),_(l,"step",1),_(l,"min",z),_(l,"max",F),n(g),n(c);var M=s(c,2);{var D=b=>{var S=Ke(),N=r(S);Xe(N,{status:"error",children:(E,V)=>{ce();var P=se();T(()=>B(P,v(h))),w(E,P)},$$slots:{default:!0}}),n(S),ke(3,S,()=>we),w(b,S)};J(M,b=>{v(h)&&b(D)})}n(m),T(b=>{o=fe(m,1,"midi-range-control",null,o,b),B(u,Z[e()]),B(A,Z[x()])},[()=>({error:!!v(h)})]),G(i,e),G(a,e),G(f,x),G(l,x),w(I,m),q()}var qe=(I,d)=>d(Ie(I.currentTarget.value)),Je=C("<option> </option>"),Le=C("<option> <!></option>"),Qe=C('<label class="text_align_center svelte-199vc6u"><div class="title">scale</div> <select></select></label> <label class="text_align_center svelte-199vc6u"><div class="title">key</div> <select></select></label>',1);function Ue(I,d){Y(d,!0);let e=H(d,"scale",15),x=H(d,"key",15);var h=Qe(),m=ie(h),o=s(r(m),2);je(o,()=>e().name);var c;o.__input=[qe,e],U(o,20,()=>Me,u=>u,(u,i)=>{var a=Je(),g={},p=r(a,!0);n(a),T(()=>{g!==(g=i.name)&&(a.value=(a.__value=i.name)??""),B(p,i.name)}),w(u,a)}),n(o),n(m);var y=s(m,2),k=s(r(y),2);U(k,20,()=>Ae,u=>u,(u,i)=>{var a=Le(),g={},p=r(a,!0),A=s(p);{var f=l=>{var M=se();T(()=>B(M,`/${ee[i]??""}`)),w(l,M)};J(A,l=>{i in ee&&l(f)})}n(a),T(()=>{g!==(g=i)&&(a.value=(a.__value=i)??""),B(p,i)}),w(u,a)}),n(k),n(y),T(()=>{c!==(c=e().name)&&(o.value=(o.__value=e().name)??"",Fe(o,e().name))}),ze(k,x),w(I,h),q()}de(["input"]);var Ze=C('<!> <main class="svelte-3fkhg9"><!> <!> <div class="piano_wrapper svelte-3fkhg9"><!></div> <form class="width_sm panel p_md"><fieldset><!> <div class="row mb_lg"><!></div> <!></fieldset> <fieldset><!></fieldset> <fieldset class="row"><!></fieldset></form> <!></main>',1);function dt(I,d){Y(d,!0);const e=Se.get(),x=Te.object({min_note:te.default(36),max_note:te.default(96)}),h="piano",m=Be(h,()=>x.parse({}),x.parse);let o=K(Q(m.min_note)),c=K(Q(m.max_note));const y=()=>({min_note:v(o),max_note:v(c)});ue(()=>Ee(h,y()));const u=Ce.get(),{playing_notes:i}=e;let a=K(void 0);const g=20,p=(t,$=null)=>{(!e.enabled_notes||e.enabled_notes.has(t))&&Pe(e,u(),t,$e(e.volume,$),e.instrument)};var A=Ze();me(t=>{pe.title="Earbetter: piano"});var f=ie(A);be(f,{get midi_access(){return e.midi_access},onnotestart:(t,$)=>p(t,$),onnotestop:t=>ae(t)});var l=s(f,2),M=r(l);xe(M,{onclick:()=>De(Ve+"/")});var D=s(M,2);Re(D);var b=s(D,2);ge(b,"",{},{padding:"20px"});var S=r(b);{var N=t=>{const $=ne(()=>v(a)-g*2);ye(t,{get width(){return v($)},get min_note(){return v(o)},get max_note(){return v(c)},pressed_keys:i,get enabled_notes(){return e.enabled_notes},onpress:X=>p(X),onrelease:X=>ae(X),middle_c_label:!0,allow_sticking:!0})};J(S,t=>{v(a)&&t(N)})}n(b);var E=s(b,2),V=r(E),P=r(V);Ge(P,{get instrument(){return e.instrument},set instrument(t){e.instrument=t}});var R=s(P,2),re=r(R);Ue(re,{get scale(){return e.scale},set scale(t){e.scale=t},get key(){return e.key},set key(t){e.key=t}}),n(R);var oe=s(R,2);He(oe,{get volume(){return e.volume},set volume(t){e.volume=t}}),n(V);var W=s(V,2),le=r(W);Ne(le,{midi_state:e}),n(W);var L=s(W,2),_e=r(L);Ye(_e,{get min_note(){return v(o)},set min_note(t){O(o,t,!0)},get max_note(){return v(c)},set max_note(t){O(c,t,!0)}}),n(L),n(E);var ve=s(E,2);We(ve,{}),n(l),he(l,"clientWidth",t=>O(a,t)),w(I,A),q()}export{dt as component};
