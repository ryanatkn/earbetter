import{a as w,t as E,e as se,b as C,h as de,i as me}from"../chunks/disclose-version.DbIX9lBU.js";import{t as B,p as X,a as q,g as d,d as ne,c as r,s as a,r as s,n as ce,f as ie,_ as K,Y as ue,a0 as pe,k as O}from"../chunks/index-client.BoISVktJ.js";import{p as N,i as J,a as D}from"../chunks/props.Dc3VY8m1.js";import{s as v,r as j,t as fe,e as U,b as ge}from"../chunks/string.CP9_p8aN.js";import{M as be,B as xe,b as he,P as ye}from"../chunks/Back_Button.BQXQClOF.js";import{a as z,b as F,t as ke,m as Z,c as we,l as Ie,d as Me,p as ee,e as Ae,f as Se,z as $e,g as te,h as Be,j as Ce,k as ae,n as Ee,o as Pe,w as Te}from"../chunks/index.wDcSWpFq.js";import{g as De,b as je}from"../chunks/entry.kPVDgoJY.js";import{b as H,i as ze,a as Fe,s as He,I as Ne,V as Re,c as Ve}from"../chunks/Init_Midi_Button.CckDMOmN.js";import{H as We}from"../chunks/Header.C5g4l-Vn.js";import{F as Ye}from"../chunks/Footer.CZ2mBlMR.js";import{A as Ge}from"../chunks/Alert.IdmVHHLR.js";var Ke=E("<div><!></div>"),Oe=E('<div class="midi-range-control"><div class="box row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="range"> <input type="number"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="range"> <input type="number"></label></div> <!></div>');function Xe(I,m){q(m,!0);let e=N(m,"min_note",15),g=N(m,"max_note",15);const b=ne(()=>e()>g()?"note min cannot be larger than the max":!1);var c=Oe(),o=r(c),u=r(o),k=a(r(u),2),A=r(k,!0);s(k);var l=a(k,2);j(l),v(l,"step",1),v(l,"min",z),v(l,"max",F);var n=a(l,2);j(n),v(n,"step",1),v(n,"min",z),v(n,"max",F),s(u);var i=a(u,2),_=a(r(i),2),x=r(_,!0);s(_);var p=a(_,2);j(p),v(p,"step",1),v(p,"min",z),v(p,"max",F);var f=a(p,2);j(f),v(f,"step",1),v(f,"min",z),v(f,"max",F),s(i),s(o);var h=a(o,2);{var M=S=>{var y=Ke(),R=r(y);Ge(R,{status:"error",children:(V,T)=>{ce();var $=se();B(()=>C($,d(b))),w(V,$)},$$slots:{default:!0}}),s(y),ke(3,y,()=>we),w(S,y)};J(h,S=>{d(b)&&S(M)})}s(c),B(()=>{fe(c,"error",!!d(b)),C(A,Z[e()]),C(x,Z[g()])}),H(l,e),H(n,e),H(p,g),H(f,g),w(I,c),X()}var qe=(I,m)=>m(Ie(I.currentTarget.value)),Je=E("<option> </option>"),Le=E("<option> <!></option>"),Qe=E('<label class="text_align_center svelte-199vc6u"><div class="title">scale</div> <select></select></label> <label class="text_align_center svelte-199vc6u"><div class="title">key</div> <select></select></label>',1);function Ue(I,m){q(m,!0);let e=N(m,"scale",15),g=N(m,"key",15);var b=Qe(),c=ie(b),o=a(r(c),2);ze(o,()=>e().name);var u;o.__input=[qe,e],U(o,20,()=>Me,l=>l,(l,n)=>{var i=Je(),_={},x=r(i,!0);s(i),B(()=>{_!==(_=n.name)&&(i.value=(i.__value=n.name)==null?"":n.name),C(x,n.name)}),w(l,i)}),s(o),s(c);var k=a(c,2),A=a(r(k),2);U(A,20,()=>Ae,l=>l,(l,n)=>{var i=Le(),_={},x=r(i,!0),p=a(x);{var f=h=>{var M=se();B(()=>C(M,`/${ee[n]??""}`)),w(h,M)};J(p,h=>{n in ee&&h(f)})}s(i),B(()=>{_!==(_=n)&&(i.value=(i.__value=n)==null?"":n),C(x,n)}),w(l,i)}),s(A),s(k),B(()=>{u!==(u=e().name)&&(o.value=(o.__value=e().name)==null?"":e().name,He(o,e().name))}),Fe(A,g),w(I,b),X()}de(["input"]);var Ze=E('<!> <main class="svelte-3fkhg9"><!> <!> <div class="piano_wrapper svelte-3fkhg9"><!></div> <form class="width_sm panel p_md"><fieldset><!> <div class="row mb_lg"><!></div> <!></fieldset> <fieldset><!></fieldset> <fieldset class="row"><!></fieldset></form> <!></main>',1);function dt(I,m){q(m,!0);const e=Se.get(),g=$e.object({min_note:te.default(36),max_note:te.default(96)}),b="piano",c=Be(b,()=>g.parse({}),g.parse);let o=K(D(c.min_note)),u=K(D(c.max_note));const k=()=>({min_note:d(o),max_note:d(u)});ue(()=>Ee(b,k()));const l=Ce.get(),{playing_notes:n}=e;let i=K(void 0);const _=20,x=(t,P=null)=>{(!e.enabled_notes||e.enabled_notes.has(t))&&Pe(e,l(),t,Te(e.volume,P),e.instrument)};var p=Ze();me(t=>{pe.title="Earbetter: piano"});var f=ie(p);be(f,{get midi_access(){return e.midi_access},onnotestart:(t,P)=>x(t,P),onnotestop:t=>ae(t)});var h=a(f,2),M=r(h);xe(M,{onclick:()=>De(je+"/")});var S=a(M,2);We(S);var y=a(S,2);ge(y,"padding",`${_}px`);var R=r(y);{var V=t=>{var P=ne(()=>d(i)-_*2);ye(t,{get width(){return d(P)},get min_note(){return d(o)},get max_note(){return d(u)},pressed_keys:n,get enabled_notes(){return e.enabled_notes},onpress:G=>x(G),onrelease:G=>ae(G),middle_c_label:!0,allow_sticking:!0})};J(R,t=>{d(i)&&t(V)})}s(y);var T=a(y,2),$=r(T),L=r($);Ne(L,{get instrument(){return e.instrument},set instrument(t){e.instrument=t}});var W=a(L,2),re=r(W);Ue(re,{get scale(){return e.scale},set scale(t){e.scale=t},get key(){return e.key},set key(t){e.key=t}}),s(W);var oe=a(W,2);Re(oe,{get volume(){return e.volume},set volume(t){e.volume=t}}),s($);var Y=a($,2),le=r(Y);Ve(le,{midi_state:e}),s(Y);var Q=a(Y,2),_e=r(Q);Xe(_e,{get min_note(){return d(o)},set min_note(t){O(o,D(t))},get max_note(){return d(u)},set max_note(t){O(u,D(t))}}),s(Q),s(T);var ve=a(T,2);Ye(ve,{}),s(h),he(h,"clientWidth",t=>O(i,t)),w(I,p),X()}export{dt as component};
