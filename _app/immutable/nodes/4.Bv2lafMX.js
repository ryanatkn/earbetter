import{u as je,f as fe,c as n,r as l,s as a,b as ge,a as d,t as c,d as ft,e as fa,n as Te,v as ha,w as pa}from"../chunks/disclose-version.C5EwI3-V.js";import{p as ne,j as E,t as B,H as Q,g as t,a as oe,s as g,d as v,F as De,n as Mt}from"../chunks/index-client.Cqv4GYu1.js";import{g as ya,b as ka}from"../chunks/entry.NZiJ-oIP.js";import{H as wa}from"../chunks/Header.tWntAhS7.js";import{g as ja,F as xa}from"../chunks/Footer.BT5tsXRn.js";import{K as Rt,U as mt,d as Ct,l as za,W as Ft,X as qa,L as Ia,j as Vt,k as gt,p as Sa,Y as bt,Z as Ht,n as Bt,w as Jt,_ as Aa,g as Ut,$ as Se,a as Xe,b as Ze,t as pe,m as Dt,a0 as Pa,a1 as et,c as ye,a2 as tt,M as Wt,a3 as at,a4 as Yt,a5 as Ta,s as Gt,a6 as La}from"../chunks/index.aKViKDRV.js";import{p as $,a as M,i as j}from"../chunks/props.DNuZbuIM.js";import{l as Ea,i as Ma,s as Da,b as he,I as Kt,V as Xt,c as Zt,a as Oa}from"../chunks/Init_Midi_Button.BcvCSmTn.js";import{f as He,e as Oe,r as we,s as U,g as Qe,b as Qt,c as $t,t as be,h as Na}from"../chunks/style.BTM4hw-r.js";import{M as ea,P as ta,b as Ra,B as Ca}from"../chunks/Back_Button.CChrNbmG.js";import{b as Ae}from"../chunks/this.D7faLO31.js";import{D as Ve}from"../chunks/Dialog.DUd-D1tj.js";import{A as $e}from"../chunks/Alert.BnMwJceV.js";import{p as Fa}from"../chunks/string.Dn_jmF-S.js";import{L as Va}from"../chunks/Level_Stats_Summary.Bf7YM0OL.js";function Ha(o,e){Ea(window,["resize"],()=>e(window[o]))}var Ot=Object.prototype.hasOwnProperty;function Nt(o,e,r){for(r of o.keys())if(Le(r,e))return r}function Le(o,e){var r,i,s;if(o===e)return!0;if(o&&e&&(r=o.constructor)===e.constructor){if(r===Date)return o.getTime()===e.getTime();if(r===RegExp)return o.toString()===e.toString();if(r===Array){if((i=o.length)===e.length)for(;i--&&Le(o[i],e[i]););return i===-1}if(r===Set){if(o.size!==e.size)return!1;for(i of o)if(s=i,s&&typeof s=="object"&&(s=Nt(e,s),!s)||!e.has(s))return!1;return!0}if(r===Map){if(o.size!==e.size)return!1;for(i of o)if(s=i[0],s&&typeof s=="object"&&(s=Nt(e,s),!s)||!Le(i[1],e.get(s)))return!1;return!0}if(r===ArrayBuffer)o=new Uint8Array(o),e=new Uint8Array(e);else if(r===DataView){if((i=o.byteLength)===e.byteLength)for(;i--&&o.getInt8(i)===e.getInt8(i););return i===-1}if(ArrayBuffer.isView(o)){if((i=o.byteLength)===e.byteLength)for(;i--&&o[i]===e[i];);return i===-1}if(!r||typeof o=="object"){i=0;for(r in o)if(Ot.call(o,r)&&++i&&!Ot.call(e,r)||!(r in e)||!Le(o[r],e[r]))return!1;return Object.keys(e).length===i}}return o!==o&&e!==e}var Ba=(o,e)=>g(e,M(o.currentTarget.value)),Ja=(o,e,r,i,s,_)=>{var b;return(b=e.oninput)==null?void 0:b.call(e,t(r),t(i)?{scale:s(),octaves:_()}:void 0)},Ua=(o,e)=>e(M(za(o.currentTarget.value))),Wa=c("<option> </option>"),Ya=c('<small><textarea class="preview width_sm panel svelte-1n8fnqy"></textarea></small> <button type="button" class="accent mb_lg">use these intervals</button> <label><div class="title text_align_center">scale</div> <select></select></label> <label><div class="title text_align_center">octaves</div> <div class="text_align_center"> </div> <input type="range"></label>',1);function Ga(o,e){ne(e,!0);let r=$(e,"scale",15,()=>M(Rt)),i=$(e,"octaves",7,1);const s=v(()=>qa(r(),i())),_=v(()=>mt(t(s))),b=M(mt(e.intervals));let k=E(M(b));const f=v(()=>(t(s),Date.now())),I=v(()=>(e.intervals,t(k),Date.now())),y=v(()=>t(f)>t(I)),m=v(()=>t(y)?t(_):t(k)),w=v(()=>Ft(t(m))),p=v(()=>!Le(e.intervals,t(w))),u=v(()=>!!t(w).length);var q=Ya(),S=fe(q),D=n(S);He(D),D.__input=[Ba,k],l(S);var H=a(a(S,!0));H.__click=[Ja,e,w,y,r,i];var te=a(a(H,!0)),G=n(te),Z=a(a(G,!0));Ma(Z,()=>r().name);var ie;Z.__change=[Ua,r],Oe(Z,76,()=>Ct,(N,J)=>Q(N),(N,J,W)=>{var K=Wa(),T={},z=n(K);l(K),B(()=>{T!==(T=Q(J).name)&&(K.value=(K.__value=Q(J).name)==null?"":Q(J).name),ge(z,Q(J).name)}),d(N,K)}),l(Z),l(te);var ve=a(a(te,!0)),le=n(ve),_e=a(a(le,!0)),ue=n(_e);l(_e);var R=a(a(_e,!0));we(R),U(R,"min",1),U(R,"max",6),l(ve),B(()=>{Qe(D,t(m)),H.disabled=!t(p)||!t(u),ie!==(ie=r().name)&&(Z.value=(Z.__value=r().name)==null?"":r().name,Da(Z,r().name)),ge(ue,i())}),he(R,i,N=>i(N)),d(o,q),oe()}je(["input","click","change"]);var Ka=(o,e)=>{g(e,M(new Set))},Xa=(o,e,r)=>{var i;(i=e.oninput)==null||i.call(e,t(r))},Za=c("all",1),Qa=c('<!> <button class="mb_lg" type="button">clear selection</button> <button type="button" class="accent">select <!> </button>',1),$a=c("<option> </option>"),er=(o,e,r)=>e(Q(r)),tr=c('<button type="button"> </button>'),ar=(o,e)=>e(o.currentTarget.value),rr=c('<!> <div class="notes_input pt_lg svelte-18obm47"><!> <div class="piano_wrapper svelte-18obm47"><!></div> <section class="box"><label class="mb_lg"><div class="title text_align_center">key</div> <select></select></label> <div class="scales mb_lg svelte-18obm47"></div> <!> <div class="notes width_sm svelte-18obm47"><blockquote class="panel my_lg"><textarea></textarea></blockquote></div></section> <form class="width_sm panel p_md"><fieldset><!> <!></fieldset> <fieldset><!></fieldset></form></div>',1);function lr(o,e){ne(e,!0);const r=h=>{var L=Qa(),ee=fe(L);j(ee,()=>e.before_buttons,qe=>{var ze=ft(),rt=fe(ze);$t(rt,()=>e.before_buttons),d(qe,ze)});var de=a(a(ee,!0));de.__click=[Ka,_];var ce=a(a(de,!0));ce.__click=[Xa,e,b];var Pe=a(n(ce));j(Pe,()=>t(f)===0,qe=>{var ze=Za();d(qe,ze)},qe=>{var ze=fa();B(()=>ge(ze,t(f))),d(qe,ze)});var Be=a(Pe,!0);B(()=>ge(Be,` tonic${Fa(t(f))??""}`)),l(ce),B(()=>{de.disabled=t(f)===0,ce.disabled=!t(w)}),d(h,L)},i=$(e,"audio_state",7),{playing_notes:s}=i();let _=E(void 0);const b=v(()=>t(_)&&Array.from(t(_)).sort((h,L)=>h-L)),k=v(()=>t(_)??e.notes),f=v(()=>t(k).size),I=v(()=>t(b)&&bt(t(b))),y=h=>{g(_,M(new Set(Ht(h))))},m=v(()=>bt(Array.from(e.notes).sort((h,L)=>h-L))),w=v(()=>!!t(b)&&t(I)!==t(m)),p=h=>{const L=new Set(t(k));L.has(h)?L.delete(h):L.add(h),g(_,M(L))};let u=E(M(Ia));const q=Vt();let S=E(void 0);const D=20,H=(h,L=null)=>{Bt(i(),q(),h,Jt(i().volume,L),i().instrument)},te=h=>{const L=Aa(h,t(u),e.min_note,e.max_note);if(!t(_)||!t(b)){g(_,M(L));return}let ee=!0;for(const ce of L)if(!t(_).has(ce)){ee=!1;break}const de=ee?t(b).filter(ce=>!L.has(ce)):t(b).concat(Array.from(L));g(_,M(new Set(de)))};var G=rr(),Z=fe(G);ea(Z,{get midi_access(){return i().midi_access},onnotestart:(h,L)=>H(h,L),onnotestop:h=>gt(h)});var ie=a(a(Z,!0)),ve=n(ie);r(ve);var le=a(a(ve,!0));Qt(le,"padding",`${D}px`);var _e=n(le);j(_e,()=>t(S),h=>{var L=v(()=>t(S)-D*5);ta(h,{get width(){return t(L)},get min_note(){return e.min_note},get max_note(){return e.max_note},max_height:300,pressed_keys:s,get highlighted_keys(){return t(k)},middle_c_label:!0,allow_sticking:!0,onpress:ee=>{p(ee),H(ee)},onrelease:ee=>{gt(ee)}})}),l(le);var ue=a(a(le,!0)),R=n(ue),N=n(R),J=a(a(N,!0));Oe(J,76,()=>Sa,(h,L)=>Q(h),(h,L,ee)=>{var de=$a(),ce={},Pe=n(de);l(de),B(()=>{ce!==(ce=Q(L))&&(de.value=(de.__value=Q(L))==null?"":Q(L)),ge(Pe,Q(L))}),d(h,de)}),l(J),l(R);var W=a(a(R,!0));Oe(W,77,()=>Ct,(h,L)=>Q(h).name,(h,L,ee)=>{var de=tr();de.__click=[er,te,L];var ce=n(de);l(de),B(()=>ge(ce,Q(L).name)),d(h,de)}),l(W);var K=a(a(W,!0));r(K);var T=a(a(K,!0)),z=n(T),X=n(z);He(X),X.__change=[ar,y],l(z),l(T),l(ue);var A=a(a(ue,!0)),P=n(A),F=n(P);Kt(F,{get instrument(){return i().instrument},set instrument(h){i().instrument=h}});var O=a(a(F,!0));Xt(O,{get volume(){return i().volume},set volume(h){i().volume=h}}),l(P);var Y=a(a(P,!0)),V=n(Y);Zt(V,{get midi_state(){return i()}}),l(Y),l(A),l(ie),B(()=>Qe(X,t(I))),Ha("innerWidth",h=>g(S,h)),Oa(J,()=>t(u),h=>g(u,h)),d(o,G),oe()}je(["click","change"]);var nr=(o,e)=>{var r;navigator.clipboard.writeText(e.text),(r=e.oncopy)==null||r.call(e)},or=c("copy to clipboard",1),ir=c('<button type="button" class="my_lg"><!></button>');function ht(o,e){ne(e,!0);var r=ir();r.__click=[nr,e];var i=n(r);j(i,()=>e.children,s=>{var _=ft(),b=fe(_);$t(b,()=>e.children),d(s,_)},s=>{var _=or();d(s,_)}),l(r),d(o,r),oe()}je(["click"]);const _r=(o,e,r,i,s)=>{g(e,"");try{const _=JSON.parse(t(r));_&&!_.id&&(_.id=Pa());const b=et.parse(_);i.onsubmit(b)}catch(_){console.error("failed to import data",_),g(e,M(_.message||"unknown error"))}g(s,!1)},sr=(o,e,r,i,s)=>{g(e,M(g(r,M(JSON.stringify(i()))))),g(s,!0)};var dr=c("editing level",1),cr=c("create a new level",1),vr=(o,e)=>g(e,Se(Ft(o.currentTarget.value))),ur=(o,e)=>g(e,!0),mr=c("the lowest note must be lower than the highest",1),gr=c("<!> <br>",1),br=(o,e)=>g(e,Se(Ht(o.currentTarget.value))),fr=(o,e)=>g(e,!0),hr=(o,e,r)=>e.onsubmit(r()),pr=c("save changes to level",1),yr=c("create level",1),kr=(o,e)=>g(e,!t(e)),wr=(o,e,r)=>{g(e,!1),r.onremove(r.level_data.id)},jr=c('<div><button type="button" class="color_c w_100 svelte-h4qokl">✕ confirm remove</button></div>'),xr=(o,e)=>e.onduplicate(e.level_data.id),zr=c('<button type="button" class="svelte-h4qokl">duplicate level</button>'),qr=c('<button type="button" class="svelte-h4qokl">remove level</button> <!> <!>',1),Ir=c("import/export data",1),Sr=c("import data",1),Ar=c("<pre> </pre>"),Pr=c('<div class="overflow_x_auto"><!></div>'),Tr=(o,e,r,i)=>e.onplay(t(r)?i():e.level_data,t(r)),Lr=c('<button type="button" class="svelte-h4qokl">play!</button>'),Er=(o,e)=>e.onclose(e.level_data.id),Mr=c("discard changes and stop editing",1),Dr=c("close level editor",1),Or=c('<button type="button" class="svelte-h4qokl"><!></button>'),Nr=c('<div class="importing bg shadow_d_xl p_xl width_md box svelte-h4qokl"><h2 class="my_0">import level data</h2> <!> <textarea class="svelte-h4qokl"></textarea> <button type="button" class="svelte-h4qokl">import project data</button></div>'),Rr=c('<div class="bg shadow_d_xl p_xl width_md box"><h2 class="my_0">pick intervals</h2> <!> <button type="button" class="svelte-h4qokl">cancel</button></div>'),Cr=c('<button type="button" class="mb_lg svelte-h4qokl">cancel</button>'),Fr=c('<div class="bg shadow_d_xl py_xl box"><h2 class="my_0">pick tonics</h2> <!></div>'),Vr=c(`<form class="level_def_form w_100"><header><h2 class="my_0"><!></h2></header> <div class="fields svelte-h4qokl"><fieldset><label><div class="title">name</div> <input></label></fieldset> <fieldset><label class="mb_0" title="the semitones to include relative to the tonic"><div class="title">intervals</div> <input></label> <button type="button" class="svelte-h4qokl">pick intervals</button> <details><summary>about <code>intervals</code></summary> <p><code>intervals</code> is a comma-separated list of numbers representing the <a href="https://wikipedia.org/wiki/Interval_(music)">musical intervals</a> used in the
					level, aka the number of piano keys (<a href="https://wikipedia.org/wiki/Semitone">semitones</a>) separating each note from the <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> (see below)</p> <p>for example, to practice distinguishing between the <a href="https://wikipedia.org/wiki/Perfect_fourth">perfect fourth</a> and <a href="https://wikipedia.org/wiki/Perfect_fifth">perfect fifth</a>, enter "<code>5, 7</code>"</p> <p>negative numbers are allowed</p></details></fieldset> <fieldset><label title="the number of trials per level"><div class="title">trial count</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset><label title="the number of notes per trial"><div class="title">sequence length</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset class="row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="number"> <input type="range"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="number"> <input type="range"></label></fieldset> <!> <fieldset><label class="mb_0" title="the possible starting notes for each trial"><div class="title">tonics</div> <input placeholder="all"></label> <button type="button" class="svelte-h4qokl">pick tonics</button> <details><summary>about <code>tonics</code></summary> <p>The <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> is like the "base" or "home"
					note, and for our purposes it's always the first note played in a trial. Other notes in the
					trial are calculated from the tonic and intervals. (see above)</p></details></fieldset> <button type="button" class="accent svelte-h4qokl"><!></button> <!> <button type="button" class="svelte-h4qokl"><!></button> <!> <!> <!></div></form> <!> <!> <!>`,1);function Hr(o,e){ne(e,!0);const r=$(e,"editing",3,!1),i=Ut();let s=E(!1),_=E(M(e.level_data.name));const b=v(()=>{var x;return(x=t(_))==null?void 0:x.trim()});let k=E(Se(e.level_data.intervals)),f=E(Se(e.level_data.tonics));const I=v(()=>t(f)?t(f).filter(x=>x>=t(w)&&x<=t(p)):t(f));let y=E(M(e.level_data.trial_count)),m=E(M(e.level_data.sequence_length)),w=E(M(e.level_data.min_note)),p=E(M(e.level_data.max_note));const u=()=>et.parse({id:e.level_data.id,name:t(b),intervals:t(k),tonics:t(I),trial_count:t(y),sequence_length:t(m),min_note:t(w),max_note:t(p)});De(()=>{g(_,M(e.level_data.name)),g(k,Se(e.level_data.intervals)),g(f,Se(e.level_data.tonics)),g(y,M(e.level_data.trial_count)),g(m,M(e.level_data.sequence_length)),g(w,M(e.level_data.min_note)),g(p,M(e.level_data.max_note))});const q=v(()=>t(b)!==e.level_data.name||t(y)!==e.level_data.trial_count||t(m)!==e.level_data.sequence_length||t(w)!==e.level_data.min_note||t(p)!==e.level_data.max_note||!Le(t(k),e.level_data.intervals)||!Le(t(I),e.level_data.tonics));let S=E(!1),D=E(!1),H=E(!1),te=E(""),G=E("");const Z=v(()=>t(te)!==t(G));let ie=E("");De(()=>{e.level_data,g(ie,"")});let ve=E(void 0),le=E(void 0),_e=E(void 0),ue=E(void 0);const R=v(()=>t(f)&&new Set(t(f)));let N=E(M(Rt)),J=E(1),W=E(void 0);const K=v(()=>t(w)>=t(p));var T=Vr(),z=fe(T),X=n(z),A=n(X),P=n(A);j(P,r,x=>{var C=dr();d(x,C)},x=>{var C=cr();d(x,C)}),l(A),l(X);var F=a(a(X,!0)),O=n(F),Y=n(O),V=n(Y),h=a(a(V,!0));we(h),l(Y),l(O);var L=a(a(O,!0)),ee=n(L),de=n(ee),ce=a(a(de,!0));Ae(ce,x=>g(_e,M(x)),()=>t(_e)),we(ce),B(()=>Qe(ce,mt(t(k)))),ce.__change=[vr,k],l(ee);var Pe=a(a(ee,!0));Pe.__click=[ur,D];var Be=a(a(Pe,!0)),qe=n(Be);a(n(qe)),l(qe);var ze=a(a(qe,!0)),rt=n(ze),aa=a(a(rt,!0)),ra=a(a(aa,!0));a(a(ra,!0)),Te(),l(ze);var lt=a(a(ze,!0)),la=a(n(lt)),na=a(a(la,!0));a(a(na,!0)),Te(),l(lt),a(a(lt,!0)),l(Be),l(L);var nt=a(a(L,!0)),pt=n(nt),oa=n(pt),yt=a(a(oa,!0)),Je=n(yt);we(Je),U(Je,"min",1);var Ue=a(a(Je,!0));we(Ue),U(Ue,"min",1),U(Ue,"max",20),l(yt),l(pt),l(nt);var ot=a(a(nt,!0)),kt=n(ot),ia=n(kt),wt=a(a(ia,!0)),We=n(wt);we(We),U(We,"min",2);var Ye=a(a(We,!0));we(Ye),U(Ye,"min",2),U(Ye,"max",16),l(wt),l(kt),l(ot);var it=a(a(ot,!0)),_t=n(it),_a=n(_t),st=a(a(_a,!0)),sa=n(st);l(st);var Ee=a(a(st,!0));we(Ee),U(Ee,"step",1),U(Ee,"min",Xe),U(Ee,"max",Ze);var Ne=a(a(Ee,!0));we(Ne),U(Ne,"step",1),U(Ne,"min",Xe),U(Ne,"max",Ze),l(_t);var jt=a(a(_t,!0)),da=n(jt),dt=a(a(da,!0)),ca=n(dt);l(dt);var Me=a(a(dt,!0));we(Me),U(Me,"step",1),U(Me,"min",Xe),U(Me,"max",Ze);var Re=a(a(Me,!0));we(Re),U(Re,"step",1),U(Re,"min",Xe),U(Re,"max",Ze),l(jt),l(it);var xt=a(a(it,!0));j(xt,()=>t(K),x=>{$e(x,{status:"error",children:(C,re)=>{Te();var ae=mr();d(C,ae)},$$slots:{default:!0}})},x=>{var C=gr(),re=fe(C),ae=v(()=>t(W)??0);ta(re,{get width(){return t(ae)},max_height:50,get min_note(){return t(w)},get max_note(){return t(p)},get highlighted_keys(){return t(R)},clickable:!1,middle_c_label:!0}),a(a(re,!0)),d(x,C)});var Ge=a(a(xt,!0)),ct=n(Ge),va=n(ct),Ke=a(a(va,!0));Ae(Ke,x=>g(ue,M(x)),()=>t(ue)),we(Ke),B(()=>Qe(Ke,bt(t(f)))),Ke.__change=[br,f],l(ct);var zt=a(a(ct,!0));zt.__click=[fr,H];var qt=a(a(zt,!0)),vt=n(qt);a(n(vt)),l(vt);var It=a(a(vt,!0));a(n(It)),Te(),l(It),l(qt),l(Ge);var Ce=a(a(Ge,!0));Ce.__click=[hr,e,u];var ua=n(Ce);j(ua,r,x=>{var C=pr();d(x,C)},x=>{var C=yr();d(x,C)}),l(Ce);var St=a(a(Ce,!0));j(St,()=>e.onremove&&r(),x=>{var C=qr(),re=fe(C);re.__click=[kr,s];var ae=a(a(re,!0));j(ae,()=>t(s),ke=>{var se=jr(),Ie=n(se);Ie.__click=[wr,s,e],l(se),pe(3,se,()=>ye),d(ke,se)});var me=a(a(ae,!0));j(me,()=>e.onduplicate,ke=>{var se=zr();se.__click=[xr,e],d(ke,se)}),d(x,C)});var Fe=a(a(St,!0));Ae(Fe,x=>g(le,M(x)),()=>t(le)),Fe.__click=[sr,te,G,u,S];var ma=n(Fe);j(ma,r,x=>{var C=Ir();d(x,C)},x=>{var C=Sr();d(x,C)}),l(Fe);var At=a(a(Fe,!0));j(At,()=>t(ie),x=>{var C=Pr(),re=n(C);$e(re,{status:"error",children:(ae,me)=>{var ke=Ar(),se=n(ke);l(ke),B(()=>ge(se,t(ie))),d(ae,ke)},$$slots:{default:!0}}),l(C),d(x,C)});var Pt=a(a(At,!0));j(Pt,()=>e.onplay&&r(),x=>{var C=Lr();C.__click=[Tr,e,q,u],d(x,C)});var ga=a(a(Pt,!0));j(ga,()=>e.onclose&&r(),x=>{var C=Or();C.__click=[Er,e];var re=n(C);j(re,()=>t(q),ae=>{var me=Mr();d(ae,me)},ae=>{var me=Dr();d(ae,me)}),l(C),d(x,C)}),l(F),l(z);var Tt=a(a(z,!0));j(Tt,()=>t(S),x=>{Ve(x,{onclose:()=>{var C;g(S,!1),(C=t(le))==null||C.focus()},children:(C,re)=>{var ae=Nr(),me=n(ae),ke=a(a(me,!0));ht(ke,{get text(){return t(G)},oncopy:()=>{var xe;(xe=t(ve))==null||xe.select()}});var se=a(a(ke,!0));Ae(se,xe=>g(ve,M(xe)),()=>t(ve)),He(se);var Ie=a(a(se,!0));Ie.__click=[_r,ie,G,e,S],l(ae),B(()=>{Ie.disabled=!t(Z),U(Ie,"title",t(Z)?void 0:"data has not changed")}),he(se,()=>t(G),xe=>g(G,xe)),d(C,ae)},$$slots:{default:!0}})});var Lt=a(a(Tt,!0));j(Lt,()=>t(D),x=>{Ve(x,{onclose:()=>{var re;g(D,!1),(re=t(_e))==null||re.focus()},children:(re,ae=Mt)=>{var me=Rr(),ke=n(me),se=a(a(ke,!0));Ga(se,{get intervals(){return t(k)},get scale(){return t(N)},set scale(xe){g(N,M(xe))},get octaves(){return t(J)},set octaves(xe){g(J,M(xe))},oninput:xe=>{g(k,Se(xe)),ae()()}});var Ie=a(a(se,!0));Ie.__click=ae(),l(me),d(re,me)}})});var ba=a(a(Lt,!0));j(ba,()=>t(H),x=>{Ve(x,{onclose:()=>{var re;g(H,!1),(re=t(ue))==null||re.focus()},children:(re,ae=Mt)=>{var me=Fr(),ke=n(me),se=a(a(ke,!0)),Ie=v(()=>new Set(t(f)));lr(se,{audio_state:i,get notes(){return t(Ie)},get min_note(){return t(w)},get max_note(){return t(p)},oninput:ut=>{g(f,Se(ut)),ae()()},before_buttons:ut=>{var Et=Cr();Et.__click=ae(),d(ut,Et)}}),l(me),d(re,me)}})}),B(()=>{ge(sa,Dt[t(w)]),ge(ca,Dt[t(p)]),Ce.disabled=r()&&!t(q)||t(K)}),he(h,()=>t(_),x=>g(_,x)),he(Je,()=>t(y),x=>g(y,x)),he(Ue,()=>t(y),x=>g(y,x)),he(We,()=>t(m),x=>g(m,x)),he(Ye,()=>t(m),x=>g(m,x)),he(Ee,()=>t(w),x=>g(w,x)),he(Ne,()=>t(w),x=>g(w,x)),he(Me,()=>t(p),x=>g(p,x)),he(Re,()=>t(p),x=>g(p,x)),Ra(Ge,"clientWidth",x=>g(W,x)),d(o,T),oe()}je(["change","click"]);var Br=(o,e,r)=>e()(r.project.id),Jr=c('<button type="button" class="flex_1"> </button>'),Ur=(o,e,r,i,s)=>{var _,b;return t(e)?(_=r())==null?void 0:_(i.project.id):(b=s())==null?void 0:b(i.project_data??i.load(i.project.id))},Wr=c("✕",1),Yr=c("✎",1),Gr=c('<button type="button" class="icon_button plain_button size_xl deselectable svelte-12y7az0"><!></button>'),Kr=(o,e)=>g(e,!t(e)),Xr=c("×",1),Zr=c("✕",1),Qr=c('<button type="button" class="icon_button plain_button size_xl svelte-12y7az0"><!></button>'),$r=c('<li class="project_item svelte-12y7az0"><!> <!> <!></li>');function el(o,e){ne(e,!0);const r=$(e,"select",3,null),i=$(e,"edit",3,null),s=$(e,"remove",3,null);let _=E(!1);var b=$r(),k=n(b);j(k,r,y=>{var m=Jr();m.__click=[Br,r,e];var w=n(m);l(m),B(()=>{be(m,"selected",e.selected),ge(w,e.project.name)}),d(y,m)});var f=a(a(k,!0));j(f,()=>(t(_)&&s())??(!t(_)&&i()),y=>{var m=Gr();m.__click=[Ur,_,s,e,i];var w=n(m);j(w,()=>t(_),p=>{var u=Wr();d(p,u)},p=>{var u=Yr();d(p,u)}),l(m),B(()=>{U(m,"title",t(_)?"remove project":"edit project"),be(m,"selected",e.selected&&!t(_)&&e.editing),be(m,"color_c",t(_))}),d(y,m)});var I=a(a(f,!0));j(I,s,y=>{var m=Qr();m.__click=[Kr,_];var w=n(m);j(w,()=>t(_),p=>{var u=Xr();d(p,u)},p=>{var u=Zr();d(p,u)}),l(m),B(()=>U(m,"title",t(_)?"cancel removing":"remove project")),d(y,m)}),l(b),B(()=>be(b,"selected",e.selected)),pe(3,b,()=>ye),d(o,b),oe()}je(["click"]);var tl=c('<menu class="unstyled width_sm mb_0"></menu>');function al(o,e){ne(e,!0);const r=$(e,"selected_project_id",3,null),i=$(e,"editing_project_id",3,null),s=$(e,"projects",11,()=>[]),_=$(e,"project_datas",11,()=>[]);var b=tl();Oe(b,77,s,(k,f)=>Q(k).id,(k,f,I)=>{var y=v(()=>_().find(p=>p.id===Q(f).id)),m=v(()=>Q(f).id===r()),w=v(()=>Q(f).id===i());el(k,{get project(){return Q(f)},get project_data(){return t(y)},get load(){return e.load_project},get select(){return e.select_project},get edit(){return e.edit_project},get remove(){return e.remove_project},get selected(){return t(m)},get editing(){return t(w)}})}),l(b),d(o,b),oe()}var rl=(o,e,r,i)=>{t(e)?r().editing_project=!1:t(i)(tt.parse({}))},ll=c('<div class="panel p_md"><header><h2 class="my_0">projects</h2></header> <!> <button type="button" class="w_100 mt_md deselectable">create a new project</button></div>');function nl(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{load_project:H,select_project:te,edit_project:G,remove_project:Z}=t(i);return[H,te,G,Z]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>t(s)[3]),I=v(()=>r().editing_project&&r().selected_project_id!==r().editing_project_id),y=v(()=>r().app_data),m=v(()=>{let{projects:H}=t(y);return[H]}),w=v(()=>t(m)[0]);var p=ll(),u=n(p);n(u),l(u);var q=a(a(u,!0)),S=v(()=>r().editing_project?r().editing_project_id:null);al(q,{get selected_project_id(){return r().selected_project_id},get editing_project_id(){return t(S)},get projects(){return t(w)},get project_datas(){return r().project_datas},get load_project(){return t(_)},get select_project(){return t(b)},edit_project:H=>t(k)(H===r().editing_project_data&&r().editing_project?null:H),get remove_project(){return t(f)}});var D=a(a(q,!0));D.__click=[rl,I,r,k],l(p),B(()=>be(D,"selected",t(I))),d(o,p),oe()}je(["click"]);var ol=(o,e)=>e.toggle(),il=c(`<aside>devices with smaller screens aren't well supported yet, see <a href="https://github.com/ryanatkn/earbetter/issues/2">issue #2</a></aside> <table><tbody><tr><td class="svelte-1gwge1y"><code>Spacebar</code></td><td class="svelte-1gwge1y">replay trial</td></tr><tr><td class="svelte-1gwge1y"><code>r</code></td><td class="svelte-1gwge1y">restart level</td></tr><tr><td class="svelte-1gwge1y"><code>Escape</code></td><td class="svelte-1gwge1y"><button type="button" class="inline">toggle main menu</button></td></tr><tr><td class="svelte-1gwge1y"><code>1 to 4</code></td><td class="svelte-1gwge1y">set instrument</td></tr><tr><td class="svelte-1gwge1y"><code>c</code></td><td class="svelte-1gwge1y">connect MIDI</td></tr><tr><td class="svelte-1gwge1y"><code>up/down arrows</code></td><td class="svelte-1gwge1y">adjust volume</td></tr></tbody></table>`,1);function _l(o,e){ne(e,!0);const r=ja();var i=il(),s=fe(i);a(n(s)),l(s);var _=a(a(s,!0)),b=n(_),k=n(b),f=n(k);n(f),l(f),a(f),l(k);var I=a(k),y=n(I);n(y),l(y),a(y),l(I);var m=a(I),w=n(m);n(w),l(w);var p=a(w),u=n(p);u.__click=[ol,r],Qt(u,"min-width","172px"),l(p),l(m);var q=a(m),S=n(q);n(S),l(S),a(S),l(q);var D=a(q),H=n(D);n(H),l(H),a(H),l(D);var te=a(D),G=n(te);n(G),l(G),a(G),l(te),l(b),l(_),d(o,i),oe()}je(["click"]);var sl=c('<div class="realm_stats_summary svelte-1mwdoug" title="you performed flawlessly in every level of this realm!">★</div>');function dl(o,e){ne(e,!0);const r=v(()=>e.realm_data.levels.map(y=>e.level_stats.mistakes[y.id]??[])),i=v(()=>t(r).reduce((y,m)=>y+m.length,0)),s=v(()=>Wt*t(r).length),_=v(()=>!!t(i)&&t(i)>=t(s)),b=v(()=>t(_)?t(r).reduce((y,m)=>y+m.reduce((w,p)=>w+p,0),0):void 0),k=v(()=>t(b)===0);var f=ft(),I=fe(f);j(I,()=>t(k),y=>{var m=sl();d(y,m)}),d(o,f),oe()}var cl=(o,e,r)=>e()(r.realm_data.id),vl=c('<button type="button" class="realm_button svelte-1joa4ch"> </button>'),ul=(o,e,r,i,s)=>{var _,b;return t(e)?(_=r())==null?void 0:_(i.realm_data.id):(b=s())==null?void 0:b(i.realm_data)},ml=c("✕",1),gl=c("✎",1),bl=c('<button type="button" class="icon_button plain_button size_xl deselectable svelte-1joa4ch"><!></button>'),fl=(o,e)=>g(e,!t(e)),hl=c("×",1),pl=c("✕",1),yl=c('<button type="button" class="icon_button plain_button size_xl svelte-1joa4ch"><!></button>'),kl=c('<li class="realm_item svelte-1joa4ch"><!> <!> <!> <!></li>');function wl(o,e){ne(e,!0);const r=$(e,"select",3,null),i=$(e,"edit",3,null),s=$(e,"remove",3,null);let _=E(!1);const b=v(()=>e.project_data.level_stats);var k=kl(),f=n(k);j(f,()=>t(b),p=>{dl(p,{get realm_data(){return e.realm_data},get level_stats(){return t(b)}})});var I=a(a(f,!0));j(I,r,p=>{var u=vl();u.__click=[cl,r,e];var q=n(u);l(u),B(()=>{be(u,"selected",e.selected),ge(q,e.realm_data.name)}),d(p,u)});var y=a(I,!0);y.nodeValue="  ";var m=a(y);j(m,()=>t(_)&&s()||!t(_)&&i(),p=>{var u=bl();u.__click=[ul,_,s,e,i];var q=n(u);j(q,()=>t(_),S=>{var D=ml();d(S,D)},S=>{var D=gl();d(S,D)}),l(u),B(()=>{U(u,"title",t(_)?"remove realm":e.editing?"stop editing realm":"edit realm"),be(u,"selected",e.selected&&!t(_)&&e.editing),be(u,"color_c",t(_))}),d(p,u)});var w=a(a(m,!0));j(w,s,p=>{var u=yl();u.__click=[fl,_];var q=n(u);j(q,()=>t(_),S=>{var D=hl();d(S,D)},S=>{var D=pl();d(S,D)}),l(u),B(()=>U(u,"title",t(_)?"cancel removing":"remove realm")),d(p,u)}),l(k),B(()=>be(k,"selected",e.selected)),pe(3,k,()=>ye),d(o,k),oe()}je(["click"]);var jl=c('<menu class="unstyled width_sm mb_0"></menu>');function xl(o,e){ne(e,!0);const r=$(e,"selected_realm_data",3,null),i=$(e,"editing_realm_id",3,null),s=$(e,"realms",11,()=>[]),_=v(()=>new Map(s().map(f=>[f.id,f]))),b=f=>t(_).get(f);var k=jl();Oe(k,77,s,(f,I)=>Q(f).id,(f,I,y)=>{var m=v(()=>b(Q(I).id)),w=v(()=>{var u;return Q(I).id===((u=r())==null?void 0:u.id)}),p=v(()=>Q(I).id===i());wl(f,{get realm_data(){return t(m)},get project_data(){return e.project_data},get select(){return e.select_realm},get edit(){return e.edit_realm},get remove(){return e.remove_realm},get selected(){return t(w)},get editing(){return t(p)}})}),l(k),d(o,k),oe()}const zl=(o,e,r,i,s)=>{var _;t(e)?(_=document.querySelector(".realm_def_form input"))==null||_.focus():t(r)?i().editing_realm=!1:t(s)(at.parse({}))};var ql=c("<div><!></div>"),Il=c('<div class="panel p_md"><header><h2 class="my_0">realms</h2></header> <!> <button type="button">create a new realm</button></div>');function Sl(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{select_realm:u,edit_realm:q,remove_realm:S}=t(i);return[u,q,S]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>{var u;return r().editing_realm&&!!r().editing_realm_data&&((u=r().selected_realm_data)==null?void 0:u.id)!==r().editing_realm_data.id}),I=v(()=>{var u;return!((u=r().realms)!=null&&u.length)});var y=Il(),m=n(y);n(m),l(m);var w=a(a(m,!0));j(w,()=>r().realms&&r().selected_project_data,u=>{var q=ql(),S=n(q),D=v(()=>r().editing_realm?r().editing_realm_id:null);xl(S,{get project_data(){return r().selected_project_data},get selected_realm_data(){return r().selected_realm_data},get realms(){return r().realms},get editing_realm_id(){return t(D)},get select_realm(){return t(_)},edit_realm:H=>t(b)(H===r().editing_realm_data&&r().editing_realm?null:H),get remove_realm(){return t(k)}}),l(q),pe(3,q,()=>ye),d(u,q)});var p=a(a(w,!0));p.__click=[zl,I,f,r,b],l(y),B(()=>{Na(p,`${(t(I)?void 0:"deselectable")??""} svelte-100yq62`),be(p,"selected",t(f)||t(I))}),d(o,y),oe()}je(["click"]);const Al=(o,e,r,i,s)=>{g(e,"");try{const _=JSON.parse(t(r));_&&!_.id&&(_.id=Ta());const b=at.parse(_);i.onsubmit(b)}catch(_){console.error("failed to import data",_),g(e,M(_.message||"unknown error"))}g(s,!1)},Pl=(o,e,r,i,s)=>{g(e,M(g(r,M(JSON.stringify(i()))))),g(s,!0)};var Tl=c('<div class="importing bg shadow_d_xl p_xl width_md box svelte-1g446ss"><h2 class="my_0">import realm data</h2> <!> <textarea class="svelte-1g446ss"></textarea> <button type="button" class="svelte-1g446ss">import realm data</button></div>'),Ll=c("editing realm",1),El=c("create a new realm",1),Ml=(o,e,r)=>{o.key==="Enter"&&(Gt(o),e.onsubmit(r()))},Dl=(o,e,r)=>e.onsubmit(r()),Ol=c("save changes to realm",1),Nl=c("create realm",1),Rl=(o,e)=>g(e,!t(e)),Cl=(o,e,r)=>{g(e,!1),r.onremove(r.realm_data.id)},Fl=c('<div><button type="button" class="color_c w_100 svelte-1g446ss">✕ confirm remove</button></div>'),Vl=(o,e)=>e.onduplicate(e.realm_data.id),Hl=c('<button type="button" class="svelte-1g446ss">duplicate realm</button>'),Bl=c('<button type="button" class="svelte-1g446ss">remove realm</button> <!> <!>',1),Jl=c("import/export data",1),Ul=c("import data",1),Wl=(o,e)=>g(e,!t(e)),Yl=(o,e,r)=>{g(e,!1),r.onsubmit(Yt().realms)},Gl=c('<div><button type="button" class="w_100 svelte-1g446ss"> </button></div>'),Kl=c('<button type="button" class="svelte-1g446ss">create default realms</button> <!>',1),Xl=c("<pre> </pre>"),Zl=c('<div class="message-wrapper svelte-1g446ss"><!></div>'),Ql=(o,e)=>e.onclose(e.realm_data.id),$l=c("discard changes",1),en=c("close realm editor",1),tn=c('<button class="w_100 svelte-1g446ss" type="button"><!></button>'),an=c('<!> <form class="realm_def_form"><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent svelte-1g446ss"><!></button> <!> <button type="button" class="svelte-1g446ss"><!></button> <!> <!> <!></form>',1);function rn(o,e){ne(e,!0);const r=$(e,"editing",3,!1);let i=E(!1),s=E(M(e.realm_data.name));const _=v(()=>{var A;return(A=t(s))==null?void 0:A.trim()}),b=()=>at.parse({id:e.realm_data.id,name:t(_),levels:e.realm_data.levels});De(()=>{console.log("set_realm_data",e.realm_data),g(s,M(e.realm_data.name))});const k=v(()=>t(_)!==e.realm_data.name);let f=E(!1),I=E(""),y=E("");const m=v(()=>t(I)!==t(y));let w=E("");De(()=>{e.realm_data,g(w,"")});let p=E(void 0),u=E(void 0);const q=Yt().realms;let S=E(!1);var D=an(),H=fe(D);j(H,()=>t(f),A=>{Ve(A,{onclose:()=>{var P;g(f,!1),(P=t(u))==null||P.focus()},children:(P,F)=>{var O=Tl(),Y=n(O),V=a(a(Y,!0));ht(V,{get text(){return t(y)},oncopy:()=>{var ee;(ee=t(p))==null||ee.select()}});var h=a(a(V,!0));Ae(h,ee=>g(p,M(ee)),()=>t(p)),He(h);var L=a(a(h,!0));L.__click=[Al,w,y,e,f],l(O),B(()=>{L.disabled=!t(m),U(L,"title",t(m)?void 0:"data has not changed")}),he(h,()=>t(y),ee=>g(y,ee)),d(P,O)},$$slots:{default:!0}})});var te=a(a(H,!0)),G=n(te),Z=n(G),ie=n(Z);j(ie,r,A=>{var P=Ll();d(A,P)},A=>{var P=El();d(A,P)}),l(Z),l(G);var ve=a(a(G,!0)),le=n(ve),_e=n(le),ue=a(a(_e,!0));we(ue),ue.__keydown=[Ml,e,b],l(le),l(ve);var R=a(a(ve,!0));R.__click=[Dl,e,b];var N=n(R);j(N,r,A=>{var P=Ol();d(A,P)},A=>{var P=Nl();d(A,P)}),l(R);var J=a(a(R,!0));j(J,()=>e.onremove&&r(),A=>{var P=Bl(),F=fe(P);F.__click=[Rl,i];var O=a(a(F,!0));j(O,()=>t(i),V=>{var h=Fl(),L=n(h);L.__click=[Cl,i,e],l(h),pe(3,h,()=>ye),d(V,h)});var Y=a(a(O,!0));j(Y,()=>e.onduplicate,V=>{var h=Hl();h.__click=[Vl,e],d(V,h)}),d(A,P)});var W=a(a(J,!0));Ae(W,A=>g(u,M(A)),()=>t(u)),W.__click=[Pl,I,y,b,f];var K=n(W);j(K,r,A=>{var P=Jl();d(A,P)},A=>{var P=Ul();d(A,P)}),l(W);var T=a(a(W,!0));j(T,()=>!r(),A=>{var P=Kl(),F=fe(P);F.__click=[Wl,S];var O=a(a(F,!0));j(O,()=>t(S),Y=>{var V=Gl(),h=n(V);h.__click=[Yl,S,e];var L=n(h);l(h),l(V),B(()=>ge(L,`create ${q.length??""} new realms`)),pe(3,V,()=>ye),d(Y,V)}),d(A,P)});var z=a(a(T,!0));j(z,()=>t(w),A=>{var P=Zl(),F=n(P);$e(F,{status:"error",children:(O,Y)=>{var V=Xl(),h=n(V);l(V),B(()=>ge(h,t(w))),d(O,V)},$$slots:{default:!0}}),l(P),d(A,P)});var X=a(a(z,!0));j(X,()=>e.onclose&&r(),A=>{var P=tn();P.__click=[Ql,e];var F=n(P);j(F,()=>t(k),O=>{var Y=$l();d(O,Y)},O=>{var Y=en();d(O,Y)}),l(P),d(A,P)}),l(te),B(()=>R.disabled=r()&&!t(k)),he(ue,()=>t(s),A=>g(s,A)),d(o,D),oe()}je(["click","keydown"]);var ln=c('<div class="panel p_md"><!></div>');function nn(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{remove_realm:u,duplicate_realm:q,update_realm:S,create_realm:D}=t(i);return[u,q,S,D]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>t(s)[3]),I=v(()=>r().editing_realm_data??at.parse({})),y=v(()=>r().realms?r().realms.some(u=>u.id===t(I).id):!1),m=(u,q)=>{var S;(S=r().realms)!=null&&S.some(D=>D.id===u.id)?t(k)(u):t(f)(u,q)};var w=ln(),p=n(w);rn(p,{get editing(){return t(y)},get realm_data(){return t(I)},onsubmit:u=>{if(Array.isArray(u))for(let q=0;q<u.length;q++)m(u[q],q===0);else m(u,!0)},onremove:u=>t(_)(u),onduplicate:u=>t(b)(u),onclose:()=>r().editing_realm=!1}),l(w),d(o,w),oe()}var on=(o,e)=>e.app.play_level(e.level_data.id),_n=(o,e,r,i)=>t(e)?r.app.remove_level(r.level_data.id):r.app.edit_level(t(i)?null:r.level_data),sn=c("✕",1),dn=c("✎",1),cn=(o,e)=>g(e,!t(e)),vn=c("×",1),un=c("✕",1),mn=c('<li class="level_map_item svelte-170pvnv"><!> <button type="button" class="level_button deselectable svelte-170pvnv" title="play this level"> </button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button></li>');function gn(o,e){ne(e,!0);const r=v(()=>e.app.draft_level_data===e.level_data),i=v(()=>e.app.editing_level&&t(r)),s=v(()=>{var q;return(q=e.app.selected_project_data)==null?void 0:q.level_stats});let _=E(!1);const b=v(()=>t(i)||t(r));var k=mn(),f=n(k);j(f,()=>t(s),q=>{Va(q,{get level_data(){return e.level_data},get level_stats(){return t(s)}})});var I=a(a(f,!0));I.__click=[on,e];var y=n(I);l(I);var m=a(a(I,!0));m.__click=[_n,_,e,i];var w=n(m);j(w,()=>t(_),q=>{var S=sn();d(q,S)},q=>{var S=dn();d(q,S)}),l(m);var p=a(a(m,!0));p.__click=[cn,_];var u=n(p);j(u,()=>t(_),q=>{var S=vn();d(q,S)},q=>{var S=un();d(q,S)}),l(p),l(k),B(()=>{be(k,"selected",t(b)),be(I,"selected",t(b)),ge(y,e.level_data.name),U(m,"title",t(_)?"remove level":t(i)?"stop editing level":"edit level"),be(m,"selected",!t(_)&&t(i)),be(m,"color_c",t(_)),U(p,"title",t(_)?"cancel removing":"remove level")}),pe(3,k,()=>ye),d(o,k),oe()}je(["click"]);const bn=(o,e,r,i)=>{var s;t(e)?(s=document.querySelector(".level_def_form input"))==null||s.focus():r.app.edit_level(t(i)?null:et.parse({}))};var fn=c('<div class="panel p_md"><header><h2 class="my_0">levels</h2> <h3 class="my_0"> </h3></header> <menu class="levels unstyled mb_0 svelte-wmjxbn"></menu> <button type="button" class="svelte-wmjxbn">create a new level</button></div>');function hn(o,e){ne(e,!0);const r=v(()=>e.app.editing_level&&!e.levels.some(m=>m===e.app.draft_level_data)),i=v(()=>!e.levels.length);var s=fn(),_=n(s),b=n(_),k=a(a(b,!0)),f=n(k);l(k),l(_);var I=a(a(_,!0));Oe(I,77,()=>e.levels,(m,w)=>Q(m).id,(m,w,p)=>{gn(m,{get app(){return e.app},get level_data(){return Q(w)}})}),l(I);var y=a(a(I,!0));y.__click=[bn,i,e,r],l(s),B(()=>{var m;ge(f,(m=e.app.selected_realm_data)==null?void 0:m.name),be(y,"selected",t(r)||t(i)),be(y,"deselectable",!t(i))}),d(o,s),oe()}je(["click"]);const pn=(o,e,r,i,s)=>{g(e,"");try{const _=JSON.parse(t(r));_&&!_.id&&(_.id=La());const b=tt.parse(_);i.onsubmit(b)}catch(_){console.error("failed to import data",_),g(e,M(_.message||"unknown error"))}g(s,!1)},yn=(o,e,r,i,s)=>{g(e,M(g(r,M(JSON.stringify(i()))))),g(s,!0)};var kn=c('<div class="importing bg shadow_d_xl p_xl width_md box svelte-l3tcx7"><h2 class="my_0">import project data</h2> <!> <textarea class="svelte-l3tcx7"></textarea> <button type="button" class="svelte-l3tcx7">import project data</button></div>'),wn=c("editing project",1),jn=c("create a new project",1),xn=(o,e,r)=>{o.key==="Enter"&&(Gt(o),e.onsubmit(r()))},zn=(o,e,r)=>e.onsubmit(r()),qn=c("save changes to project",1),In=c("create project",1),Sn=(o,e)=>g(e,!t(e)),An=(o,e,r)=>{g(e,!1),r.onremove(r.project_data.id)},Pn=c('<div><button type="button" class="color_c w_100 svelte-l3tcx7">✕ confirm remove</button></div>'),Tn=(o,e)=>e.onduplicate(e.project_data.id),Ln=c('<button type="button" class="w_100 svelte-l3tcx7">duplicate project</button>'),En=c('<button class="w_100 svelte-l3tcx7" type="button">remove project</button> <!> <!>',1),Mn=c("import/export data",1),Dn=c("import data",1),On=c("<pre> </pre>"),Nn=c('<div class="overflow_x_auto"><!></div>'),Rn=(o,e)=>e.onclose(e.project_data.id),Cn=c("discard changes and stop editing",1),Fn=c("close project editor",1),Vn=c('<button type="button" class="w_100 svelte-l3tcx7"><!></button>'),Hn=c('<!> <form><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent w_100 svelte-l3tcx7"><!></button> <!> <button type="button" class="w_100 svelte-l3tcx7"><!></button> <!> <!></form>',1);function Bn(o,e){ne(e,!0);const r=$(e,"editing",3,!1);let i=E(!1),s=E(M(e.project_data.name));const _=v(()=>t(s).trim()),b=()=>tt.parse({id:e.project_data.id,name:t(_),realms:e.project_data.realms,level_stats:e.project_data.level_stats});De(()=>{console.log("set_project_data",e.project_data),g(s,M(e.project_data.name))});const k=v(()=>t(_)!==e.project_data.name);let f=E(!1),I=E(""),y=E("");const m=v(()=>t(I)!==t(y));let w=E("");De(()=>{e.project_data,g(w,"")});let p=E(void 0),u=E(void 0);var q=Hn(),S=fe(q);j(S,()=>t(f),T=>{Ve(T,{onclose:()=>{var z;g(f,!1),(z=t(u))==null||z.focus()},children:(z,X)=>{var A=kn(),P=n(A),F=a(a(P,!0));ht(F,{get text(){return t(y)},oncopy:()=>{var V;(V=t(p))==null||V.select()}});var O=a(a(F,!0));Ae(O,V=>g(p,M(V)),()=>t(p)),He(O);var Y=a(a(O,!0));Y.__click=[pn,w,y,e,f],l(A),B(()=>{Y.disabled=!t(m),U(Y,"title",t(m)?void 0:"data has not changed")}),he(O,()=>t(y),V=>g(y,V)),d(z,A)},$$slots:{default:!0}})});var D=a(a(S,!0)),H=n(D),te=n(H),G=n(te);j(G,r,T=>{var z=wn();d(T,z)},T=>{var z=jn();d(T,z)}),l(te),l(H);var Z=a(a(H,!0)),ie=n(Z),ve=n(ie),le=a(a(ve,!0));we(le),le.__keydown=[xn,e,b],l(ie),l(Z);var _e=a(a(Z,!0));_e.__click=[zn,e,b];var ue=n(_e);j(ue,r,T=>{var z=qn();d(T,z)},T=>{var z=In();d(T,z)}),l(_e);var R=a(a(_e,!0));j(R,()=>e.onremove&&r(),T=>{var z=En(),X=fe(z);X.__click=[Sn,i];var A=a(a(X,!0));j(A,()=>t(i),F=>{var O=Pn(),Y=n(O);Y.__click=[An,i,e],l(O),pe(3,O,()=>ye),d(F,O)});var P=a(a(A,!0));j(P,()=>e.onduplicate,F=>{var O=Ln();O.__click=[Tn,e],d(F,O)}),d(T,z)});var N=a(a(R,!0));Ae(N,T=>g(u,M(T)),()=>t(u)),N.__click=[yn,I,y,b,f];var J=n(N);j(J,r,T=>{var z=Mn();d(T,z)},T=>{var z=Dn();d(T,z)}),l(N);var W=a(a(N,!0));j(W,()=>t(w),T=>{var z=Nn(),X=n(z);$e(X,{status:"error",children:(A,P)=>{var F=On(),O=n(F);l(F),B(()=>ge(O,t(w))),d(A,F)},$$slots:{default:!0}}),l(z),d(T,z)});var K=a(a(W,!0));j(K,()=>e.onclose&&r(),T=>{var z=Vn();z.__click=[Rn,e];var X=n(z);j(X,()=>t(k),A=>{var P=Cn();d(A,P)},A=>{var P=Fn();d(A,P)}),l(z),d(T,z)}),l(D),B(()=>_e.disabled=r()&&!t(k)),he(le,()=>t(s),T=>g(s,T)),d(o,q),oe()}je(["click","keydown"]);var Jn=c('<div class="panel p_md"><!></div>');function Un(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{remove_project:u,duplicate_project:q,update_project:S,create_project:D}=t(i);return[u,q,S,D]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>t(s)[3]),I=v(()=>r().editing_project_data??tt.parse({})),y=v(()=>r().project_datas.some(u=>u.id===t(I).id));var m=Jn(),w=n(m),p=v(()=>t(y)?t(k):t(f));Bn(w,{get editing(){return t(y)},get project_data(){return t(I)},get onsubmit(){return t(p)},get onremove(){return t(_)},get onduplicate(){return t(b)},onclose:()=>r().editing_project=!1}),l(m),d(o,m),oe()}var Wn=c('<section class="card svelte-8muejm"><!></section>'),Yn=c('<section class="card svelte-8muejm"><!></section>'),Gn=c('<div class="width_sm svelte-8muejm"><!> <!> <section class="card svelte-8muejm"><div class="panel p_md"><header><h2 class="my_0">controls</h2></header> <!> <div class="mb_lg"><!></div> <!> <aside>Earbetter supports MIDI devices like piano keyboards, connect and click:</aside> <!></div></section></div>'),Kn=(o,e)=>t(e)(),Xn=c(`<section class="card svelte-8muejm"><div class="panel p_md"><p>Earbetter is an <a href="https://wikipedia.org/wiki/Ear_training">ear training</a> tool:</p> <ul><li>each level is a standalone challenge that's a series of trials</li> <li> </li> <li>realms group levels into bigger challenges</li> <li>projects group realms so you can customize various experiences</li> <li>levels can be shared via their links or exporting/importing data</li></ul> <p>See also the 3 minute <a href="https://www.youtube.com/watch?v=zW2zI1A_Ikw">video intro on YouTube</a> and <a href="https://github.com/ryanatkn/earbetter">the readme</a>.</p> <aside>Earbetter is in early development, and many things are unfinished and unknown - feedback
						is appreciated on <a href="https://github.com/ryanatkn/earbetter">the GitHub discussions and issues</a>.</aside> <div class="box row"><button type="button" class="m_0">ok, hide this</button></div></div></section>`),Zn=c('<section class="card svelte-8muejm"><!></section>'),Qn=c('<section class="card svelte-8muejm"><!></section>'),$n=c('<section class="card svelte-8muejm"><div class="panel p_md"><!></div></section>'),eo=c('<div class="width_sm svelte-8muejm"><!> <!></div>'),to=c('<!> <div class="map svelte-8muejm"><!> <div class="width_sm svelte-8muejm"><!> <section class="card svelte-8muejm"><!></section> <!></div> <!></div>',1);function ao(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{toggle_trainer_help:R,play_level:N,edit_level:J,remove_level:W,duplicate_level:K,create_level:T,update_level:z}=t(i);return[R,N,J,W,K,T,z]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>t(s)[3]),I=v(()=>t(s)[4]),y=v(()=>t(s)[5]),m=v(()=>t(s)[6]),w=Vt();window.ac=w;const p=v(()=>r().draft_level_data??et.parse({})),u=v(()=>r().levels?r().levels.some(R=>R.id===t(p).id):!1),q=v(()=>{var R;return!((R=r().realms)!=null&&R.length)});var S=to(),D=fe(S);ea(D,{get midi_access(){return r().midi_access},onnotestart:(R,N)=>{Bt(r(),w(),R,Jt(r().volume,N),r().instrument)},onnotestop:R=>{gt(R)}});var H=a(a(D,!0)),te=n(H);j(te,()=>r().project_datas.length,R=>{var N=Gn(),J=n(N);j(J,()=>r().selected_project_data,V=>{var h=Wn(),L=n(h);nl(L,{get app(){return r()}}),l(h),pe(3,h,()=>ye),d(V,h)});var W=a(a(J,!0));j(W,()=>(r().editing_project&&r().editing_project_data)??!r().selected_project_data,V=>{var h=Yn(),L=n(h);Un(L,{get app(){return r()}}),l(h),pe(3,h,()=>ye),d(V,h)});var K=a(a(W,!0)),T=n(K),z=n(T);n(z),l(z);var X=a(a(z,!0));_l(X,{});var A=a(a(X,!0)),P=n(A);Xt(P,{get volume(){return r().volume},set volume(V){r().volume=V}}),l(A);var F=a(a(A,!0));Kt(F,{get instrument(){return r().instrument},set instrument(V){r().instrument=V}});var O=a(a(F,!0)),Y=a(a(O,!0));Zt(Y,{get midi_state(){return r()}}),l(T),l(K),l(N),pe(3,K,()=>ye),d(R,N)});var G=a(a(te,!0)),Z=n(G);j(Z,()=>r().show_trainer_help,R=>{var N=Xn(),J=n(N),W=n(J);a(n(W)),Te(),l(W);var K=a(a(W,!0)),T=n(K),z=a(a(T,!0)),X=n(z);X.nodeValue=`your level score is the sum of mistakes in your best ${Wt}
							runs, win a ★ at 0`,l(z);var A=a(a(z,!0)),P=a(a(A,!0));a(a(P,!0)),l(K);var F=a(a(K,!0)),O=a(n(F));a(a(O,!0)),Te(),l(F);var Y=a(a(F,!0));a(n(Y)),Te(),l(Y);var V=a(a(Y,!0)),h=n(V);h.__click=[Kn,_],l(V),l(J),l(N),pe(3,N,()=>ye),d(R,N)});var ie=a(a(Z,!0)),ve=n(ie);Sl(ve,{get app(){return r()}}),l(ie);var le=a(ie,!0);le.nodeValue="  ";var _e=a(le);j(_e,()=>r().editing_realm&&r().editing_realm_data||t(q),R=>{var N=Zn(),J=n(N);nn(J,{get app(){return r()}}),l(N),pe(3,N,()=>ye),d(R,N)}),l(G);var ue=a(a(G,!0));j(ue,()=>r().project_datas.length,R=>{var N=eo(),J=n(N);j(J,()=>r().levels,T=>{var z=Qn(),X=n(z);hn(X,{get app(){return r()},get levels(){return r().levels}}),l(z),pe(3,z,()=>ye),d(T,z)});var W=a(J,!0);W.nodeValue="  ";var K=a(W);j(K,()=>{var T;return r().selected_realm_id&&(r().editing_level&&r().levels||((T=r().levels)==null?void 0:T.length)===0)},T=>{var z=$n(),X=n(z),A=n(X),P=v(()=>t(u)?t(m):t(y));Hr(A,{get editing(){return t(u)},get level_data(){return t(p)},get onsubmit(){return t(P)},get onremove(){return t(f)},get onduplicate(){return t(I)},onplay:async(F,O)=>{O&&t(m)(F),await t(b)(F.id)},onclose:()=>t(k)(null)}),l(X),l(z),pe(3,z,()=>ye),d(T,z)}),l(N),d(R,N)}),l(H),d(o,S),oe()}je(["click"]);var ro=c('<main><!> <!> <!> <div class="box"><!></div></main>');function yo(o,e){ne(e,!0);const r=Ut();var i=ro();ha(I=>{pa.title="Earbetter trainer"});var s=n(i);Ca(s,{onclick:()=>ya(ka+"/")});var _=a(a(s,!0));wa(_);var b=a(a(_,!0));ao(b,{app:r});var k=a(a(b,!0)),f=n(k);xa(f,{}),l(k),l(i),d(o,i),oe()}export{yo as component};
