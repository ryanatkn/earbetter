import{u as je,f as fe,c as n,r as l,s as a,b as ge,a as d,t as c,d as ft,e as fa,n as Pe,v as ha,w as pa}from"../chunks/disclose-version.C5EwI3-V.js";import{p as ne,j as E,t as B,H as Q,g as t,a as oe,s as g,d as v,F as De,n as Mt,T as ya}from"../chunks/index-client.Cqv4GYu1.js";import{g as ka,b as wa}from"../chunks/entry.DwV-GLhR.js";import{H as ja}from"../chunks/Header.D5z3EKMB.js";import{g as xa,F as za}from"../chunks/Footer.CMX324vw.js";import{K as Rt,U as mt,d as Vt,l as qa,W as Ct,X as Ia,L as Sa,j as Ft,k as gt,p as Ta,Y as bt,Z as Ht,n as Bt,w as Jt,_ as Aa,g as Ut,$ as Se,a as Xe,b as Ze,t as pe,m as Dt,a0 as Pa,a1 as et,c as ye,a2 as tt,M as Wt,a3 as at,a4 as Yt,a5 as La,s as Gt,a6 as Ea}from"../chunks/index.DT_0GC09.js";import{p as $,a as M,i as j}from"../chunks/props.DNuZbuIM.js";import{l as Ma,i as Da,s as Oa,b as he,I as Kt,V as Xt,c as Zt,a as Na}from"../chunks/Init_Midi_Button.AtvGgaBD.js";import{f as He,e as Oe,r as we,s as U,g as Qe,b as Qt,c as $t,t as be,h as Ra}from"../chunks/style.BTM4hw-r.js";import{M as ea,P as ta,b as Va,B as Ca}from"../chunks/Back_Button.D8rgW84n.js";import{b as Te}from"../chunks/this.D7faLO31.js";import{D as Fe}from"../chunks/Dialog.CqbLX18D.js";import{A as $e}from"../chunks/Alert.BnMwJceV.js";import{p as Fa}from"../chunks/string.Dn_jmF-S.js";import{L as Ha}from"../chunks/Level_Stats_Summary.BIqmV2S3.js";function Ba(o,e){Ma(window,["resize"],()=>e(window[o]))}var Ot=Object.prototype.hasOwnProperty;function Nt(o,e,r){for(r of o.keys())if(Le(r,e))return r}function Le(o,e){var r,i,s;if(o===e)return!0;if(o&&e&&(r=o.constructor)===e.constructor){if(r===Date)return o.getTime()===e.getTime();if(r===RegExp)return o.toString()===e.toString();if(r===Array){if((i=o.length)===e.length)for(;i--&&Le(o[i],e[i]););return i===-1}if(r===Set){if(o.size!==e.size)return!1;for(i of o)if(s=i,s&&typeof s=="object"&&(s=Nt(e,s),!s)||!e.has(s))return!1;return!0}if(r===Map){if(o.size!==e.size)return!1;for(i of o)if(s=i[0],s&&typeof s=="object"&&(s=Nt(e,s),!s)||!Le(i[1],e.get(s)))return!1;return!0}if(r===ArrayBuffer)o=new Uint8Array(o),e=new Uint8Array(e);else if(r===DataView){if((i=o.byteLength)===e.byteLength)for(;i--&&o.getInt8(i)===e.getInt8(i););return i===-1}if(ArrayBuffer.isView(o)){if((i=o.byteLength)===e.byteLength)for(;i--&&o[i]===e[i];);return i===-1}if(!r||typeof o=="object"){i=0;for(r in o)if(Ot.call(o,r)&&++i&&!Ot.call(e,r)||!(r in e)||!Le(o[r],e[r]))return!1;return Object.keys(e).length===i}}return o!==o&&e!==e}var Ja=(o,e)=>g(e,M(o.currentTarget.value)),Ua=(o,e,r,i,s,_)=>{var b;return(b=e.oninput)==null?void 0:b.call(e,t(r),t(i)?{scale:s(),octaves:_()}:void 0)},Wa=(o,e)=>e(M(qa(o.currentTarget.value))),Ya=c("<option> </option>"),Ga=c('<small><textarea class="preview width_sm panel svelte-1n8fnqy"></textarea></small> <button type="button" class="accent mb_lg">use these intervals</button> <label><div class="title text_align_center">scale</div> <select></select></label> <label><div class="title text_align_center">octaves</div> <div class="text_align_center"> </div> <input type="range"></label>',1);function Ka(o,e){ne(e,!0);let r=$(e,"scale",15,()=>M(Rt)),i=$(e,"octaves",7,1);const s=v(()=>Ia(r(),i())),_=v(()=>mt(t(s))),b=M(mt(e.intervals));let k=E(M(b));const f=v(()=>(t(s),Date.now())),I=v(()=>(e.intervals,t(k),Date.now())),y=v(()=>t(f)>t(I)),m=v(()=>t(y)?t(_):t(k)),w=v(()=>Ct(t(m))),p=v(()=>!Le(e.intervals,t(w))),u=v(()=>!!t(w).length);var q=Ga(),S=fe(q),D=n(S);He(D),D.__input=[Ja,k],l(S);var H=a(a(S,!0));H.__click=[Ua,e,w,y,r,i];var te=a(a(H,!0)),G=n(te),Z=a(a(G,!0));Da(Z,()=>r().name);var ie;Z.__change=[Wa,r],Oe(Z,76,()=>Vt,(N,J)=>Q(N),(N,J,W)=>{var K=Ya(),P={},z=n(K);l(K),B(()=>{P!==(P=Q(J).name)&&(K.value=(K.__value=Q(J).name)==null?"":Q(J).name),ge(z,Q(J).name)}),d(N,K)}),l(Z),l(te);var ve=a(a(te,!0)),le=n(ve),_e=a(a(le,!0)),ue=n(_e);l(_e);var R=a(a(_e,!0));we(R),U(R,"min",1),U(R,"max",6),l(ve),B(()=>{Qe(D,t(m)),H.disabled=!t(p)||!t(u),ie!==(ie=r().name)&&(Z.value=(Z.__value=r().name)==null?"":r().name,Oa(Z,r().name)),ge(ue,i())}),he(R,i,N=>i(N)),d(o,q),oe()}je(["input","click","change"]);var Xa=(o,e)=>{g(e,M(new Set))},Za=(o,e,r)=>{var i;(i=e.oninput)==null||i.call(e,t(r))},Qa=c("all",1),$a=c('<!> <button class="mb_lg" type="button">clear selection</button> <button type="button" class="accent">select <!> </button>',1),er=c("<option> </option>"),tr=(o,e,r)=>e(Q(r)),ar=c('<button type="button"> </button>'),rr=(o,e)=>e(o.currentTarget.value),lr=c('<!> <div class="notes_input pt_lg svelte-18obm47"><!> <div class="piano_wrapper svelte-18obm47"><!></div> <section class="box"><label class="mb_lg"><div class="title text_align_center">key</div> <select></select></label> <div class="scales mb_lg svelte-18obm47"></div> <!> <div class="notes width_sm svelte-18obm47"><blockquote class="panel my_lg"><textarea></textarea></blockquote></div></section> <form class="width_sm panel p_md"><fieldset><!> <!></fieldset> <fieldset><!></fieldset></form></div>',1);function nr(o,e){ne(e,!0);const r=h=>{var L=$a(),ee=fe(L);j(ee,()=>e.before_buttons,qe=>{var ze=ft(),rt=fe(ze);$t(rt,()=>e.before_buttons),d(qe,ze)});var de=a(a(ee,!0));de.__click=[Xa,_];var ce=a(a(de,!0));ce.__click=[Za,e,b];var Ae=a(n(ce));j(Ae,()=>t(f)===0,qe=>{var ze=Qa();d(qe,ze)},qe=>{var ze=fa();B(()=>ge(ze,t(f))),d(qe,ze)});var Be=a(Ae,!0);B(()=>ge(Be,` tonic${Fa(t(f))??""}`)),l(ce),B(()=>{de.disabled=t(f)===0,ce.disabled=!t(w)}),d(h,L)},i=$(e,"audio_state",7),{playing_notes:s}=i();let _=E(void 0);const b=v(()=>t(_)&&Array.from(t(_)).sort((h,L)=>h-L)),k=v(()=>t(_)??e.notes),f=v(()=>t(k).size),I=v(()=>t(b)&&bt(t(b))),y=h=>{g(_,M(new Set(Ht(h))))},m=v(()=>bt(Array.from(e.notes).sort((h,L)=>h-L))),w=v(()=>!!t(b)&&t(I)!==t(m)),p=h=>{const L=new Set(t(k));L.has(h)?L.delete(h):L.add(h),g(_,M(L))};let u=E(M(Sa));const q=Ft();let S=E(void 0);const D=20,H=(h,L=null)=>{Bt(i(),q(),h,Jt(i().volume,L),i().instrument)},te=h=>{const L=Aa(h,t(u),e.min_note,e.max_note);if(!t(_)||!t(b)){g(_,M(L));return}let ee=!0;for(const ce of L)if(!t(_).has(ce)){ee=!1;break}const de=ee?t(b).filter(ce=>!L.has(ce)):t(b).concat(Array.from(L));g(_,M(new Set(de)))};var G=lr(),Z=fe(G);ea(Z,{get midi_access(){return i().midi_access},onnotestart:(h,L)=>H(h,L),onnotestop:h=>gt(h)});var ie=a(a(Z,!0)),ve=n(ie);r(ve);var le=a(a(ve,!0));Qt(le,"padding",`${D}px`);var _e=n(le);j(_e,()=>t(S),h=>{var L=v(()=>t(S)-D*5);ta(h,{get width(){return t(L)},get min_note(){return e.min_note},get max_note(){return e.max_note},max_height:300,pressed_keys:s,get highlighted_keys(){return t(k)},middle_c_label:!0,allow_sticking:!0,onpress:ee=>{p(ee),H(ee)},onrelease:ee=>{gt(ee)}})}),l(le);var ue=a(a(le,!0)),R=n(ue),N=n(R),J=a(a(N,!0));Oe(J,76,()=>Ta,(h,L)=>Q(h),(h,L,ee)=>{var de=er(),ce={},Ae=n(de);l(de),B(()=>{ce!==(ce=Q(L))&&(de.value=(de.__value=Q(L))==null?"":Q(L)),ge(Ae,Q(L))}),d(h,de)}),l(J),l(R);var W=a(a(R,!0));Oe(W,77,()=>Vt,(h,L)=>Q(h).name,(h,L,ee)=>{var de=ar();de.__click=[tr,te,L];var ce=n(de);l(de),B(()=>ge(ce,Q(L).name)),d(h,de)}),l(W);var K=a(a(W,!0));r(K);var P=a(a(K,!0)),z=n(P),X=n(z);He(X),X.__change=[rr,y],l(z),l(P),l(ue);var T=a(a(ue,!0)),A=n(T),C=n(A);Kt(C,{get instrument(){return i().instrument},set instrument(h){i().instrument=h}});var O=a(a(C,!0));Xt(O,{get volume(){return i().volume},set volume(h){i().volume=h}}),l(A);var Y=a(a(A,!0)),F=n(Y);Zt(F,{get midi_state(){return i()}}),l(Y),l(T),l(ie),B(()=>Qe(X,t(I))),Ba("innerWidth",h=>g(S,h)),Na(J,()=>t(u),h=>g(u,h)),d(o,G),oe()}je(["click","change"]);var or=(o,e)=>{var r;navigator.clipboard.writeText(e.text),(r=e.oncopy)==null||r.call(e)},ir=c("copy to clipboard",1),_r=c('<button type="button" class="my_lg"><!></button>');function ht(o,e){ne(e,!0);var r=_r();r.__click=[or,e];var i=n(r);j(i,()=>e.children,s=>{var _=ft(),b=fe(_);$t(b,()=>e.children),d(s,_)},s=>{var _=ir();d(s,_)}),l(r),d(o,r),oe()}je(["click"]);const sr=(o,e,r,i,s)=>{g(e,"");try{const _=JSON.parse(t(r));_&&!_.id&&(_.id=Pa());const b=et.parse(_);i.onsubmit(b)}catch(_){console.error("failed to import data",_),g(e,M(_.message||"unknown error"))}g(s,!1)},dr=(o,e,r,i,s)=>{g(e,M(g(r,M(JSON.stringify(i()))))),g(s,!0)};var cr=c("editing level",1),vr=c("create a new level",1),ur=(o,e)=>g(e,Se(Ct(o.currentTarget.value))),mr=(o,e)=>g(e,!0),gr=c("the lowest note must be lower than the highest",1),br=c("<!> <br>",1),fr=(o,e)=>g(e,Se(Ht(o.currentTarget.value))),hr=(o,e)=>g(e,!0),pr=(o,e,r)=>e.onsubmit(r()),yr=c("save changes to level",1),kr=c("create level",1),wr=(o,e)=>g(e,!t(e)),jr=(o,e,r)=>{g(e,!1),r.onremove(r.level_data.id)},xr=c('<div><button type="button" class="color_c w_100 svelte-h4qokl">✕ confirm remove</button></div>'),zr=(o,e)=>e.onduplicate(e.level_data.id),qr=c('<button type="button" class="svelte-h4qokl">duplicate level</button>'),Ir=c('<button type="button" class="svelte-h4qokl">remove level</button> <!> <!>',1),Sr=c("import/export data",1),Tr=c("import data",1),Ar=c("<pre> </pre>"),Pr=c('<div class="overflow_x_auto"><!></div>'),Lr=(o,e,r,i)=>e.onplay(t(r)?i():e.level_data,t(r)),Er=c('<button type="button" class="svelte-h4qokl">play!</button>'),Mr=(o,e)=>e.onclose(e.level_data.id),Dr=c("discard changes and stop editing",1),Or=c("close level editor",1),Nr=c('<button type="button" class="svelte-h4qokl"><!></button>'),Rr=c('<div class="importing bg shadow_d_xl p_xl width_md box svelte-h4qokl"><h2 class="my_0">import level data</h2> <!> <textarea class="svelte-h4qokl"></textarea> <button type="button" class="svelte-h4qokl">import project data</button></div>'),Vr=c('<div class="bg shadow_d_xl p_xl width_md box"><h2 class="my_0">pick intervals</h2> <!> <button type="button" class="svelte-h4qokl">cancel</button></div>'),Cr=c('<button type="button" class="mb_lg svelte-h4qokl">cancel</button>'),Fr=c('<div class="bg shadow_d_xl py_xl box"><h2 class="my_0">pick tonics</h2> <!></div>'),Hr=c(`<form class="level_def_form w_100"><header><h2 class="my_0"><!></h2></header> <div class="fields svelte-h4qokl"><fieldset><label><div class="title">name</div> <input></label></fieldset> <fieldset><label class="mb_0" title="the semitones to include relative to the tonic"><div class="title">intervals</div> <input></label> <button type="button" class="svelte-h4qokl">pick intervals</button> <details><summary>about <code>intervals</code></summary> <p><code>intervals</code> is a comma-separated list of numbers representing the <a href="https://wikipedia.org/wiki/Interval_(music)">musical intervals</a> used in the
					level, aka the number of piano keys (<a href="https://wikipedia.org/wiki/Semitone">semitones</a>) separating each note from the <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> (see below)</p> <p>for example, to practice distinguishing between the <a href="https://wikipedia.org/wiki/Perfect_fourth">perfect fourth</a> and <a href="https://wikipedia.org/wiki/Perfect_fifth">perfect fifth</a>, enter "<code>5, 7</code>"</p> <p>negative numbers are allowed</p></details></fieldset> <fieldset><label title="the number of trials per level"><div class="title">trial count</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset><label title="the number of notes per trial"><div class="title">sequence length</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"> <input type="range"></div></label></fieldset> <fieldset class="row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="number"> <input type="range"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="number"> <input type="range"></label></fieldset> <!> <fieldset><label class="mb_0" title="the possible starting notes for each trial"><div class="title">tonics</div> <input placeholder="all"></label> <button type="button" class="svelte-h4qokl">pick tonics</button> <details><summary>about <code>tonics</code></summary> <p>The <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> is like the "base" or "home"
					note, and for our purposes it's always the first note played in a trial. Other notes in the
					trial are calculated from the tonic and intervals. (see above)</p></details></fieldset> <button type="button" class="accent svelte-h4qokl"><!></button> <!> <button type="button" class="svelte-h4qokl"><!></button> <!> <!> <!></div></form> <!> <!> <!>`,1);function Br(o,e){ne(e,!0);const r=$(e,"editing",3,!1),i=Ut();let s=E(!1),_=E(M(e.level_data.name));const b=v(()=>{var x;return(x=t(_))==null?void 0:x.trim()});let k=E(Se(e.level_data.intervals)),f=E(Se(e.level_data.tonics));const I=v(()=>t(f)?t(f).filter(x=>x>=t(w)&&x<=t(p)):t(f));let y=E(M(e.level_data.trial_count)),m=E(M(e.level_data.sequence_length)),w=E(M(e.level_data.min_note)),p=E(M(e.level_data.max_note));const u=()=>et.parse({id:e.level_data.id,name:t(b),intervals:t(k),tonics:t(I),trial_count:t(y),sequence_length:t(m),min_note:t(w),max_note:t(p)});De(()=>{g(_,M(e.level_data.name)),g(k,Se(e.level_data.intervals)),g(f,Se(e.level_data.tonics)),g(y,M(e.level_data.trial_count)),g(m,M(e.level_data.sequence_length)),g(w,M(e.level_data.min_note)),g(p,M(e.level_data.max_note))});const q=v(()=>t(b)!==e.level_data.name||t(y)!==e.level_data.trial_count||t(m)!==e.level_data.sequence_length||t(w)!==e.level_data.min_note||t(p)!==e.level_data.max_note||!Le(t(k),e.level_data.intervals)||!Le(t(I),e.level_data.tonics));let S=E(!1),D=E(!1),H=E(!1),te=E(""),G=E("");const Z=v(()=>t(te)!==t(G));let ie=E("");De(()=>{e.level_data,g(ie,"")});let ve=E(void 0),le=E(void 0),_e=E(void 0),ue=E(void 0);const R=v(()=>t(f)&&new Set(t(f)));let N=E(M(Rt)),J=E(1),W=E(void 0);const K=v(()=>t(w)>=t(p));var P=Hr(),z=fe(P),X=n(z),T=n(X),A=n(T);j(A,r,x=>{var V=cr();d(x,V)},x=>{var V=vr();d(x,V)}),l(T),l(X);var C=a(a(X,!0)),O=n(C),Y=n(O),F=n(Y),h=a(a(F,!0));we(h),l(Y),l(O);var L=a(a(O,!0)),ee=n(L),de=n(ee),ce=a(a(de,!0));Te(ce,x=>g(_e,M(x)),()=>t(_e)),we(ce),B(()=>Qe(ce,mt(t(k)))),ce.__change=[ur,k],l(ee);var Ae=a(a(ee,!0));Ae.__click=[mr,D];var Be=a(a(Ae,!0)),qe=n(Be);a(n(qe)),l(qe);var ze=a(a(qe,!0)),rt=n(ze),aa=a(a(rt,!0)),ra=a(a(aa,!0));a(a(ra,!0)),Pe(),l(ze);var lt=a(a(ze,!0)),la=a(n(lt)),na=a(a(la,!0));a(a(na,!0)),Pe(),l(lt),a(a(lt,!0)),l(Be),l(L);var nt=a(a(L,!0)),pt=n(nt),oa=n(pt),yt=a(a(oa,!0)),Je=n(yt);we(Je),U(Je,"min",1);var Ue=a(a(Je,!0));we(Ue),U(Ue,"min",1),U(Ue,"max",20),l(yt),l(pt),l(nt);var ot=a(a(nt,!0)),kt=n(ot),ia=n(kt),wt=a(a(ia,!0)),We=n(wt);we(We),U(We,"min",2);var Ye=a(a(We,!0));we(Ye),U(Ye,"min",2),U(Ye,"max",16),l(wt),l(kt),l(ot);var it=a(a(ot,!0)),_t=n(it),_a=n(_t),st=a(a(_a,!0)),sa=n(st);l(st);var Ee=a(a(st,!0));we(Ee),U(Ee,"step",1),U(Ee,"min",Xe),U(Ee,"max",Ze);var Ne=a(a(Ee,!0));we(Ne),U(Ne,"step",1),U(Ne,"min",Xe),U(Ne,"max",Ze),l(_t);var jt=a(a(_t,!0)),da=n(jt),dt=a(a(da,!0)),ca=n(dt);l(dt);var Me=a(a(dt,!0));we(Me),U(Me,"step",1),U(Me,"min",Xe),U(Me,"max",Ze);var Re=a(a(Me,!0));we(Re),U(Re,"step",1),U(Re,"min",Xe),U(Re,"max",Ze),l(jt),l(it);var xt=a(a(it,!0));j(xt,()=>t(K),x=>{$e(x,{status:"error",children:(V,re)=>{Pe();var ae=gr();d(V,ae)},$$slots:{default:!0}})},x=>{var V=br(),re=fe(V),ae=v(()=>t(W)??0);ta(re,{get width(){return t(ae)},max_height:50,get min_note(){return t(w)},get max_note(){return t(p)},get highlighted_keys(){return t(R)},clickable:!1,middle_c_label:!0}),a(a(re,!0)),d(x,V)});var Ge=a(a(xt,!0)),ct=n(Ge),va=n(ct),Ke=a(a(va,!0));Te(Ke,x=>g(ue,M(x)),()=>t(ue)),we(Ke),B(()=>Qe(Ke,bt(t(f)))),Ke.__change=[fr,f],l(ct);var zt=a(a(ct,!0));zt.__click=[hr,H];var qt=a(a(zt,!0)),vt=n(qt);a(n(vt)),l(vt);var It=a(a(vt,!0));a(n(It)),Pe(),l(It),l(qt),l(Ge);var Ve=a(a(Ge,!0));Ve.__click=[pr,e,u];var ua=n(Ve);j(ua,r,x=>{var V=yr();d(x,V)},x=>{var V=kr();d(x,V)}),l(Ve);var St=a(a(Ve,!0));j(St,()=>e.onremove&&r(),x=>{var V=Ir(),re=fe(V);re.__click=[wr,s];var ae=a(a(re,!0));j(ae,()=>t(s),ke=>{var se=xr(),Ie=n(se);Ie.__click=[jr,s,e],l(se),pe(3,se,()=>ye),d(ke,se)});var me=a(a(ae,!0));j(me,()=>e.onduplicate,ke=>{var se=qr();se.__click=[zr,e],d(ke,se)}),d(x,V)});var Ce=a(a(St,!0));Te(Ce,x=>g(le,M(x)),()=>t(le)),Ce.__click=[dr,te,G,u,S];var ma=n(Ce);j(ma,r,x=>{var V=Sr();d(x,V)},x=>{var V=Tr();d(x,V)}),l(Ce);var Tt=a(a(Ce,!0));j(Tt,()=>t(ie),x=>{var V=Pr(),re=n(V);$e(re,{status:"error",children:(ae,me)=>{var ke=Ar(),se=n(ke);l(ke),B(()=>ge(se,t(ie))),d(ae,ke)},$$slots:{default:!0}}),l(V),d(x,V)});var At=a(a(Tt,!0));j(At,()=>e.onplay&&r(),x=>{var V=Er();V.__click=[Lr,e,q,u],d(x,V)});var ga=a(a(At,!0));j(ga,()=>e.onclose&&r(),x=>{var V=Nr();V.__click=[Mr,e];var re=n(V);j(re,()=>t(q),ae=>{var me=Dr();d(ae,me)},ae=>{var me=Or();d(ae,me)}),l(V),d(x,V)}),l(C),l(z);var Pt=a(a(z,!0));j(Pt,()=>t(S),x=>{Fe(x,{onclose:()=>{var V;g(S,!1),(V=t(le))==null||V.focus()},children:(V,re)=>{var ae=Rr(),me=n(ae),ke=a(a(me,!0));ht(ke,{get text(){return t(G)},oncopy:()=>{var xe;(xe=t(ve))==null||xe.select()}});var se=a(a(ke,!0));Te(se,xe=>g(ve,M(xe)),()=>t(ve)),He(se);var Ie=a(a(se,!0));Ie.__click=[sr,ie,G,e,S],l(ae),B(()=>{Ie.disabled=!t(Z),U(Ie,"title",t(Z)?void 0:"data has not changed")}),he(se,()=>t(G),xe=>g(G,xe)),d(V,ae)},$$slots:{default:!0}})});var Lt=a(a(Pt,!0));j(Lt,()=>t(D),x=>{Fe(x,{onclose:()=>{var re;g(D,!1),(re=t(_e))==null||re.focus()},children:(re,ae=Mt)=>{var me=Vr(),ke=n(me),se=a(a(ke,!0));Ka(se,{get intervals(){return t(k)},get scale(){return t(N)},set scale(xe){g(N,M(xe))},get octaves(){return t(J)},set octaves(xe){g(J,M(xe))},oninput:xe=>{g(k,Se(xe)),ae()()}});var Ie=a(a(se,!0));Ie.__click=ae(),l(me),d(re,me)}})});var ba=a(a(Lt,!0));j(ba,()=>t(H),x=>{Fe(x,{onclose:()=>{var re;g(H,!1),(re=t(ue))==null||re.focus()},children:(re,ae=Mt)=>{var me=Fr(),ke=n(me),se=a(a(ke,!0)),Ie=v(()=>new Set(t(f)));nr(se,{audio_state:i,get notes(){return t(Ie)},get min_note(){return t(w)},get max_note(){return t(p)},oninput:ut=>{g(f,Se(ut)),ae()()},before_buttons:ut=>{var Et=Cr();Et.__click=ae(),d(ut,Et)}}),l(me),d(re,me)}})}),B(()=>{ge(sa,Dt[t(w)]),ge(ca,Dt[t(p)]),Ve.disabled=r()&&!t(q)||t(K)}),he(h,()=>t(_),x=>g(_,x)),he(Je,()=>t(y),x=>g(y,x)),he(Ue,()=>t(y),x=>g(y,x)),he(We,()=>t(m),x=>g(m,x)),he(Ye,()=>t(m),x=>g(m,x)),he(Ee,()=>t(w),x=>g(w,x)),he(Ne,()=>t(w),x=>g(w,x)),he(Me,()=>t(p),x=>g(p,x)),he(Re,()=>t(p),x=>g(p,x)),Va(Ge,"clientWidth",x=>g(W,x)),d(o,P),oe()}je(["change","click"]);var Jr=(o,e,r)=>e()(r.project.id),Ur=c('<button type="button" class="flex_1"> </button>'),Wr=(o,e,r,i,s)=>{var _,b;return t(e)?(_=r())==null?void 0:_(i.project.id):(b=s())==null?void 0:b(i.project_data??i.load(i.project.id))},Yr=c("✕",1),Gr=c("✎",1),Kr=c('<button type="button" class="icon_button plain_button size_xl deselectable svelte-12y7az0"><!></button>'),Xr=(o,e)=>g(e,!t(e)),Zr=c("×",1),Qr=c("✕",1),$r=c('<button type="button" class="icon_button plain_button size_xl svelte-12y7az0"><!></button>'),el=c('<li class="project_item svelte-12y7az0"><!> <!> <!></li>');function tl(o,e){ne(e,!0);const r=$(e,"select",3,null),i=$(e,"edit",3,null),s=$(e,"remove",3,null);let _=E(!1);var b=el(),k=n(b);j(k,r,y=>{var m=Ur();m.__click=[Jr,r,e];var w=n(m);l(m),B(()=>{be(m,"selected",e.selected),ge(w,e.project.name)}),d(y,m)});var f=a(a(k,!0));j(f,()=>(t(_)&&s())??(!t(_)&&i()),y=>{var m=Kr();m.__click=[Wr,_,s,e,i];var w=n(m);j(w,()=>t(_),p=>{var u=Yr();d(p,u)},p=>{var u=Gr();d(p,u)}),l(m),B(()=>{U(m,"title",t(_)?"remove project":"edit project"),be(m,"selected",e.selected&&!t(_)&&e.editing),be(m,"color_c",t(_))}),d(y,m)});var I=a(a(f,!0));j(I,s,y=>{var m=$r();m.__click=[Xr,_];var w=n(m);j(w,()=>t(_),p=>{var u=Zr();d(p,u)},p=>{var u=Qr();d(p,u)}),l(m),B(()=>U(m,"title",t(_)?"cancel removing":"remove project")),d(y,m)}),l(b),B(()=>be(b,"selected",e.selected)),pe(3,b,()=>ye),d(o,b),oe()}je(["click"]);var al=c('<menu class="unstyled width_sm mb_0"></menu>');function rl(o,e){ne(e,!0);const r=$(e,"selected_project_id",3,null),i=$(e,"editing_project_id",3,null),s=$(e,"projects",11,()=>[]),_=$(e,"project_datas",11,()=>[]);var b=al();Oe(b,77,s,(k,f)=>Q(k).id,(k,f,I)=>{var y=v(()=>_().find(p=>p.id===Q(f).id)),m=v(()=>Q(f).id===r()),w=v(()=>Q(f).id===i());tl(k,{get project(){return Q(f)},get project_data(){return t(y)},get load(){return e.load_project},get select(){return e.select_project},get edit(){return e.edit_project},get remove(){return e.remove_project},get selected(){return t(m)},get editing(){return t(w)}})}),l(b),d(o,b),oe()}var ll=(o,e,r,i)=>{t(e)?r().editing_project=!1:t(i)(tt.parse({}))},nl=c('<div class="panel p_md"><header><h2 class="my_0">projects</h2></header> <!> <button type="button" class="w_100 mt_md deselectable">create a new project</button></div>');function ol(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{load_project:H,select_project:te,edit_project:G,remove_project:Z}=t(i);return[H,te,G,Z]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>t(s)[3]),I=v(()=>r().editing_project&&r().selected_project_id!==r().editing_project_id),y=v(()=>r().app_data),m=v(()=>{let{projects:H}=t(y);return[H]}),w=v(()=>t(m)[0]);var p=nl(),u=n(p);n(u),l(u);var q=a(a(u,!0)),S=v(()=>r().editing_project?r().editing_project_id:null);rl(q,{get selected_project_id(){return r().selected_project_id},get editing_project_id(){return t(S)},get projects(){return t(w)},get project_datas(){return r().project_datas},get load_project(){return t(_)},get select_project(){return t(b)},edit_project:H=>t(k)(H===r().editing_project_data&&r().editing_project?null:H),get remove_project(){return t(f)}});var D=a(a(q,!0));D.__click=[ll,I,r,k],l(p),B(()=>be(D,"selected",t(I))),d(o,p),oe()}je(["click"]);var il=(o,e)=>e.toggle(),_l=c(`<aside>devices with smaller screens aren't well supported yet, see <a href="https://github.com/ryanatkn/earbetter/issues/2">issue #2</a></aside> <table><tbody><tr><td class="svelte-1gwge1y"><code>Spacebar</code></td><td class="svelte-1gwge1y">replay trial</td></tr><tr><td class="svelte-1gwge1y"><code>r</code></td><td class="svelte-1gwge1y">restart level</td></tr><tr><td class="svelte-1gwge1y"><code>Escape</code></td><td class="svelte-1gwge1y"><button type="button" class="inline">toggle main menu</button></td></tr><tr><td class="svelte-1gwge1y"><code>1 to 4</code></td><td class="svelte-1gwge1y">set instrument</td></tr><tr><td class="svelte-1gwge1y"><code>c</code></td><td class="svelte-1gwge1y">connect MIDI</td></tr><tr><td class="svelte-1gwge1y"><code>up/down arrows</code></td><td class="svelte-1gwge1y">adjust volume</td></tr></tbody></table>`,1);function sl(o,e){ne(e,!0);const r=xa();var i=_l(),s=fe(i);a(n(s)),l(s);var _=a(a(s,!0)),b=n(_),k=n(b),f=n(k);n(f),l(f),a(f),l(k);var I=a(k),y=n(I);n(y),l(y),a(y),l(I);var m=a(I),w=n(m);n(w),l(w);var p=a(w),u=n(p);u.__click=[il,r],Qt(u,"min-width","172px"),l(p),l(m);var q=a(m),S=n(q);n(S),l(S),a(S),l(q);var D=a(q),H=n(D);n(H),l(H),a(H),l(D);var te=a(D),G=n(te);n(G),l(G),a(G),l(te),l(b),l(_),d(o,i),oe()}je(["click"]);var dl=c('<div class="realm_stats_summary svelte-1mwdoug" title="you performed flawlessly in every level of this realm!">★</div>');function cl(o,e){ne(e,!0);const r=v(()=>e.realm_data.levels.map(y=>e.level_stats.mistakes[y.id]??[])),i=v(()=>t(r).reduce((y,m)=>y+m.length,0)),s=v(()=>Wt*t(r).length),_=v(()=>!!t(i)&&t(i)>=t(s)),b=v(()=>t(_)?t(r).reduce((y,m)=>y+m.reduce((w,p)=>w+p,0),0):void 0),k=v(()=>t(b)===0);var f=ft(),I=fe(f);j(I,()=>t(k),y=>{var m=dl();d(y,m)}),d(o,f),oe()}var vl=(o,e,r)=>e()(r.realm_data.id),ul=c('<button type="button" class="realm_button svelte-1joa4ch"> </button>'),ml=(o,e,r,i,s)=>{var _,b;return t(e)?(_=r())==null?void 0:_(i.realm_data.id):(b=s())==null?void 0:b(i.realm_data)},gl=c("✕",1),bl=c("✎",1),fl=c('<button type="button" class="icon_button plain_button size_xl deselectable svelte-1joa4ch"><!></button>'),hl=(o,e)=>g(e,!t(e)),pl=c("×",1),yl=c("✕",1),kl=c('<button type="button" class="icon_button plain_button size_xl svelte-1joa4ch"><!></button>'),wl=c('<li class="realm_item svelte-1joa4ch"><!> <!> <!> <!></li>');function jl(o,e){ne(e,!0);const r=$(e,"select",3,null),i=$(e,"edit",3,null),s=$(e,"remove",3,null);let _=E(!1);const b=v(()=>e.project_data.level_stats);var k=wl(),f=n(k);j(f,()=>t(b),p=>{cl(p,{get realm_data(){return e.realm_data},get level_stats(){return t(b)}})});var I=a(a(f,!0));j(I,r,p=>{var u=ul();u.__click=[vl,r,e];var q=n(u);l(u),B(()=>{be(u,"selected",e.selected),ge(q,e.realm_data.name)}),d(p,u)});var y=a(I,!0);y.nodeValue="  ";var m=a(y);j(m,()=>t(_)&&s()||!t(_)&&i(),p=>{var u=fl();u.__click=[ml,_,s,e,i];var q=n(u);j(q,()=>t(_),S=>{var D=gl();d(S,D)},S=>{var D=bl();d(S,D)}),l(u),B(()=>{U(u,"title",t(_)?"remove realm":e.editing?"stop editing realm":"edit realm"),be(u,"selected",e.selected&&!t(_)&&e.editing),be(u,"color_c",t(_))}),d(p,u)});var w=a(a(m,!0));j(w,s,p=>{var u=kl();u.__click=[hl,_];var q=n(u);j(q,()=>t(_),S=>{var D=pl();d(S,D)},S=>{var D=yl();d(S,D)}),l(u),B(()=>U(u,"title",t(_)?"cancel removing":"remove realm")),d(p,u)}),l(k),B(()=>be(k,"selected",e.selected)),pe(3,k,()=>ye),d(o,k),oe()}je(["click"]);var xl=c('<menu class="unstyled width_sm mb_0"></menu>');function zl(o,e){ne(e,!0);const r=$(e,"selected_realm_data",3,null),i=$(e,"editing_realm_id",3,null),s=$(e,"realms",11,()=>[]),_=v(()=>new Map(s().map(f=>[f.id,f]))),b=f=>t(_).get(f);var k=xl();Oe(k,77,s,(f,I)=>Q(f).id,(f,I,y)=>{var m=v(()=>b(Q(I).id)),w=v(()=>{var u;return Q(I).id===((u=r())==null?void 0:u.id)}),p=v(()=>Q(I).id===i());jl(f,{get realm_data(){return t(m)},get project_data(){return e.project_data},get select(){return e.select_realm},get edit(){return e.edit_realm},get remove(){return e.remove_realm},get selected(){return t(w)},get editing(){return t(p)}})}),l(k),d(o,k),oe()}const ql=(o,e,r,i,s)=>{var _;t(e)?(_=document.querySelector(".realm_def_form input"))==null||_.focus():t(r)?i().editing_realm=!1:t(s)(at.parse({}))};var Il=c("<div><!></div>"),Sl=c('<div class="panel p_md"><header><h2 class="my_0">realms</h2></header> <!> <button type="button">create a new realm</button></div>');function Tl(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{select_realm:u,edit_realm:q,remove_realm:S}=t(i);return[u,q,S]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>{var u;return r().editing_realm&&!!r().editing_realm_data&&((u=r().selected_realm_data)==null?void 0:u.id)!==r().editing_realm_data.id}),I=v(()=>{var u;return!((u=r().realms)!=null&&u.length)});var y=Sl(),m=n(y);n(m),l(m);var w=a(a(m,!0));j(w,()=>r().realms&&r().selected_project_data,u=>{var q=Il(),S=n(q),D=v(()=>r().editing_realm?r().editing_realm_id:null);zl(S,{get project_data(){return r().selected_project_data},get selected_realm_data(){return r().selected_realm_data},get realms(){return r().realms},get editing_realm_id(){return t(D)},get select_realm(){return t(_)},edit_realm:H=>t(b)(H===r().editing_realm_data&&r().editing_realm?null:H),get remove_realm(){return t(k)}}),l(q),pe(3,q,()=>ye),d(u,q)});var p=a(a(w,!0));p.__click=[ql,I,f,r,b],l(y),B(()=>{Ra(p,`${(t(I)?void 0:"deselectable")??""} svelte-100yq62`),be(p,"selected",t(f)||t(I))}),d(o,y),oe()}je(["click"]);const Al=(o,e,r,i,s)=>{g(e,"");try{const _=JSON.parse(t(r));_&&!_.id&&(_.id=La());const b=at.parse(_);i.onsubmit(b)}catch(_){console.error("failed to import data",_),g(e,M(_.message||"unknown error"))}g(s,!1)},Pl=(o,e,r,i,s)=>{g(e,M(g(r,M(JSON.stringify(i()))))),g(s,!0)};var Ll=c('<div class="importing bg shadow_d_xl p_xl width_md box svelte-1g446ss"><h2 class="my_0">import realm data</h2> <!> <textarea class="svelte-1g446ss"></textarea> <button type="button" class="svelte-1g446ss">import realm data</button></div>'),El=c("editing realm",1),Ml=c("create a new realm",1),Dl=(o,e,r)=>{o.key==="Enter"&&(Gt(o),e.onsubmit(r()))},Ol=(o,e,r)=>e.onsubmit(r()),Nl=c("save changes to realm",1),Rl=c("create realm",1),Vl=(o,e)=>g(e,!t(e)),Cl=(o,e,r)=>{g(e,!1),r.onremove(r.realm_data.id)},Fl=c('<div><button type="button" class="color_c w_100 svelte-1g446ss">✕ confirm remove</button></div>'),Hl=(o,e)=>e.onduplicate(e.realm_data.id),Bl=c('<button type="button" class="svelte-1g446ss">duplicate realm</button>'),Jl=c('<button type="button" class="svelte-1g446ss">remove realm</button> <!> <!>',1),Ul=c("import/export data",1),Wl=c("import data",1),Yl=(o,e)=>g(e,!t(e)),Gl=(o,e,r)=>{g(e,!1),r.onsubmit(Yt().realms)},Kl=c('<div><button type="button" class="w_100 svelte-1g446ss"> </button></div>'),Xl=c('<button type="button" class="svelte-1g446ss">create default realms</button> <!>',1),Zl=c("<pre> </pre>"),Ql=c('<div class="message-wrapper svelte-1g446ss"><!></div>'),$l=(o,e)=>e.onclose(e.realm_data.id),en=c("discard changes",1),tn=c("close realm editor",1),an=c('<button class="w_100 svelte-1g446ss" type="button"><!></button>'),rn=c('<!> <form class="realm_def_form"><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent svelte-1g446ss"><!></button> <!> <button type="button" class="svelte-1g446ss"><!></button> <!> <!> <!></form>',1);function ln(o,e){ne(e,!0);const r=$(e,"editing",3,!1);let i=E(!1),s=E(M(e.realm_data.name));const _=v(()=>{var T;return(T=t(s))==null?void 0:T.trim()}),b=()=>at.parse({id:e.realm_data.id,name:t(_),levels:e.realm_data.levels});De(()=>{console.log("set_realm_data",e.realm_data),g(s,M(e.realm_data.name))});const k=v(()=>t(_)!==e.realm_data.name);let f=E(!1),I=E(""),y=E("");const m=v(()=>t(I)!==t(y));let w=E("");De(()=>{e.realm_data,g(w,"")});let p=E(void 0),u=E(void 0);const q=Yt().realms;let S=E(!1);var D=rn(),H=fe(D);j(H,()=>t(f),T=>{Fe(T,{onclose:()=>{var A;g(f,!1),(A=t(u))==null||A.focus()},children:(A,C)=>{var O=Ll(),Y=n(O),F=a(a(Y,!0));ht(F,{get text(){return t(y)},oncopy:()=>{var ee;(ee=t(p))==null||ee.select()}});var h=a(a(F,!0));Te(h,ee=>g(p,M(ee)),()=>t(p)),He(h);var L=a(a(h,!0));L.__click=[Al,w,y,e,f],l(O),B(()=>{L.disabled=!t(m),U(L,"title",t(m)?void 0:"data has not changed")}),he(h,()=>t(y),ee=>g(y,ee)),d(A,O)},$$slots:{default:!0}})});var te=a(a(H,!0)),G=n(te),Z=n(G),ie=n(Z);j(ie,r,T=>{var A=El();d(T,A)},T=>{var A=Ml();d(T,A)}),l(Z),l(G);var ve=a(a(G,!0)),le=n(ve),_e=n(le),ue=a(a(_e,!0));we(ue),ue.__keydown=[Dl,e,b],l(le),l(ve);var R=a(a(ve,!0));R.__click=[Ol,e,b];var N=n(R);j(N,r,T=>{var A=Nl();d(T,A)},T=>{var A=Rl();d(T,A)}),l(R);var J=a(a(R,!0));j(J,()=>e.onremove&&r(),T=>{var A=Jl(),C=fe(A);C.__click=[Vl,i];var O=a(a(C,!0));j(O,()=>t(i),F=>{var h=Fl(),L=n(h);L.__click=[Cl,i,e],l(h),pe(3,h,()=>ye),d(F,h)});var Y=a(a(O,!0));j(Y,()=>e.onduplicate,F=>{var h=Bl();h.__click=[Hl,e],d(F,h)}),d(T,A)});var W=a(a(J,!0));Te(W,T=>g(u,M(T)),()=>t(u)),W.__click=[Pl,I,y,b,f];var K=n(W);j(K,r,T=>{var A=Ul();d(T,A)},T=>{var A=Wl();d(T,A)}),l(W);var P=a(a(W,!0));j(P,()=>!r(),T=>{var A=Xl(),C=fe(A);C.__click=[Yl,S];var O=a(a(C,!0));j(O,()=>t(S),Y=>{var F=Kl(),h=n(F);h.__click=[Gl,S,e];var L=n(h);l(h),l(F),B(()=>ge(L,`create ${q.length??""} new realms`)),pe(3,F,()=>ye),d(Y,F)}),d(T,A)});var z=a(a(P,!0));j(z,()=>t(w),T=>{var A=Ql(),C=n(A);$e(C,{status:"error",children:(O,Y)=>{var F=Zl(),h=n(F);l(F),B(()=>ge(h,t(w))),d(O,F)},$$slots:{default:!0}}),l(A),d(T,A)});var X=a(a(z,!0));j(X,()=>e.onclose&&r(),T=>{var A=an();A.__click=[$l,e];var C=n(A);j(C,()=>t(k),O=>{var Y=en();d(O,Y)},O=>{var Y=tn();d(O,Y)}),l(A),d(T,A)}),l(te),B(()=>R.disabled=r()&&!t(k)),he(ue,()=>t(s),T=>g(s,T)),d(o,D),oe()}je(["click","keydown"]);var nn=c('<div class="panel p_md"><!></div>');function on(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{remove_realm:u,duplicate_realm:q,update_realm:S,create_realm:D}=t(i);return[u,q,S,D]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>t(s)[3]),I=v(()=>r().editing_realm_data??at.parse({})),y=v(()=>r().realms?r().realms.some(u=>u.id===t(I).id):!1),m=(u,q)=>{var S;(S=r().realms)!=null&&S.some(D=>D.id===u.id)?t(k)(u):t(f)(u,q)};var w=nn(),p=n(w);ln(p,{get editing(){return t(y)},get realm_data(){return t(I)},onsubmit:u=>{if(Array.isArray(u))for(let q=0;q<u.length;q++)m(u[q],q===0);else m(u,!0)},onremove:u=>t(_)(u),onduplicate:u=>t(b)(u),onclose:()=>r().editing_realm=!1}),l(w),d(o,w),oe()}var _n=(o,e)=>e.app.play_level(e.level_data.id),sn=async(o,e,r,i)=>{if(t(e))r.app.remove_level(r.level_data.id);else{const s=!t(i);if(r.app.edit_level(s?r.level_data:null),s){await ya();const _=document.querySelector(".level_def_form");_==null||_.scrollIntoView({behavior:"smooth",block:"center"})}}},dn=c("✕",1),cn=c("✎",1),vn=(o,e)=>g(e,!t(e)),un=c("×",1),mn=c("✕",1),gn=c('<li class="level_map_item svelte-170pvnv"><!> <button type="button" class="level_button deselectable svelte-170pvnv" title="play this level"> </button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button> <button type="button" class="icon_button plain_button size_xl svelte-170pvnv"><!></button></li>');function bn(o,e){ne(e,!0);const r=v(()=>e.app.draft_level_data===e.level_data),i=v(()=>e.app.editing_level&&t(r)),s=v(()=>{var q;return(q=e.app.selected_project_data)==null?void 0:q.level_stats});let _=E(!1);const b=v(()=>t(i)||t(r));var k=gn(),f=n(k);j(f,()=>t(s),q=>{Ha(q,{get level_data(){return e.level_data},get level_stats(){return t(s)}})});var I=a(a(f,!0));I.__click=[_n,e];var y=n(I);l(I);var m=a(a(I,!0));m.__click=[sn,_,e,i];var w=n(m);j(w,()=>t(_),q=>{var S=dn();d(q,S)},q=>{var S=cn();d(q,S)}),l(m);var p=a(a(m,!0));p.__click=[vn,_];var u=n(p);j(u,()=>t(_),q=>{var S=un();d(q,S)},q=>{var S=mn();d(q,S)}),l(p),l(k),B(()=>{be(k,"selected",t(b)),be(I,"selected",t(b)),ge(y,e.level_data.name),U(m,"title",t(_)?"remove level":t(i)?"stop editing level":"edit level"),be(m,"selected",!t(_)&&t(i)),be(m,"color_c",t(_)),U(p,"title",t(_)?"cancel removing":"remove level")}),pe(3,k,()=>ye),d(o,k),oe()}je(["click"]);const fn=(o,e,r,i)=>{var s;t(e)?(s=document.querySelector(".level_def_form input"))==null||s.focus():r.app.edit_level(t(i)?null:et.parse({}))};var hn=c('<div class="panel p_md"><header><h2 class="my_0">levels</h2> <h3 class="my_0"> </h3></header> <menu class="levels unstyled mb_0 svelte-wmjxbn"></menu> <button type="button" class="svelte-wmjxbn">create a new level</button></div>');function pn(o,e){ne(e,!0);const r=v(()=>e.app.editing_level&&!e.levels.some(m=>m===e.app.draft_level_data)),i=v(()=>!e.levels.length);var s=hn(),_=n(s),b=n(_),k=a(a(b,!0)),f=n(k);l(k),l(_);var I=a(a(_,!0));Oe(I,77,()=>e.levels,(m,w)=>Q(m).id,(m,w,p)=>{bn(m,{get app(){return e.app},get level_data(){return Q(w)}})}),l(I);var y=a(a(I,!0));y.__click=[fn,i,e,r],l(s),B(()=>{var m;ge(f,(m=e.app.selected_realm_data)==null?void 0:m.name),be(y,"selected",t(r)||t(i)),be(y,"deselectable",!t(i))}),d(o,s),oe()}je(["click"]);const yn=(o,e,r,i,s)=>{g(e,"");try{const _=JSON.parse(t(r));_&&!_.id&&(_.id=Ea());const b=tt.parse(_);i.onsubmit(b)}catch(_){console.error("failed to import data",_),g(e,M(_.message||"unknown error"))}g(s,!1)},kn=(o,e,r,i,s)=>{g(e,M(g(r,M(JSON.stringify(i()))))),g(s,!0)};var wn=c('<div class="importing bg shadow_d_xl p_xl width_md box svelte-l3tcx7"><h2 class="my_0">import project data</h2> <!> <textarea class="svelte-l3tcx7"></textarea> <button type="button" class="svelte-l3tcx7">import project data</button></div>'),jn=c("editing project",1),xn=c("create a new project",1),zn=(o,e,r)=>{o.key==="Enter"&&(Gt(o),e.onsubmit(r()))},qn=(o,e,r)=>e.onsubmit(r()),In=c("save changes to project",1),Sn=c("create project",1),Tn=(o,e)=>g(e,!t(e)),An=(o,e,r)=>{g(e,!1),r.onremove(r.project_data.id)},Pn=c('<div><button type="button" class="color_c w_100 svelte-l3tcx7">✕ confirm remove</button></div>'),Ln=(o,e)=>e.onduplicate(e.project_data.id),En=c('<button type="button" class="w_100 svelte-l3tcx7">duplicate project</button>'),Mn=c('<button class="w_100 svelte-l3tcx7" type="button">remove project</button> <!> <!>',1),Dn=c("import/export data",1),On=c("import data",1),Nn=c("<pre> </pre>"),Rn=c('<div class="overflow_x_auto"><!></div>'),Vn=(o,e)=>e.onclose(e.project_data.id),Cn=c("discard changes and stop editing",1),Fn=c("close project editor",1),Hn=c('<button type="button" class="w_100 svelte-l3tcx7"><!></button>'),Bn=c('<!> <form><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input></label></fieldset> <button type="button" class="accent w_100 svelte-l3tcx7"><!></button> <!> <button type="button" class="w_100 svelte-l3tcx7"><!></button> <!> <!></form>',1);function Jn(o,e){ne(e,!0);const r=$(e,"editing",3,!1);let i=E(!1),s=E(M(e.project_data.name));const _=v(()=>t(s).trim()),b=()=>tt.parse({id:e.project_data.id,name:t(_),realms:e.project_data.realms,level_stats:e.project_data.level_stats});De(()=>{console.log("set_project_data",e.project_data),g(s,M(e.project_data.name))});const k=v(()=>t(_)!==e.project_data.name);let f=E(!1),I=E(""),y=E("");const m=v(()=>t(I)!==t(y));let w=E("");De(()=>{e.project_data,g(w,"")});let p=E(void 0),u=E(void 0);var q=Bn(),S=fe(q);j(S,()=>t(f),P=>{Fe(P,{onclose:()=>{var z;g(f,!1),(z=t(u))==null||z.focus()},children:(z,X)=>{var T=wn(),A=n(T),C=a(a(A,!0));ht(C,{get text(){return t(y)},oncopy:()=>{var F;(F=t(p))==null||F.select()}});var O=a(a(C,!0));Te(O,F=>g(p,M(F)),()=>t(p)),He(O);var Y=a(a(O,!0));Y.__click=[yn,w,y,e,f],l(T),B(()=>{Y.disabled=!t(m),U(Y,"title",t(m)?void 0:"data has not changed")}),he(O,()=>t(y),F=>g(y,F)),d(z,T)},$$slots:{default:!0}})});var D=a(a(S,!0)),H=n(D),te=n(H),G=n(te);j(G,r,P=>{var z=jn();d(P,z)},P=>{var z=xn();d(P,z)}),l(te),l(H);var Z=a(a(H,!0)),ie=n(Z),ve=n(ie),le=a(a(ve,!0));we(le),le.__keydown=[zn,e,b],l(ie),l(Z);var _e=a(a(Z,!0));_e.__click=[qn,e,b];var ue=n(_e);j(ue,r,P=>{var z=In();d(P,z)},P=>{var z=Sn();d(P,z)}),l(_e);var R=a(a(_e,!0));j(R,()=>e.onremove&&r(),P=>{var z=Mn(),X=fe(z);X.__click=[Tn,i];var T=a(a(X,!0));j(T,()=>t(i),C=>{var O=Pn(),Y=n(O);Y.__click=[An,i,e],l(O),pe(3,O,()=>ye),d(C,O)});var A=a(a(T,!0));j(A,()=>e.onduplicate,C=>{var O=En();O.__click=[Ln,e],d(C,O)}),d(P,z)});var N=a(a(R,!0));Te(N,P=>g(u,M(P)),()=>t(u)),N.__click=[kn,I,y,b,f];var J=n(N);j(J,r,P=>{var z=Dn();d(P,z)},P=>{var z=On();d(P,z)}),l(N);var W=a(a(N,!0));j(W,()=>t(w),P=>{var z=Rn(),X=n(z);$e(X,{status:"error",children:(T,A)=>{var C=Nn(),O=n(C);l(C),B(()=>ge(O,t(w))),d(T,C)},$$slots:{default:!0}}),l(z),d(P,z)});var K=a(a(W,!0));j(K,()=>e.onclose&&r(),P=>{var z=Hn();z.__click=[Vn,e];var X=n(z);j(X,()=>t(k),T=>{var A=Cn();d(T,A)},T=>{var A=Fn();d(T,A)}),l(z),d(P,z)}),l(D),B(()=>_e.disabled=r()&&!t(k)),he(le,()=>t(s),P=>g(s,P)),d(o,q),oe()}je(["click","keydown"]);var Un=c('<div class="panel p_md"><!></div>');function Wn(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{remove_project:u,duplicate_project:q,update_project:S,create_project:D}=t(i);return[u,q,S,D]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>t(s)[3]),I=v(()=>r().editing_project_data??tt.parse({})),y=v(()=>r().project_datas.some(u=>u.id===t(I).id));var m=Un(),w=n(m),p=v(()=>t(y)?t(k):t(f));Jn(w,{get editing(){return t(y)},get project_data(){return t(I)},get onsubmit(){return t(p)},get onremove(){return t(_)},get onduplicate(){return t(b)},onclose:()=>r().editing_project=!1}),l(m),d(o,m),oe()}var Yn=c('<section class="card svelte-8muejm"><!></section>'),Gn=c('<section class="card svelte-8muejm"><!></section>'),Kn=c('<div class="width_sm svelte-8muejm"><!> <!> <section class="card svelte-8muejm"><div class="panel p_md"><header><h2 class="my_0">controls</h2></header> <!> <div class="mb_lg"><!></div> <!> <aside>Earbetter supports MIDI devices like piano keyboards, connect and click:</aside> <!></div></section></div>'),Xn=(o,e)=>t(e)(),Zn=c(`<section class="card svelte-8muejm"><div class="panel p_md"><p>Earbetter is an <a href="https://wikipedia.org/wiki/Ear_training">ear training</a> tool:</p> <ul><li>each level is a standalone challenge that's a series of trials</li> <li> </li> <li>realms group levels into bigger challenges</li> <li>projects group realms so you can customize various experiences</li> <li>levels can be shared via their links or exporting/importing data</li></ul> <p>See also the 3 minute <a href="https://www.youtube.com/watch?v=zW2zI1A_Ikw">video intro on YouTube</a> and <a href="https://github.com/ryanatkn/earbetter">the readme</a>.</p> <aside>Earbetter is in early development, and many things are unfinished and unknown - feedback
						is appreciated on <a href="https://github.com/ryanatkn/earbetter">the GitHub discussions and issues</a>.</aside> <div class="box row"><button type="button" class="m_0">ok, hide this</button></div></div></section>`),Qn=c('<section class="card svelte-8muejm"><!></section>'),$n=c('<section class="card svelte-8muejm"><!></section>'),eo=c('<section class="card svelte-8muejm"><div class="panel p_md"><!></div></section>'),to=c('<div class="width_sm svelte-8muejm"><!> <!></div>'),ao=c('<!> <div class="map svelte-8muejm"><!> <div class="width_sm svelte-8muejm"><!> <section class="card svelte-8muejm"><!></section> <!></div> <!></div>',1);function ro(o,e){ne(e,!0);const r=$(e,"app",7),i=v(r),s=v(()=>{let{toggle_trainer_help:R,play_level:N,edit_level:J,remove_level:W,duplicate_level:K,create_level:P,update_level:z}=t(i);return[R,N,J,W,K,P,z]}),_=v(()=>t(s)[0]),b=v(()=>t(s)[1]),k=v(()=>t(s)[2]),f=v(()=>t(s)[3]),I=v(()=>t(s)[4]),y=v(()=>t(s)[5]),m=v(()=>t(s)[6]),w=Ft();window.ac=w;const p=v(()=>r().draft_level_data??et.parse({})),u=v(()=>r().levels?r().levels.some(R=>R.id===t(p).id):!1),q=v(()=>{var R;return!((R=r().realms)!=null&&R.length)});var S=ao(),D=fe(S);ea(D,{get midi_access(){return r().midi_access},onnotestart:(R,N)=>{Bt(r(),w(),R,Jt(r().volume,N),r().instrument)},onnotestop:R=>{gt(R)}});var H=a(a(D,!0)),te=n(H);j(te,()=>r().project_datas.length,R=>{var N=Kn(),J=n(N);j(J,()=>r().selected_project_data,F=>{var h=Yn(),L=n(h);ol(L,{get app(){return r()}}),l(h),pe(3,h,()=>ye),d(F,h)});var W=a(a(J,!0));j(W,()=>(r().editing_project&&r().editing_project_data)??!r().selected_project_data,F=>{var h=Gn(),L=n(h);Wn(L,{get app(){return r()}}),l(h),pe(3,h,()=>ye),d(F,h)});var K=a(a(W,!0)),P=n(K),z=n(P);n(z),l(z);var X=a(a(z,!0));sl(X,{});var T=a(a(X,!0)),A=n(T);Xt(A,{get volume(){return r().volume},set volume(F){r().volume=F}}),l(T);var C=a(a(T,!0));Kt(C,{get instrument(){return r().instrument},set instrument(F){r().instrument=F}});var O=a(a(C,!0)),Y=a(a(O,!0));Zt(Y,{get midi_state(){return r()}}),l(P),l(K),l(N),pe(3,K,()=>ye),d(R,N)});var G=a(a(te,!0)),Z=n(G);j(Z,()=>r().show_trainer_help,R=>{var N=Zn(),J=n(N),W=n(J);a(n(W)),Pe(),l(W);var K=a(a(W,!0)),P=n(K),z=a(a(P,!0)),X=n(z);X.nodeValue=`your level score is the sum of mistakes in your best ${Wt}
							runs, win a ★ at 0`,l(z);var T=a(a(z,!0)),A=a(a(T,!0));a(a(A,!0)),l(K);var C=a(a(K,!0)),O=a(n(C));a(a(O,!0)),Pe(),l(C);var Y=a(a(C,!0));a(n(Y)),Pe(),l(Y);var F=a(a(Y,!0)),h=n(F);h.__click=[Xn,_],l(F),l(J),l(N),pe(3,N,()=>ye),d(R,N)});var ie=a(a(Z,!0)),ve=n(ie);Tl(ve,{get app(){return r()}}),l(ie);var le=a(ie,!0);le.nodeValue="  ";var _e=a(le);j(_e,()=>r().editing_realm&&r().editing_realm_data||t(q),R=>{var N=Qn(),J=n(N);on(J,{get app(){return r()}}),l(N),pe(3,N,()=>ye),d(R,N)}),l(G);var ue=a(a(G,!0));j(ue,()=>r().project_datas.length,R=>{var N=to(),J=n(N);j(J,()=>r().levels,P=>{var z=$n(),X=n(z);pn(X,{get app(){return r()},get levels(){return r().levels}}),l(z),pe(3,z,()=>ye),d(P,z)});var W=a(J,!0);W.nodeValue="  ";var K=a(W);j(K,()=>{var P;return r().selected_realm_id&&(r().editing_level&&r().levels||((P=r().levels)==null?void 0:P.length)===0)},P=>{var z=eo(),X=n(z),T=n(X),A=v(()=>t(u)?t(m):t(y));Br(T,{get editing(){return t(u)},get level_data(){return t(p)},get onsubmit(){return t(A)},get onremove(){return t(f)},get onduplicate(){return t(I)},onplay:async(C,O)=>{O&&t(m)(C),await t(b)(C.id)},onclose:()=>t(k)(null)}),l(X),l(z),pe(2,z,()=>ye),d(P,z)}),l(N),d(R,N)}),l(H),d(o,S),oe()}je(["click"]);var lo=c('<main><!> <!> <!> <div class="box"><!></div></main>');function ko(o,e){ne(e,!0);const r=Ut();var i=lo();ha(I=>{pa.title="Earbetter trainer"});var s=n(i);Ca(s,{onclick:()=>ka(wa+"/")});var _=a(a(s,!0));ja(_);var b=a(a(_,!0));ro(b,{app:r});var k=a(a(b,!0)),f=n(k);za(f,{}),l(k),l(i),d(o,i),oe()}export{ko as component};
