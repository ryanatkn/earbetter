import{a as k,t as C,e as ae,b as B,h as ve,i as de}from"../chunks/disclose-version.BKNlT-YU.js";import{p as X,t as S,a as Y,g as d,d as se,c as r,s as a,r as s,n as me,f as ne,a1 as K,$ as ce,a3 as ue,k as O}from"../chunks/index-client.BoyXeee0.js";import{p as N,i as q,a as D}from"../chunks/props.D3HXCBXF.js";import{s as v,r as j,t as pe,e as Q,c as ge}from"../chunks/string.CDuhMoWR.js";import{M as fe,B as be,b as xe,P as he}from"../chunks/Back_Button.DfsKk70_.js";import{a as z,b as F,t as ye,m as U,c as ke,l as we,d as Ie,p as Me,e as Z,f as Ae,z as $e,g as ee,h as Se,j as Be,k as te,n as Ce,w as Ee,o as Pe}from"../chunks/index.6f_cqUmM.js";import{g as Te,b as De}from"../chunks/entry.DPlkN-b-.js";import{b as H,i as je,a as ze,s as Fe,I as He,V as Ne,c as Re}from"../chunks/Init_Midi_Button.BCbCnXYu.js";import{H as Ve}from"../chunks/Header.DiD4lJaf.js";import{F as We}from"../chunks/Footer.BwcrWqrR.js";import{A as Ge}from"../chunks/Alert.C_cEhEOU.js";var Ke=C("<div><!></div>"),Oe=C('<div class="midi-range-control"><div class="box row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="range"> <input type="number"></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="range"> <input type="number"></label></div> <!></div>');function Xe(w,m){X(m,!0);let e=N(m,"min_note",15),f=N(m,"max_note",15);const b=se(()=>e()>f()?"note min cannot be larger than the max":!1);var c=Oe(),o=r(c),u=r(o),h=a(r(u),2),M=r(h,!0);s(h);var l=a(h,2);j(l),v(l,"step",1),v(l,"min",z),v(l,"max",F);var n=a(l,2);j(n),v(n,"step",1),v(n,"min",z),v(n,"max",F),s(u);var i=a(u,2),_=a(r(i),2),x=r(_,!0);s(_);var p=a(_,2);j(p),v(p,"step",1),v(p,"min",z),v(p,"max",F);var g=a(p,2);j(g),v(g,"step",1),v(g,"min",z),v(g,"max",F),s(i),s(o);var y=a(o,2);q(y,()=>d(b),P=>{var I=Ke(),A=r(I);Ge(A,{status:"error",children:(R,T)=>{me();var $=ae();S(()=>B($,d(b))),k(R,$)},$$slots:{default:!0}}),s(I),ye(3,I,()=>ke),k(P,I)}),s(c),S(()=>{pe(c,"error",!!d(b)),B(M,U[e()]),B(x,U[f()])}),H(l,e),H(n,e),H(p,f),H(g,f),k(w,c),Y()}var Ye=(w,m)=>m(we(w.currentTarget.value)),qe=C("<option> </option>"),Je=C("<option> <!></option>"),Le=C('<label class="text_align_center svelte-199vc6u"><div class="title">scale</div> <select></select></label> <label class="text_align_center svelte-199vc6u"><div class="title">key</div> <select></select></label>',1);function Qe(w,m){X(m,!0);let e=N(m,"scale",15),f=N(m,"key",15);var b=Le(),c=ne(b),o=a(r(c),2);je(o,()=>e().name);var u;o.__input=[Ye,e],Q(o,20,()=>Ie,l=>l,(l,n)=>{var i=qe(),_={},x=r(i,!0);s(i),S(()=>{_!==(_=n.name)&&(i.value=(i.__value=n.name)==null?"":n.name),B(x,n.name)}),k(l,i)}),s(o),s(c);var h=a(c,2),M=a(r(h),2);Q(M,20,()=>Me,l=>l,(l,n)=>{var i=Je(),_={},x=r(i,!0),p=a(x);q(p,()=>n in Z,g=>{var y=ae();S(()=>B(y,`/${Z[n]??""}`)),k(g,y)}),s(i),S(()=>{_!==(_=n)&&(i.value=(i.__value=n)==null?"":n),B(x,n)}),k(l,i)}),s(M),s(h),S(()=>{u!==(u=e().name)&&(o.value=(o.__value=e().name)==null?"":e().name,Fe(o,e().name))}),ze(M,f),k(w,b),Y()}ve(["input"]);var Ue=C('<!> <main class="svelte-3fkhg9"><!> <!> <div class="piano_wrapper svelte-3fkhg9"><!></div> <form class="width_sm panel p_md"><fieldset><!> <div class="row mb_lg"><!></div> <!></fieldset> <fieldset><!></fieldset> <fieldset class="row"><!></fieldset></form> <!></main>',1);function vt(w,m){X(m,!0);const e=Ae.get(),f=$e.object({min_note:ee.default(36),max_note:ee.default(96)}),b="piano",c=Se(b,()=>f.parse({}),f.parse);let o=K(D(c.min_note)),u=K(D(c.max_note));const h=()=>({min_note:d(o),max_note:d(u)});ce(()=>Pe(b,h()));const l=Be.get(),{playing_notes:n}=e;let i=K(void 0);const _=20,x=(t,E=null)=>{(!e.enabled_notes||e.enabled_notes.has(t))&&Ce(e,l(),t,Ee(e.volume,E),e.instrument)};var p=Ue();de(t=>{ue.title="Earbetter: piano"});var g=ne(p);fe(g,{get midi_access(){return e.midi_access},onnotestart:(t,E)=>x(t,E),onnotestop:t=>te(t)});var y=a(g,2),P=r(y);be(P,{onclick:()=>Te(De+"/")});var I=a(P,2);Ve(I);var A=a(I,2);ge(A,"padding",`${_}px`);var R=r(A);q(R,()=>d(i),t=>{var E=se(()=>d(i)-_*2);he(t,{get width(){return d(E)},get min_note(){return d(o)},get max_note(){return d(u)},pressed_keys:n,get enabled_notes(){return e.enabled_notes},onpress:G=>x(G),onrelease:G=>te(G),middle_c_label:!0,allow_sticking:!0})}),s(A);var T=a(A,2),$=r(T),J=r($);He(J,{get instrument(){return e.instrument},set instrument(t){e.instrument=t}});var V=a(J,2),ie=r(V);Qe(ie,{get scale(){return e.scale},set scale(t){e.scale=t},get key(){return e.key},set key(t){e.key=t}}),s(V);var re=a(V,2);Ne(re,{get volume(){return e.volume},set volume(t){e.volume=t}}),s($);var W=a($,2),oe=r(W);Re(oe,{midi_state:e}),s(W);var L=a(W,2),le=r(L);Xe(le,{get min_note(){return d(o)},set min_note(t){O(o,D(t))},get max_note(){return d(u)},set max_note(t){O(u,D(t))}}),s(L),s(T);var _e=a(T,2);We(_e,{}),s(y),xe(y,"clientWidth",t=>O(i,t)),k(w,p),Y()}export{vt as component};
