import"../chunks/DsnmJJEf.js";import{a_ as ma,i as t,at as fa,h as ga,u as ba,a$ as xt,q as ha,a3 as Se,p as ce,O as Pe,$ as D,f as p,a as je,d as s,b0 as We,Q as m,r as n,s as i,j as d,t as V,e as ge,b as _,c as ve,b1 as pa,m as St,l as N,k as Tt,_ as Ce,n as Ne,b2 as wt,ae as ka,a4 as ya,a5 as xa}from"../chunks/CJaerUHp.js";import{g as wa}from"../chunks/Bv49_G5z.js";import{e as Fe,i as ja,d as Ie,s as X,m as tt,g as za,c as At,f as qa,p as Ia,b as Ee,n as Sa,r as Ta}from"../chunks/yq475m88.js";import{H as Aa}from"../chunks/9h-00wla.js";import{m as Pa,F as Ea}from"../chunks/SeRD_1VY.js";import{J as Pt,R as vt,d as Et,T as Lt,l as La,U as Ma,I as Da,k as Mt,n as dt,p as Oa,W as ut,X as Dt,q as Ot,w as Rt,Y as Ra,f as Nt,Z as lt,m as jt,a as $e,b as et,_ as Na,t as xe,c as we,$ as rt,M as Ct,a0 as nt,a1 as Ft,s as Jt,a2 as Ca,a3 as Fa}from"../chunks/1gEw6I4J.js";import{p as te,i as y}from"../chunks/C-YpJhoF.js";import{b as ye,I as Bt,V as Ht,a as Vt}from"../chunks/mg-1psfP.js";import{M as Ut,P as Wt,b as Ja,B as Ba}from"../chunks/B077m1lY.js";import{b as Me}from"../chunks/DEPAWzjT.js";import{D as Ue}from"../chunks/D3rPxOIx.js";import{A as at}from"../chunks/CFnVj1PO.js";import{L as Ha}from"../chunks/VM_Ofw0m.js";function Va(l){let e=0,a=fa(0),r;return()=>{ma()&&(t(a),ga(()=>(e===0&&(r=ba(()=>l(()=>xt(a)))),e+=1,()=>{ha(()=>{e-=1,e===0&&(r?.(),r=void 0,xt(a))})})))}}class Ua{#e;#t;constructor(e,a){this.#e=e,this.#t=Va(a)}get current(){return this.#t(),this.#e()}}var zt=Object.prototype.hasOwnProperty;function qt(l,e,a){for(a of l.keys())if(De(a,e))return a}function De(l,e){var a,r,c;if(l===e)return!0;if(l&&e&&(a=l.constructor)===e.constructor){if(a===Date)return l.getTime()===e.getTime();if(a===RegExp)return l.toString()===e.toString();if(a===Array){if((r=l.length)===e.length)for(;r--&&De(l[r],e[r]););return r===-1}if(a===Set){if(l.size!==e.size)return!1;for(r of l)if(c=r,c&&typeof c=="object"&&(c=qt(e,c),!c)||!e.has(c))return!1;return!0}if(a===Map){if(l.size!==e.size)return!1;for(r of l)if(c=r[0],c&&typeof c=="object"&&(c=qt(e,c),!c)||!De(r[1],e.get(c)))return!1;return!0}if(a===ArrayBuffer)l=new Uint8Array(l),e=new Uint8Array(e);else if(a===DataView){if((r=l.byteLength)===e.byteLength)for(;r--&&l.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(l)){if((r=l.byteLength)===e.byteLength)for(;r--&&l[r]===e[r];);return r===-1}if(!a||typeof l=="object"){r=0;for(a in l)if(zt.call(l,a)&&++r&&!zt.call(e,a)||!(a in e)||!De(l[a],e[a]))return!1;return Object.keys(e).length===r}}return l!==l&&e!==e}var Wa=(l,e)=>m(e,l.currentTarget.value,!0),Ya=(l,e,a,r,c,o)=>e.oninput?.(t(a),t(r)?{scale:c(),octaves:o()}:void 0),Ga=(l,e)=>e(La(l.currentTarget.value)),Xa=p("<option> </option>"),Ka=p('<small><textarea class="preview width_sm panel svelte-nk5x9z"></textarea></small> <button type="button" class="accent mb_lg">use these intervals</button> <label><div class="title text_align_center">scale</div> <select></select></label> <label><div class="title text_align_center">octaves</div> <div class="text_align_center"> </div> <input type="range"/></label>',1);function Qa(l,e){ce(e,!0);let a=te(e,"scale",31,()=>Pe(Pt)),r=te(e,"octaves",15,1);const c=d(()=>Ma(a(),r())),o=d(()=>vt(t(c))),b=Pe(vt(e.intervals));let g=D(Pe(b));const f=d(()=>(t(c),Date.now())),A=d(()=>(e.intervals,t(g),Date.now())),j=d(()=>t(f)>t(A)),k=d(()=>t(j)?t(o):t(g)),h=d(()=>Lt(t(k))),q=d(()=>!De(e.intervals,t(h))),z=d(()=>!!t(h).length);var L=Ka(),J=je(L),P=s(J);We(P),P.__input=[Wa,g],n(J);var M=i(J,2);M.__click=[Ya,e,h,j,a,r];var O=i(M,2),E=i(s(O),2);E.__change=[Ga,a],Fe(E,20,()=>Et,ne=>ne,(ne,oe)=>{var R=Xa(),F=s(R,!0);n(R);var ae={};V(()=>{ge(F,oe.name),ae!==(ae=oe.name)&&(R.value=(R.__value=oe.name)??"")}),_(ne,R)}),n(E);var K;ja(E),n(O);var H=i(O,2),I=i(s(H),2),U=s(I,!0);n(I);var de=i(I,2);Ie(de),X(de,"min",1),X(de,"max",6),n(H),V(()=>{tt(P,t(k)),M.disabled=!t(q)||!t(z),K!==(K=a().name)&&(E.value=(E.__value=a().name)??"",za(E,a().name)),ge(U,r())}),ye(de,r),_(l,L),ve()}Se(["input","click","change"]);const It=new Ua(()=>window.innerWidth,l=>pa(window,"resize",l));var Za=(l,e)=>{m(e,new Set,!0)},$a=(l,e,a)=>{e.oninput?.(t(a))},el=p('<!> <button class="mb_lg" type="button">clear selection</button> <button type="button" class="accent">select <!> </button>',1),tl=p("<option> </option>"),al=(l,e,a)=>e(t(a)),ll=p('<button type="button"> </button>'),rl=(l,e)=>e(l.currentTarget.value),nl=p('<!> <div class="notes_input pt_lg svelte-l5hmn0"><!> <div class="piano_wrapper svelte-l5hmn0"><!></div> <section class="box"><label class="mb_lg"><div class="title text_align_center">key</div> <select></select></label> <div class="scales mb_lg svelte-l5hmn0"></div> <!> <div class="notes width_sm svelte-l5hmn0"><blockquote class="panel my_lg"><textarea></textarea></blockquote></div></section> <form class="width_sm panel p_md"><fieldset><!> <!></fieldset> <fieldset><!></fieldset></form></div>',1);function il(l,e){ce(e,!0);const a=T=>{var v=el(),x=je(v);St(x,()=>e.before_buttons);var $=i(x,2);$.__click=[Za,o];var Q=i($,2);Q.__click=[$a,e,b];var w=i(s(Q));{var S=G=>{var B=N("all");_(G,B)},Z=G=>{var B=N();V(()=>ge(B,t(f))),_(G,B)};y(w,G=>{t(f)===0?G(S):G(Z,!1)})}var Y=i(w);n(Q),V(G=>{$.disabled=t(f)===0,Q.disabled=!t(h),ge(Y,` tonic${G??""}`)},[()=>Ia(t(f))]),_(T,v)},r=te(e,"audio_state",7),{playing_notes:c}=r();let o=D(void 0);const b=d(()=>t(o)&&Array.from(t(o)).sort((T,v)=>T-v)),g=d(()=>t(o)??e.notes),f=d(()=>t(g).size),A=d(()=>t(b)&&ut(t(b))),j=T=>{m(o,new Set(Dt(T)),!0)},k=d(()=>ut(Array.from(e.notes).sort((T,v)=>T-v))),h=d(()=>!!t(b)&&t(A)!==t(k)),q=T=>{const v=new Set(t(g));v.has(T)?v.delete(T):v.add(T),m(o,v,!0)};let z=D(Pe(Da));const L=Mt.get(),J=20,P=(T,v=null)=>{Ot(r(),L(),T,Rt(r().volume,v),r().instrument)},M=T=>{const v=Ra(T,t(z),e.min_note,e.max_note);if(!t(o)||!t(b)){m(o,v,!0);return}let x=!0;for(const Q of v)if(!t(o).has(Q)){x=!1;break}const $=x?t(b).filter(Q=>!v.has(Q)):t(b).concat(Array.from(v));m(o,new Set($),!0)};var O=nl(),E=je(O);Ut(E,{get midi_access(){return r().midi_access},onnotestart:(T,v)=>P(T,v),onnotestop:T=>dt(T)});var K=i(E,2),H=s(K);a(H);var I=i(H,2);At(I,"",{},{padding:"20px"});var U=s(I);{var de=T=>{{let v=d(()=>It.current-J*5);Wt(T,{get width(){return t(v)},get min_note(){return e.min_note},get max_note(){return e.max_note},max_height:300,get pressed_keys(){return c},get highlighted_keys(){return t(g)},middle_c_label:!0,allow_sticking:!0,onpress:x=>{q(x),P(x)},onrelease:x=>{dt(x)}})}};y(U,T=>{It.current&&T(de)})}n(I);var ne=i(I,2),oe=s(ne),R=i(s(oe),2);Fe(R,20,()=>Oa,T=>T,(T,v)=>{var x=tl(),$=s(x,!0);n(x);var Q={};V(()=>{ge($,v),Q!==(Q=v)&&(x.value=(x.__value=v)??"")}),_(T,x)}),n(R),n(oe);var F=i(oe,2);Fe(F,21,()=>Et,T=>T.name,(T,v)=>{var x=ll();x.__click=[al,M,v];var $=s(x,!0);n(x),V(()=>ge($,t(v).name)),_(T,x)}),n(F);var ae=i(F,2);a(ae);var me=i(ae,2),fe=s(me),le=s(fe);We(le),le.__change=[rl,j],n(fe),n(me),n(ne);var ee=i(ne,2),W=s(ee),be=s(W);Bt(be,{get instrument(){return r().instrument},set instrument(T){r().instrument=T}});var ze=i(be,2);Ht(ze,{get volume(){return r().volume},set volume(T){r().volume=T}}),n(W);var Te=i(W,2),he=s(Te);Vt(he,{get midi_state(){return r()}}),n(Te),n(ee),n(K),V(()=>tt(le,t(A))),qa(R,()=>t(z),T=>m(z,T)),_(l,O),ve()}Se(["click","change"]);var sl=(l,e)=>{navigator.clipboard.writeText(e.text),e.oncopy?.()},ol=p('<button type="button" class="my_lg"><!></button>');function mt(l,e){ce(e,!0);var a=ol();a.__click=[sl,e];var r=s(a);{var c=b=>{var g=Tt(),f=je(g);St(f,()=>e.children),_(b,g)},o=b=>{var g=N("copy to clipboard");_(b,g)};y(r,b=>{e.children?b(c):b(o,!1)})}n(a),_(l,a),ve()}Se(["click"]);const _l=(l,e,a,r,c)=>{m(e,"");try{const o=JSON.parse(t(a));o&&!o.id&&(o.id=Na());const b=lt.parse(o);r.onsubmit(b)}catch(o){console.error("failed to import data",o),m(e,o.message||"unknown error",!0)}m(c,!1)},cl=(l,e,a,r,c)=>{m(e,m(a,JSON.stringify(r()),!0),!0),m(c,!0)};var vl=(l,e)=>m(e,Lt(l.currentTarget.value)),dl=(l,e)=>m(e,!0),ul=p("<!> <br/>",1),ml=(l,e)=>m(e,Dt(l.currentTarget.value)),fl=(l,e)=>m(e,!0),gl=(l,e,a)=>e.onsubmit(a()),bl=(l,e)=>m(e,!t(e)),hl=(l,e,a)=>{m(e,!1),a.onremove(a.level_data.id)},pl=p('<div class="pb_md"><button type="button" class="color_c w_100 svelte-h4qokl">✕ confirm remove</button></div>'),kl=(l,e)=>e.onduplicate(e.level_data.id),yl=p('<button type="button" class="svelte-h4qokl">duplicate level</button>'),xl=p('<button type="button" class="svelte-h4qokl">remove level</button> <!> <!>',1),wl=p("<pre> </pre>"),jl=p('<div class="overflow_x_auto"><!></div>'),zl=(l,e,a,r)=>e.onplay(t(a)?r():e.level_data,t(a)),ql=p('<button type="button" class="svelte-h4qokl">play!</button>'),Il=(l,e)=>e.onclose(e.level_data.id),Sl=p('<button type="button" class="svelte-h4qokl"><!></button>'),Tl=p('<div class="importing pane shadow_d_xl p_xl width_md mx_auto svelte-h4qokl"><h2 class="my_0">import level data</h2> <!> <textarea class="svelte-h4qokl"></textarea> <button type="button" class="svelte-h4qokl">import project data</button></div>'),Al=p('<div class="pane mx_auto shadow_d_xl p_xl width_md box"><h2 class="my_0">pick intervals</h2> <!> <button type="button" class="svelte-h4qokl">cancel</button></div>'),Pl=p('<button type="button" class="mb_lg svelte-h4qokl">cancel</button>'),El=p('<div class="pane mx_auto shadow_d_xl py_xl box"><h2 class="my_0">pick tonics</h2> <!></div>'),Ll=p(`<form class="level_def_form w_100"><header><h2 class="my_0"><!></h2></header> <div class="fields svelte-h4qokl"><fieldset><label><div class="title">name</div> <input/></label></fieldset> <fieldset><label class="mb_0" title="the semitones to include relative to the tonic"><div class="title">intervals</div> <input/></label> <button type="button" class="svelte-h4qokl">pick intervals</button> <details><summary>about <code>intervals</code></summary> <p><code>intervals</code> is a comma-separated list of numbers representing the <a href="https://wikipedia.org/wiki/Interval_(music)">musical intervals</a> used in the
					level, aka the number of piano keys (<a href="https://wikipedia.org/wiki/Semitone">semitones</a>) separating each note from the <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> (see below)</p> <p>for example, to practice distinguishing between the <a href="https://wikipedia.org/wiki/Perfect_fourth">perfect fourth</a> and <a href="https://wikipedia.org/wiki/Perfect_fifth">perfect fifth</a>, enter "<code>5, 7</code>"</p> <p>negative numbers are allowed</p></details></fieldset> <fieldset><label title="the number of trials per level"><div class="title">trial count</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"/> <input type="range"/></div></label></fieldset> <fieldset><label title="the number of notes per trial"><div class="title">sequence length</div> <div class="row"><input class="small_input svelte-h4qokl" type="number"/> <input type="range"/></div></label></fieldset> <fieldset class="row"><label class="text_align_center"><div class="title">lowest note</div> <div> </div> <input type="number"/> <input type="range"/></label> <label class="text_align_center"><div class="title">highest note</div> <div> </div> <input type="number"/> <input type="range"/></label></fieldset> <!> <fieldset><label class="mb_0" title="the possible starting notes for each trial"><div class="title">tonics</div> <input placeholder="all"/></label> <button type="button" class="svelte-h4qokl">pick tonics</button> <details><summary>about <code>tonics</code></summary> <p>The <a href="https://wikipedia.org/wiki/Tonic_(music)">tonic</a> is like the "base" or "home"
					note, and for our purposes it's always the first note played in a trial. Other notes in the
					trial are calculated from the tonic and intervals. (see above)</p></details></fieldset> <button type="button" class="accent svelte-h4qokl"><!></button> <!> <button type="button" class="svelte-h4qokl"><!></button> <!> <!> <!></div></form> <!> <!> <!>`,1);function Ml(l,e){ce(e,!0);const a=te(e,"editing",3,!1),r=Nt.get();let c=D(!1),o=D(Pe(e.level_data.name));const b=d(()=>t(o)?.trim());let g=D(e.level_data.intervals),f=D(e.level_data.tonics);const A=d(()=>t(f)?t(f).filter(u=>u>=t(h)&&u<=t(q)):t(f));let j=D(Pe(e.level_data.trial_count)),k=D(Pe(e.level_data.sequence_length)),h=D(Pe(e.level_data.min_note)),q=D(Pe(e.level_data.max_note));const z=()=>lt.parse({id:e.level_data.id,name:t(b),intervals:t(g),tonics:t(A),trial_count:t(j),sequence_length:t(k),min_note:t(h),max_note:t(q)});Ce(()=>{m(o,e.level_data.name,!0),m(g,e.level_data.intervals),m(f,e.level_data.tonics),m(j,e.level_data.trial_count,!0),m(k,e.level_data.sequence_length,!0),m(h,e.level_data.min_note,!0),m(q,e.level_data.max_note,!0)});const L=d(()=>t(b)!==e.level_data.name||t(j)!==e.level_data.trial_count||t(k)!==e.level_data.sequence_length||t(h)!==e.level_data.min_note||t(q)!==e.level_data.max_note||!De(t(g),e.level_data.intervals)||!De(t(A),e.level_data.tonics));let J=D(!1),P=D(!1),M=D(!1),O=D(""),E=D("");const K=d(()=>t(O)!==t(E));let H=D("");Ce(()=>{e.level_data,m(H,"")});let I=D(void 0),U=D(void 0),de=D(void 0),ne=D(void 0);const oe=d(()=>t(f)&&new Set(t(f)));let R=D(Pe(Pt)),F=D(1),ae=D(void 0);const me=d(()=>t(h)>=t(q));var fe=Ll(),le=je(fe),ee=s(le),W=s(ee),be=s(W);{var ze=u=>{var C=N("editing level");_(u,C)},Te=u=>{var C=N("create a new level");_(u,C)};y(be,u=>{a()?u(ze):u(Te,!1)})}n(W),n(ee);var he=i(ee,2),T=s(he),v=s(T),x=i(s(v),2);Ie(x),n(v),n(T);var $=i(T,2),Q=s($),w=i(s(Q),2);Ie(w),w.__change=[vl,g],Me(w,u=>m(de,u),()=>t(de)),n(Q);var S=i(Q,2);S.__click=[dl,P],Ne(2),n($);var Z=i($,2),Y=s(Z),G=i(s(Y),2),B=s(G);Ie(B),X(B,"min",1);var ie=i(B,2);Ie(ie),X(ie,"min",1),X(ie,"max",20),n(G),n(Y),n(Z);var ue=i(Z,2),Ae=s(ue),Ye=i(s(Ae),2),Ge=s(Ye);Ie(Ge),X(Ge,"min",2);var Xe=i(Ge,2);Ie(Xe),X(Xe,"min",2),X(Xe,"max",16),n(Ye),n(Ae),n(ue);var it=i(ue,2),st=s(it),ot=i(s(st),2),Yt=s(ot,!0);n(ot);var Oe=i(ot,2);Ie(Oe),X(Oe,"step",1);var Je=i(Oe,2);Ie(Je),X(Je,"step",1),n(st);var ft=i(st,2),_t=i(s(ft),2),Gt=s(_t,!0);n(_t);var Re=i(_t,2);Ie(Re),X(Re,"step",1);var Be=i(Re,2);Ie(Be),X(Be,"step",1),n(ft),n(it);var gt=i(it,2);{var Xt=u=>{at(u,{status:"error",children:(C,qe)=>{Ne();var _e=N("the lowest note must be lower than the highest");_(C,_e)},$$slots:{default:!0}})},Kt=u=>{var C=ul(),qe=je(C);{let _e=d(()=>t(ae)??0);Wt(qe,{get width(){return t(_e)},max_height:50,get min_note(){return t(h)},get max_note(){return t(q)},get highlighted_keys(){return t(oe)},clickable:!1,middle_c_label:!0})}Ne(2),_(u,C)};y(gt,u=>{t(me)?u(Xt):u(Kt,!1)})}var Ke=i(gt,2),ct=s(Ke),Qe=i(s(ct),2);Ie(Qe),Qe.__change=[ml,f],Me(Qe,u=>m(ne,u),()=>t(ne)),n(ct);var Qt=i(ct,2);Qt.__click=[fl,M],Ne(2),n(Ke);var He=i(Ke,2);He.__click=[gl,e,z];var Zt=s(He);{var $t=u=>{var C=N("save changes to level");_(u,C)},ea=u=>{var C=N("create level");_(u,C)};y(Zt,u=>{a()?u($t):u(ea,!1)})}n(He);var bt=i(He,2);{var ta=u=>{var C=xl(),qe=je(C);qe.__click=[bl,c];var _e=i(qe,2);{var pe=se=>{var Le=pl(),Ze=s(Le);Ze.__click=[hl,c,e],n(Le),xe(3,Le,()=>we),_(se,Le)};y(_e,se=>{t(c)&&se(pe)})}var re=i(_e,2);{var ke=se=>{var Le=yl();Le.__click=[kl,e],_(se,Le)};y(re,se=>{e.onduplicate&&se(ke)})}_(u,C)};y(bt,u=>{e.onremove&&a()&&u(ta)})}var Ve=i(bt,2);Ve.__click=[cl,O,E,z,J];var aa=s(Ve);{var la=u=>{var C=N("import/export data");_(u,C)},ra=u=>{var C=N("import data");_(u,C)};y(aa,u=>{a()?u(la):u(ra,!1)})}n(Ve),Me(Ve,u=>m(U,u),()=>t(U));var ht=i(Ve,2);{var na=u=>{var C=jl(),qe=s(C);at(qe,{status:"error",children:(_e,pe)=>{var re=wl(),ke=s(re,!0);n(re),V(()=>ge(ke,t(H))),_(_e,re)},$$slots:{default:!0}}),n(C),_(u,C)};y(ht,u=>{t(H)&&u(na)})}var pt=i(ht,2);{var ia=u=>{var C=ql();C.__click=[zl,e,L,z],_(u,C)};y(pt,u=>{e.onplay&&a()&&u(ia)})}var sa=i(pt,2);{var oa=u=>{var C=Sl();C.__click=[Il,e];var qe=s(C);{var _e=re=>{var ke=N("discard changes and stop editing");_(re,ke)},pe=re=>{var ke=N("close level editor");_(re,ke)};y(qe,re=>{t(L)?re(_e):re(pe,!1)})}n(C),_(u,C)};y(sa,u=>{e.onclose&&a()&&u(oa)})}n(he),n(le);var kt=i(le,2);{var _a=u=>{Ue(u,{onclose:()=>{m(J,!1),t(U)?.focus()},children:(C,qe)=>{var _e=Tl(),pe=i(s(_e),2);mt(pe,{get text(){return t(E)},oncopy:()=>{t(I)?.select()}});var re=i(pe,2);We(re),Me(re,se=>m(I,se),()=>t(I));var ke=i(re,2);ke.__click=[_l,H,E,e,J],n(_e),V(()=>{ke.disabled=!t(K),X(ke,"title",t(K)?void 0:"data has not changed")}),ye(re,()=>t(E),se=>m(E,se)),_(C,_e)},$$slots:{default:!0}})};y(kt,u=>{t(J)&&u(_a)})}var yt=i(kt,2);{var ca=u=>{Ue(u,{onclose:()=>{m(P,!1),t(de)?.focus()},children:(qe,_e=wt)=>{var pe=Al(),re=i(s(pe),2);Qa(re,{get intervals(){return t(g)},oninput:se=>{m(g,se),_e()()},get scale(){return t(R)},set scale(se){m(R,se,!0)},get octaves(){return t(F)},set octaves(se){m(F,se,!0)}});var ke=i(re,2);ke.__click=function(...se){_e()?.apply(this,se)},n(pe),_(qe,pe)},$$slots:{default:!0}})};y(yt,u=>{t(P)&&u(ca)})}var va=i(yt,2);{var da=u=>{Ue(u,{onclose:()=>{m(M,!1),t(ne)?.focus()},children:(qe,_e=wt)=>{var pe=El(),re=i(s(pe),2);{const ke=Le=>{var Ze=Pl();Ze.__click=function(...ua){_e()?.apply(this,ua)},_(Le,Ze)};let se=d(()=>new Set(t(f)));il(re,{get audio_state(){return r},get notes(){return t(se)},get min_note(){return t(h)},get max_note(){return t(q)},oninput:Le=>{m(f,Le),_e()()},before_buttons:ke,$$slots:{before_buttons:!0}})}n(pe),_(qe,pe)},$$slots:{default:!0}})};y(va,u=>{t(M)&&u(da)})}V((u,C)=>{tt(w,u),ge(Yt,jt[t(h)]),X(Oe,"min",$e),X(Oe,"max",et),X(Je,"min",$e),X(Je,"max",et),ge(Gt,jt[t(q)]),X(Re,"min",$e),X(Re,"max",et),X(Be,"min",$e),X(Be,"max",et),tt(Qe,C),He.disabled=a()&&!t(L)||t(me)},[()=>vt(t(g)),()=>ut(t(f))]),ye(x,()=>t(o),u=>m(o,u)),ye(B,()=>t(j),u=>m(j,u)),ye(ie,()=>t(j),u=>m(j,u)),ye(Ge,()=>t(k),u=>m(k,u)),ye(Xe,()=>t(k),u=>m(k,u)),ye(Oe,()=>t(h),u=>m(h,u)),ye(Je,()=>t(h),u=>m(h,u)),ye(Re,()=>t(q),u=>m(q,u)),ye(Be,()=>t(q),u=>m(q,u)),Ja(Ke,"clientWidth",u=>m(ae,u)),_(l,fe),ve()}Se(["change","click"]);var Dl=(l,e,a)=>e()(a.project.id),Ol=p('<button type="button"> </button>'),Rl=(l,e,a,r,c)=>t(e)?a()?.(r.project.id):c()?.(r.project_data??r.load(r.project.id)),Nl=p('<button type="button"><!></button>'),Cl=(l,e)=>m(e,!t(e)),Fl=p('<button type="button" class="icon_button plain_button font_size_xl svelte-12y7az0"><!></button>'),Jl=p("<li><!>  <!> <!></li>");function Bl(l,e){ce(e,!0);const a=te(e,"select",3,null),r=te(e,"edit",3,null),c=te(e,"remove",3,null);let o=D(!1);var b=Jl();let g;var f=s(b);{var A=z=>{var L=Ol();let J;L.__click=[Dl,a,e];var P=s(L,!0);n(L),V(M=>{J=Ee(L,1,"flex_1",null,J,M),ge(P,e.project.name)},[()=>({selected:e.selected})]),_(z,L)};y(f,z=>{a()&&z(A)})}var j=i(f,2);{var k=z=>{var L=Nl();let J;L.__click=[Rl,o,c,e,r];var P=s(L);{var M=E=>{var K=N("✕");_(E,K)},O=E=>{var K=N("✎");_(E,K)};y(P,E=>{t(o)?E(M):E(O,!1)})}n(L),V(E=>{J=Ee(L,1,"icon_button plain_button font_size_xl deselectable svelte-12y7az0",null,J,E),X(L,"title",t(o)?"remove project":"edit project")},[()=>({selected:e.selected&&!t(o)&&e.editing,color_c:t(o)})]),_(z,L)};y(j,z=>{(t(o)&&c()||!t(o)&&r())&&z(k)})}var h=i(j,2);{var q=z=>{var L=Fl();L.__click=[Cl,o];var J=s(L);{var P=O=>{var E=N("×");_(O,E)},M=O=>{var E=N("✕");_(O,E)};y(J,O=>{t(o)?O(P):O(M,!1)})}n(L),V(()=>X(L,"title",t(o)?"cancel removing":"remove project")),_(z,L)};y(h,z=>{c()&&z(q)})}n(b),V(z=>g=Ee(b,1,"project_item svelte-12y7az0",null,g,z),[()=>({selected:e.selected})]),xe(3,b,()=>we),_(l,b),ve()}Se(["click"]);var Hl=p('<menu class="unstyled width_sm mb_0"></menu>');function Vl(l,e){ce(e,!0);const a=te(e,"selected_project_id",3,null),r=te(e,"editing_project_id",3,null),c=te(e,"projects",19,()=>[]),o=te(e,"project_datas",19,()=>[]);var b=Hl();Fe(b,21,c,g=>g.id,(g,f)=>{{let A=d(()=>o().find(h=>h.id===t(f).id)),j=d(()=>t(f).id===a()),k=d(()=>t(f).id===r());Bl(g,{get project(){return t(f)},get project_data(){return t(A)},get load(){return e.load_project},get select(){return e.select_project},get edit(){return e.edit_project},get remove(){return e.remove_project},get selected(){return t(j)},get editing(){return t(k)}})}}),n(b),_(l,b),ve()}var Ul=(l,e,a,r)=>{t(e)?a().editing_project=!1:t(r)(rt.parse({}))},Wl=p('<div class="panel p_md"><header><h2 class="my_0">projects</h2></header> <!> <button type="button">create a new project</button></div>');function Yl(l,e){ce(e,!0);const a=te(e,"app",7),r=d(()=>a().load_project),c=d(()=>a().select_project),o=d(()=>a().edit_project),b=d(()=>a().remove_project),g=d(()=>a().editing_project&&a().selected_project_id!==a().editing_project_id),f=d(()=>a().app_data),A=d(()=>t(f).projects);var j=Wl(),k=i(s(j),2);{let z=d(()=>a().editing_project?a().editing_project_id:null);Vl(k,{get selected_project_id(){return a().selected_project_id},get editing_project_id(){return t(z)},get projects(){return t(A)},get project_datas(){return a().project_datas},get load_project(){return t(r)},get select_project(){return t(c)},edit_project:L=>t(o)(L===a().editing_project_data&&a().editing_project?null:L),get remove_project(){return t(b)}})}var h=i(k,2);let q;h.__click=[Ul,g,a,o],n(j),V(z=>q=Ee(h,1,"w_100 mt_md deselectable",null,q,z),[()=>({selected:t(g)})]),_(l,j),ve()}Se(["click"]);var Gl=(l,e)=>e.toggle(),Xl=p(`<aside>devices with smaller screens aren't well supported yet, see <a href="https://github.com/ryanatkn/earbetter/issues/2">issue #2</a></aside> <table><tbody><tr><td class="svelte-1gwge1y"><code>Spacebar</code></td><td class="svelte-1gwge1y">replay trial</td></tr><tr><td class="svelte-1gwge1y"><code>r</code></td><td class="svelte-1gwge1y">restart level</td></tr><tr><td class="svelte-1gwge1y"><code>Escape</code></td><td class="svelte-1gwge1y"><button type="button" class="inline">toggle main menu</button></td></tr><tr><td class="svelte-1gwge1y"><code>1 to 4</code></td><td class="svelte-1gwge1y">set instrument</td></tr><tr><td class="svelte-1gwge1y"><code>c</code></td><td class="svelte-1gwge1y">connect MIDI</td></tr><tr><td class="svelte-1gwge1y"><code>up/down arrows</code></td><td class="svelte-1gwge1y">adjust volume</td></tr></tbody></table>`,1);function Kl(l,e){ce(e,!0);const a=Pa.get();var r=Xl(),c=i(je(r),2),o=s(c),b=i(s(o),2),g=i(s(b)),f=s(g);f.__click=[Gl,a],At(f,"",{},{"min-width":"172px"}),n(g),n(b),Ne(3),n(o),n(c),_(l,r),ve()}Se(["click"]);var Ql=p('<div class="realm_stats_summary svelte-1mwdoug" title="you performed flawlessly in every level of this realm!">★</div>');function Zl(l,e){ce(e,!0);const a=d(()=>e.realm_data.levels.map(k=>e.level_stats.mistakes[k.id]??[])),r=d(()=>t(a).reduce((k,h)=>k+h.length,0)),c=d(()=>Ct*t(a).length),o=d(()=>!!t(r)&&t(r)>=t(c)),b=d(()=>t(o)?t(a).reduce((k,h)=>k+h.reduce((q,z)=>q+z,0),0):void 0),g=d(()=>t(b)===0);var f=Tt(),A=je(f);{var j=k=>{var h=Ql();_(k,h)};y(A,k=>{t(g)&&k(j)})}_(l,f),ve()}var $l=(l,e,a)=>e()(a.realm_data.id),er=p('<button type="button"> </button>'),tr=(l,e,a,r,c)=>t(e)?a()?.(r.realm_data.id):c()?.(r.realm_data),ar=p('<button type="button"><!></button>'),lr=(l,e)=>m(e,!t(e)),rr=p('<button type="button" class="icon_button plain_button font_size_xl svelte-1joa4ch"><!></button>'),nr=p("<li><!> <!>  <!> <!></li>");function ir(l,e){ce(e,!0);const a=te(e,"select",3,null),r=te(e,"edit",3,null),c=te(e,"remove",3,null);let o=D(!1);const b=d(()=>e.project_data.level_stats);var g=nr();let f;var A=s(g);{var j=P=>{Zl(P,{get realm_data(){return e.realm_data},get level_stats(){return t(b)}})};y(A,P=>{t(b)&&P(j)})}var k=i(A,2);{var h=P=>{var M=er();let O;M.__click=[$l,a,e];var E=s(M,!0);n(M),V(K=>{O=Ee(M,1,"realm_button svelte-1joa4ch",null,O,K),ge(E,e.realm_data.name)},[()=>({selected:e.selected})]),_(P,M)};y(k,P=>{a()&&P(h)})}var q=i(k,2);{var z=P=>{var M=ar();let O;M.__click=[tr,o,c,e,r];var E=s(M);{var K=I=>{var U=N("✕");_(I,U)},H=I=>{var U=N("✎");_(I,U)};y(E,I=>{t(o)?I(K):I(H,!1)})}n(M),V(I=>{O=Ee(M,1,"icon_button plain_button font_size_xl deselectable svelte-1joa4ch",null,O,I),X(M,"title",t(o)?"remove realm":e.editing?"stop editing realm":"edit realm")},[()=>({selected:e.selected&&!t(o)&&e.editing,color_c:t(o)})]),_(P,M)};y(q,P=>{(t(o)&&c()||!t(o)&&r())&&P(z)})}var L=i(q,2);{var J=P=>{var M=rr();M.__click=[lr,o];var O=s(M);{var E=H=>{var I=N("×");_(H,I)},K=H=>{var I=N("✕");_(H,I)};y(O,H=>{t(o)?H(E):H(K,!1)})}n(M),V(()=>X(M,"title",t(o)?"cancel removing":"remove realm")),_(P,M)};y(L,P=>{c()&&P(J)})}n(g),V(P=>f=Ee(g,1,"realm_item svelte-1joa4ch",null,f,P),[()=>({selected:e.selected})]),xe(3,g,()=>we),_(l,g),ve()}Se(["click"]);var sr=p('<menu class="unstyled width_sm mb_0"></menu>');function or(l,e){ce(e,!0);const a=te(e,"selected_realm_data",3,null),r=te(e,"editing_realm_id",3,null),c=te(e,"realms",19,()=>[]),o=d(()=>new Map(c().map(f=>[f.id,f]))),b=f=>t(o).get(f);var g=sr();Fe(g,21,c,f=>f.id,(f,A)=>{{let j=d(()=>b(t(A).id)),k=d(()=>t(A).id===a()?.id),h=d(()=>t(A).id===r());ir(f,{get realm_data(){return t(j)},get project_data(){return e.project_data},get select(){return e.select_realm},get edit(){return e.edit_realm},get remove(){return e.remove_realm},get selected(){return t(k)},get editing(){return t(h)}})}}),n(g),_(l,g),ve()}const _r=(l,e,a,r,c)=>{t(e)?document.querySelector(".realm_def_form input")?.focus():t(a)?r().editing_realm=!1:t(c)(nt.parse({}))};var cr=p("<div><!></div>"),vr=p('<div class="panel p_md"><header><h2 class="my_0">realms</h2></header> <!> <button type="button">create a new realm</button></div>');function dr(l,e){ce(e,!0);const a=te(e,"app",7),r=d(()=>a().select_realm),c=d(()=>a().edit_realm),o=d(()=>a().remove_realm),b=d(()=>a().editing_realm&&!!a().editing_realm_data&&a().selected_realm_data?.id!==a().editing_realm_data.id),g=d(()=>!a().realms?.length);var f=vr(),A=i(s(f),2);{var j=q=>{var z=cr(),L=s(z);{let J=d(()=>a().editing_realm?a().editing_realm_id:null);or(L,{get project_data(){return a().selected_project_data},get selected_realm_data(){return a().selected_realm_data},get realms(){return a().realms},get editing_realm_id(){return t(J)},get select_realm(){return t(r)},edit_realm:P=>t(c)(P===a().editing_realm_data&&a().editing_realm?null:P),get remove_realm(){return t(o)}})}n(z),xe(3,z,()=>we),_(q,z)};y(A,q=>{a().realms&&a().selected_project_data&&q(j)})}var k=i(A,2);let h;k.__click=[_r,g,b,a,c],n(f),V(q=>h=Ee(k,1,Sa(t(g)?void 0:"deselectable"),"svelte-100yq62",h,q),[()=>({selected:t(b)||t(g)})]),_(l,f),ve()}Se(["click"]);const ur=(l,e,a,r,c)=>{m(e,"");try{const o=JSON.parse(t(a));o&&!o.id&&(o.id=Ca());const b=nt.parse(o);r.onsubmit(b)}catch(o){console.error("failed to import data",o),m(e,o.message||"unknown error",!0)}m(c,!1)},mr=(l,e,a,r,c)=>{m(e,m(a,JSON.stringify(r()),!0),!0),m(c,!0)};var fr=p('<div class="importing pane shadow_d_xl p_xl width_md mx_auto svelte-1g446ss"><h2 class="my_0">import realm data</h2> <!> <textarea class="svelte-1g446ss"></textarea> <button type="button" class="svelte-1g446ss">import realm data</button></div>'),gr=(l,e,a)=>{l.key==="Enter"&&(Jt(l),e.onsubmit(a()))},br=(l,e,a)=>e.onsubmit(a()),hr=(l,e)=>m(e,!t(e)),pr=(l,e,a)=>{m(e,!1),a.onremove(a.realm_data.id)},kr=p('<div class="pb_md"><button type="button" class="color_c w_100 svelte-1g446ss">✕ confirm remove</button></div>'),yr=(l,e)=>e.onduplicate(e.realm_data.id),xr=p('<button type="button" class="svelte-1g446ss">duplicate realm</button>'),wr=p('<button type="button" class="svelte-1g446ss">remove realm</button> <!> <!>',1),jr=(l,e)=>m(e,!t(e)),zr=(l,e,a)=>{m(e,!1),a.onsubmit(Ft().realms)},qr=p('<div><button type="button" class="w_100 svelte-1g446ss"> </button></div>'),Ir=p('<button type="button" class="svelte-1g446ss">create default realms</button> <!>',1),Sr=p("<pre> </pre>"),Tr=p('<div class="message-wrapper svelte-1g446ss"><!></div>'),Ar=(l,e)=>e.onclose(e.realm_data.id),Pr=p('<button class="w_100 svelte-1g446ss" type="button"><!></button>'),Er=p('<!> <form class="realm_def_form"><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input/></label></fieldset> <button type="button" class="accent svelte-1g446ss"><!></button> <!> <button type="button" class="svelte-1g446ss"><!></button> <!> <!> <!></form>',1);function Lr(l,e){ce(e,!0);const a=te(e,"editing",3,!1);let r=D(!1),c=D(Pe(e.realm_data.name));const o=d(()=>t(c)?.trim()),b=()=>nt.parse({id:e.realm_data.id,name:t(o),levels:e.realm_data.levels});Ce(()=>{console.log("set_realm_data",e.realm_data),m(c,e.realm_data.name,!0)});const g=d(()=>t(o)!==e.realm_data.name);let f=D(!1),A=D(""),j=D("");const k=d(()=>t(A)!==t(j));let h=D("");Ce(()=>{e.realm_data,m(h,"")});let q=D(void 0),z=D(void 0);const L=Ft().realms;let J=D(!1);var P=Er(),M=je(P);{var O=w=>{Ue(w,{onclose:()=>{m(f,!1),t(z)?.focus()},children:(S,Z)=>{var Y=fr(),G=i(s(Y),2);mt(G,{get text(){return t(j)},oncopy:()=>{t(q)?.select()}});var B=i(G,2);We(B),Me(B,ue=>m(q,ue),()=>t(q));var ie=i(B,2);ie.__click=[ur,h,j,e,f],n(Y),V(()=>{ie.disabled=!t(k),X(ie,"title",t(k)?void 0:"data has not changed")}),ye(B,()=>t(j),ue=>m(j,ue)),_(S,Y)},$$slots:{default:!0}})};y(M,w=>{t(f)&&w(O)})}var E=i(M,2),K=s(E),H=s(K),I=s(H);{var U=w=>{var S=N("editing realm");_(w,S)},de=w=>{var S=N("create a new realm");_(w,S)};y(I,w=>{a()?w(U):w(de,!1)})}n(H),n(K);var ne=i(K,2),oe=s(ne),R=i(s(oe),2);Ie(R),R.__keydown=[gr,e,b],n(oe),n(ne);var F=i(ne,2);F.__click=[br,e,b];var ae=s(F);{var me=w=>{var S=N("save changes to realm");_(w,S)},fe=w=>{var S=N("create realm");_(w,S)};y(ae,w=>{a()?w(me):w(fe,!1)})}n(F);var le=i(F,2);{var ee=w=>{var S=wr(),Z=je(S);Z.__click=[hr,r];var Y=i(Z,2);{var G=ue=>{var Ae=kr(),Ye=s(Ae);Ye.__click=[pr,r,e],n(Ae),xe(3,Ae,()=>we),_(ue,Ae)};y(Y,ue=>{t(r)&&ue(G)})}var B=i(Y,2);{var ie=ue=>{var Ae=xr();Ae.__click=[yr,e],_(ue,Ae)};y(B,ue=>{e.onduplicate&&ue(ie)})}_(w,S)};y(le,w=>{e.onremove&&a()&&w(ee)})}var W=i(le,2);W.__click=[mr,A,j,b,f];var be=s(W);{var ze=w=>{var S=N("import/export data");_(w,S)},Te=w=>{var S=N("import data");_(w,S)};y(be,w=>{a()?w(ze):w(Te,!1)})}n(W),Me(W,w=>m(z,w),()=>t(z));var he=i(W,2);{var T=w=>{var S=Ir(),Z=je(S);Z.__click=[jr,J];var Y=i(Z,2);{var G=B=>{var ie=qr(),ue=s(ie);ue.__click=[zr,J,e];var Ae=s(ue);n(ue),n(ie),V(()=>ge(Ae,`create ${L.length??""} new realms`)),xe(3,ie,()=>we),_(B,ie)};y(Y,B=>{t(J)&&B(G)})}_(w,S)};y(he,w=>{a()||w(T)})}var v=i(he,2);{var x=w=>{var S=Tr(),Z=s(S);at(Z,{status:"error",children:(Y,G)=>{var B=Sr(),ie=s(B,!0);n(B),V(()=>ge(ie,t(h))),_(Y,B)},$$slots:{default:!0}}),n(S),_(w,S)};y(v,w=>{t(h)&&w(x)})}var $=i(v,2);{var Q=w=>{var S=Pr();S.__click=[Ar,e];var Z=s(S);{var Y=B=>{var ie=N("discard changes");_(B,ie)},G=B=>{var ie=N("close realm editor");_(B,ie)};y(Z,B=>{t(g)?B(Y):B(G,!1)})}n(S),_(w,S)};y($,w=>{e.onclose&&a()&&w(Q)})}n(E),V(()=>F.disabled=a()&&!t(g)),ye(R,()=>t(c),w=>m(c,w)),_(l,P),ve()}Se(["click","keydown"]);var Mr=p('<div class="panel p_md"><!></div>');function Dr(l,e){ce(e,!0);const a=te(e,"app",7),r=d(()=>a().remove_realm),c=d(()=>a().duplicate_realm),o=d(()=>a().update_realm),b=d(()=>a().create_realm),g=d(()=>a().editing_realm_data??nt.parse({})),f=d(()=>a().realms?a().realms.some(h=>h.id===t(g).id):!1),A=(h,q)=>{a().realms?.some(z=>z.id===h.id)?t(o)(h):t(b)(h,q)};var j=Mr(),k=s(j);Lr(k,{get editing(){return t(f)},get realm_data(){return t(g)},onsubmit:h=>{if(Array.isArray(h))for(let q=0;q<h.length;q++)A(h[q],q===0);else A(h,!0)},onremove:h=>t(r)(h),onduplicate:h=>t(c)(h),onclose:()=>a().editing_realm=!1}),n(j),_(l,j),ve()}var Or=(l,e)=>e.app.play_level(e.level_data.id),Rr=async(l,e,a,r)=>{if(t(e))a.app.remove_level(a.level_data.id);else{const c=!t(r);a.app.edit_level(c?a.level_data:null),c&&(await ka(),document.querySelector(".level_def_form")?.scrollIntoView({behavior:"smooth",block:"center"}))}},Nr=(l,e)=>m(e,!t(e)),Cr=p('<li><!> <button type="button" title="play this level"> </button> <button type="button"><!></button> <button type="button" class="icon_button plain_button font_size_xl svelte-170pvnv"><!></button></li>');function Fr(l,e){ce(e,!0);const a=d(()=>e.app.draft_level_data===e.level_data),r=d(()=>e.app.editing_level&&t(a)),c=d(()=>e.app.selected_project_data?.level_stats);let o=D(!1);const b=d(()=>t(r)||t(a));var g=Cr();let f;var A=s(g);{var j=I=>{Ha(I,{get level_data(){return e.level_data},get level_stats(){return t(c)}})};y(A,I=>{t(c)&&I(j)})}var k=i(A,2);let h;k.__click=[Or,e];var q=s(k,!0);n(k);var z=i(k,2);let L;z.__click=[Rr,o,e,r];var J=s(z);{var P=I=>{var U=N("✕");_(I,U)},M=I=>{var U=N("✎");_(I,U)};y(J,I=>{t(o)?I(P):I(M,!1)})}n(z);var O=i(z,2);O.__click=[Nr,o];var E=s(O);{var K=I=>{var U=N("×");_(I,U)},H=I=>{var U=N("✕");_(I,U)};y(E,I=>{t(o)?I(K):I(H,!1)})}n(O),n(g),V((I,U,de)=>{f=Ee(g,1,"level_map_item svelte-170pvnv",null,f,I),h=Ee(k,1,"level_button deselectable svelte-170pvnv",null,h,U),ge(q,e.level_data.name),L=Ee(z,1,"icon_button plain_button font_size_xl svelte-170pvnv",null,L,de),X(z,"title",t(o)?"remove level":t(r)?"stop editing level":"edit level"),X(O,"title",t(o)?"cancel removing":"remove level")},[()=>({selected:t(b)}),()=>({selected:t(b)}),()=>({selected:!t(o)&&t(r),color_c:t(o)})]),xe(3,g,()=>we),_(l,g),ve()}Se(["click"]);const Jr=(l,e,a,r)=>{t(e)?document.querySelector(".level_def_form input")?.focus():a.app.edit_level(t(r)?null:lt.parse({}))};var Br=p('<div class="panel p_md"><header><h2 class="my_0">levels</h2> <h3 class="my_0"> </h3></header> <menu class="levels unstyled mb_0 svelte-wmjxbn"></menu> <button type="button">create a new level</button></div>');function Hr(l,e){ce(e,!0);const a=d(()=>e.app.editing_level&&!e.levels.some(k=>k===e.app.draft_level_data)),r=d(()=>!e.levels.length);var c=Br(),o=s(c),b=i(s(o),2),g=s(b,!0);n(b),n(o);var f=i(o,2);Fe(f,21,()=>e.levels,k=>k.id,(k,h)=>{Fr(k,{get app(){return e.app},get level_data(){return t(h)}})}),n(f);var A=i(f,2);A.__click=[Jr,r,e,a];let j;n(c),V(k=>{ge(g,e.app.selected_realm_data?.name),j=Ee(A,1,"svelte-wmjxbn",null,j,k)},[()=>({selected:t(a)||t(r),deselectable:!t(r)})]),_(l,c),ve()}Se(["click"]);const Vr=(l,e,a,r,c)=>{m(e,"");try{const o=JSON.parse(t(a));o&&!o.id&&(o.id=Fa());const b=rt.parse(o);r.onsubmit(b)}catch(o){console.error("failed to import data",o),m(e,o.message||"unknown error",!0)}m(c,!1)},Ur=(l,e,a,r,c)=>{m(e,m(a,JSON.stringify(r()),!0),!0),m(c,!0)};var Wr=p('<div class="importing pane shadow_d_xl p_xl width_md mx_auto svelte-l3tcx7"><h2 class="my_0">import project data</h2> <!> <textarea class="svelte-l3tcx7"></textarea> <button type="button" class="svelte-l3tcx7">import project data</button></div>'),Yr=(l,e,a)=>{l.key==="Enter"&&(Jt(l),e.onsubmit(a()))},Gr=(l,e,a)=>e.onsubmit(a()),Xr=(l,e)=>m(e,!t(e)),Kr=(l,e,a)=>{m(e,!1),a.onremove(a.project_data.id)},Qr=p('<div class="pb_md"><button type="button" class="color_c w_100 svelte-l3tcx7">✕ confirm remove</button></div>'),Zr=(l,e)=>e.onduplicate(e.project_data.id),$r=p('<button type="button" class="w_100 svelte-l3tcx7">duplicate project</button>'),en=p('<button class="w_100 svelte-l3tcx7" type="button">remove project</button> <!> <!>',1),tn=p("<pre> </pre>"),an=p('<div class="overflow_x_auto"><!></div>'),ln=(l,e)=>e.onclose(e.project_data.id),rn=p('<button type="button" class="w_100 svelte-l3tcx7"><!></button>'),nn=p('<!> <form><header><h2 class="my_0"><!></h2></header> <fieldset><label><div class="title">name</div> <input/></label></fieldset> <button type="button" class="accent w_100 svelte-l3tcx7"><!></button> <!> <button type="button" class="w_100 svelte-l3tcx7"><!></button> <!> <!></form>',1);function sn(l,e){ce(e,!0);const a=te(e,"editing",3,!1);let r=D(!1),c=D(Pe(e.project_data.name));const o=d(()=>t(c).trim()),b=()=>rt.parse({id:e.project_data.id,name:t(o),realms:e.project_data.realms,level_stats:e.project_data.level_stats});Ce(()=>{console.log("set_project_data",e.project_data),m(c,e.project_data.name,!0)});const g=d(()=>t(o)!==e.project_data.name);let f=D(!1),A=D(""),j=D("");const k=d(()=>t(A)!==t(j));let h=D("");Ce(()=>{e.project_data,m(h,"")});let q=D(void 0),z=D(void 0);var L=nn(),J=je(L);{var P=v=>{Ue(v,{onclose:()=>{m(f,!1),t(z)?.focus()},children:(x,$)=>{var Q=Wr(),w=i(s(Q),2);mt(w,{get text(){return t(j)},oncopy:()=>{t(q)?.select()}});var S=i(w,2);We(S),Me(S,Y=>m(q,Y),()=>t(q));var Z=i(S,2);Z.__click=[Vr,h,j,e,f],n(Q),V(()=>{Z.disabled=!t(k),X(Z,"title",t(k)?void 0:"data has not changed")}),ye(S,()=>t(j),Y=>m(j,Y)),_(x,Q)},$$slots:{default:!0}})};y(J,v=>{t(f)&&v(P)})}var M=i(J,2),O=s(M),E=s(O),K=s(E);{var H=v=>{var x=N("editing project");_(v,x)},I=v=>{var x=N("create a new project");_(v,x)};y(K,v=>{a()?v(H):v(I,!1)})}n(E),n(O);var U=i(O,2),de=s(U),ne=i(s(de),2);Ie(ne),ne.__keydown=[Yr,e,b],n(de),n(U);var oe=i(U,2);oe.__click=[Gr,e,b];var R=s(oe);{var F=v=>{var x=N("save changes to project");_(v,x)},ae=v=>{var x=N("create project");_(v,x)};y(R,v=>{a()?v(F):v(ae,!1)})}n(oe);var me=i(oe,2);{var fe=v=>{var x=en(),$=je(x);$.__click=[Xr,r];var Q=i($,2);{var w=Y=>{var G=Qr(),B=s(G);B.__click=[Kr,r,e],n(G),xe(3,G,()=>we),_(Y,G)};y(Q,Y=>{t(r)&&Y(w)})}var S=i(Q,2);{var Z=Y=>{var G=$r();G.__click=[Zr,e],_(Y,G)};y(S,Y=>{e.onduplicate&&Y(Z)})}_(v,x)};y(me,v=>{e.onremove&&a()&&v(fe)})}var le=i(me,2);le.__click=[Ur,A,j,b,f];var ee=s(le);{var W=v=>{var x=N("import/export data");_(v,x)},be=v=>{var x=N("import data");_(v,x)};y(ee,v=>{a()?v(W):v(be,!1)})}n(le),Me(le,v=>m(z,v),()=>t(z));var ze=i(le,2);{var Te=v=>{var x=an(),$=s(x);at($,{status:"error",children:(Q,w)=>{var S=tn(),Z=s(S,!0);n(S),V(()=>ge(Z,t(h))),_(Q,S)},$$slots:{default:!0}}),n(x),_(v,x)};y(ze,v=>{t(h)&&v(Te)})}var he=i(ze,2);{var T=v=>{var x=rn();x.__click=[ln,e];var $=s(x);{var Q=S=>{var Z=N("discard changes and stop editing");_(S,Z)},w=S=>{var Z=N("close project editor");_(S,Z)};y($,S=>{t(g)?S(Q):S(w,!1)})}n(x),_(v,x)};y(he,v=>{e.onclose&&a()&&v(T)})}n(M),V(()=>oe.disabled=a()&&!t(g)),ye(ne,()=>t(c),v=>m(c,v)),_(l,L),ve()}Se(["click","keydown"]);var on=p('<div class="panel p_md"><!></div>');function _n(l,e){ce(e,!0);const a=te(e,"app",7),r=d(()=>a().remove_project),c=d(()=>a().duplicate_project),o=d(()=>a().update_project),b=d(()=>a().create_project),g=d(()=>a().editing_project_data??rt.parse({})),f=d(()=>a().project_datas.some(k=>k.id===t(g).id));var A=on(),j=s(A);{let k=d(()=>t(f)?t(o):t(b));sn(j,{get editing(){return t(f)},get project_data(){return t(g)},get onsubmit(){return t(k)},get onremove(){return t(r)},get onduplicate(){return t(c)},onclose:()=>a().editing_project=!1})}n(A),_(l,A),ve()}var cn=p('<section class="card svelte-8muejm"><!></section>'),vn=p('<section class="card svelte-8muejm"><!></section>'),dn=p('<div class="width_sm svelte-8muejm"><!>  <!> <section class="card svelte-8muejm"><div class="panel p_md"><header><h2 class="my_0">controls</h2></header> <!> <div class="mb_lg"><!></div> <!> <aside>Earbetter supports MIDI devices like piano keyboards, connect and click:</aside> <!></div></section></div>'),un=(l,e)=>t(e)(),mn=p(`<section class="card svelte-8muejm"><div class="panel p_md"><p>Earbetter is an <a href="https://wikipedia.org/wiki/Ear_training">ear training</a> tool:</p> <ul><li>each level is a standalone challenge that's a series of trials</li> <li> </li> <li>realms group levels into bigger challenges</li> <li>projects group realms so you can customize various experiences</li> <li>levels can be shared via their links or exporting/importing data</li></ul> <p>See also the 3 minute <a href="https://www.youtube.com/watch?v=zW2zI1A_Ikw">video intro on YouTube</a> and <a href="https://github.com/ryanatkn/earbetter">the readme</a>.</p> <aside>Earbetter is in early development, and many things are unfinished and unknown - feedback
						is appreciated on <a href="https://github.com/ryanatkn/earbetter">the GitHub discussions and issues</a>.</aside> <div class="box row"><button type="button" class="m_0">ok, hide this</button></div></div></section>`),fn=p('<section class="card svelte-8muejm"><!></section>'),gn=p('<section class="card svelte-8muejm"><!></section>'),bn=p('<section class="card svelte-8muejm"><div class="panel p_md"><!></div></section>'),hn=p('<div class="width_sm svelte-8muejm"><!>  <!></div>'),pn=p('<!> <div class="map svelte-8muejm"><!> <div class="width_sm svelte-8muejm"><!> <section class="card svelte-8muejm"><!></section>  <!></div> <!></div>',1);function kn(l,e){ce(e,!0);const a=te(e,"app",7),r=d(()=>a().toggle_trainer_help),c=d(()=>a().play_level),o=d(()=>a().edit_level),b=d(()=>a().remove_level),g=d(()=>a().duplicate_level),f=d(()=>a().create_level),A=d(()=>a().update_level),j=Mt.get();window.ac=j;const k=d(()=>a().draft_level_data??lt.parse({})),h=d(()=>a().levels?a().levels.some(R=>R.id===t(k).id):!1),q=d(()=>!a().realms?.length);var z=pn(),L=je(z);Ut(L,{get midi_access(){return a().midi_access},onnotestart:(R,F)=>{Ot(a(),j(),R,Rt(a().volume,F),a().instrument)},onnotestop:R=>{dt(R)}});var J=i(L,2),P=s(J);{var M=R=>{var F=dn(),ae=s(F);{var me=v=>{var x=cn(),$=s(x);Yl($,{get app(){return a()}}),n(x),xe(3,x,()=>we),_(v,x)};y(ae,v=>{a().selected_project_data&&v(me)})}var fe=i(ae,2);{var le=v=>{var x=vn(),$=s(x);_n($,{get app(){return a()}}),n(x),xe(3,x,()=>we),_(v,x)};y(fe,v=>{(a().editing_project&&a().editing_project_data||!a().selected_project_data)&&v(le)})}var ee=i(fe,2),W=s(ee),be=i(s(W),2);Kl(be,{});var ze=i(be,2),Te=s(ze);Ht(Te,{get volume(){return a().volume},set volume(v){a().volume=v}}),n(ze);var he=i(ze,2);Bt(he,{get instrument(){return a().instrument},set instrument(v){a().instrument=v}});var T=i(he,4);Vt(T,{get midi_state(){return a()}}),n(W),n(ee),n(F),xe(3,ee,()=>we),_(R,F)};y(P,R=>{a().project_datas.length&&R(M)})}var O=i(P,2),E=s(O);{var K=R=>{var F=mn(),ae=s(F),me=i(s(ae),2),fe=i(s(me),2),le=s(fe);n(fe),Ne(6),n(me);var ee=i(me,6),W=s(ee);W.__click=[un,r],n(ee),n(ae),n(F),V(()=>ge(le,`your level score is the sum of mistakes in your best ${Ct}
							runs, win a ★ at 0`)),xe(3,F,()=>we),_(R,F)};y(E,R=>{a().show_trainer_help&&R(K)})}var H=i(E,2),I=s(H);dr(I,{get app(){return a()}}),n(H);var U=i(H,2);{var de=R=>{var F=fn(),ae=s(F);Dr(ae,{get app(){return a()}}),n(F),xe(3,F,()=>we),_(R,F)};y(U,R=>{(a().editing_realm&&a().editing_realm_data||t(q))&&R(de)})}n(O);var ne=i(O,2);{var oe=R=>{var F=hn(),ae=s(F);{var me=ee=>{var W=gn(),be=s(W);Hr(be,{get app(){return a()},get levels(){return a().levels}}),n(W),xe(3,W,()=>we),_(ee,W)};y(ae,ee=>{a().levels&&ee(me)})}var fe=i(ae,2);{var le=ee=>{var W=bn(),be=s(W),ze=s(be);{let Te=d(()=>t(h)?t(A):t(f));Ml(ze,{get editing(){return t(h)},get level_data(){return t(k)},get onsubmit(){return t(Te)},get onremove(){return t(b)},get onduplicate(){return t(g)},onplay:async(he,T)=>{T&&t(A)(he),await t(c)(he.id)},onclose:()=>t(o)(null)})}n(be),n(W),xe(2,W,()=>we),_(ee,W)};y(fe,ee=>{a().selected_realm_id&&(a().editing_level&&a().levels||a().levels?.length===0)&&ee(le)})}n(F),_(R,F)};y(ne,R=>{a().project_datas.length&&R(oe)})}n(J),_(l,z),ve()}Se(["click"]);var yn=p('<main><!> <!> <!> <div class="box"><!></div></main>');function On(l,e){ce(e,!0);const a=Nt.get();var r=yn();ya(A=>{xa.title="Earbetter trainer"});var c=s(r);Ba(c,{onclick:()=>wa(Ta("/"))});var o=i(c,2);Aa(o);var b=i(o,2);kn(b,{get app(){return a}});var g=i(b,2),f=s(g);Ea(f,{}),n(g),n(r),_(l,r),ve()}export{On as component};
